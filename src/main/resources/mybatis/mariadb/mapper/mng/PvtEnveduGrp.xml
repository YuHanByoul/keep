<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
	SQL File Name : CarbonOpnnDaoImpl.xml
	Description : 탄소중립환경교육 -> 독자소리
-->
<mapper namespace="com.kbrainc.plum.mng.pvtEnveduGrp.model.PvtEnveduGrpDao">
    
    <!-- 프로그램안내관리 게시글 목록 조회 -->
    <select id="selectPvtEnveduGrpList" parameterType="PvtEnvEduGrpVo" resultType="PvtEnvEduGrpVo">
        /* PvtEnveduGrpDao.selectPvtEnveduGrpList */
        <include refid="PaginationMapper.header"/>
        SELECT
            A.INSTID
            , C.CTPRVN_NM AS RGN_CD
            , A.INST_NM
            , D.CD_NM
            , A.RPRSV_NM
            , A.TELNO
            , A.HMPG
            , A.REG_DT
        FROM
        	TB_CMM_INST A
        	LEFT OUTER JOIN TB_CMM_ADDR_SIGNGU B ON A.RGN_CD = B.SIGNGU_CD
        	LEFT OUTER JOIN TB_CMM_ADDR_CTPRVN C ON B.CTPRVN_CD = C.CTPRVN_CD
        	LEFT OUTER JOIN TB_CMM_CD D ON A.INST_TYPE_CD = D.CD
        WHERE 
            1=1
            AND INST_TYPE_CD IN (108106, 108107)
            <if test="rgnCd != null and rgnCd != ''">
            AND C.CTPRVN_CD = #{rgnCd}
            </if>
            <if test="instNm != null and instNm != ''">
            AND INST_NM LIKE CONCAT('%',#{instNm},'%')
            </if>    
        <include refid="PaginationMapper.footer"/>
    </select>
    
    <!-- 구분코드(공통코드) 목록 조회 -->
    <select id="selectAddrCtpvnList" parameterType="PvtEnvEduGrpVo" resultType="PvtEnvEduGrpVo">
        /* PvtEnveduGrpDao.selectAddrCtpvnList */
        SELECT
            CTPRVN_CD
            ,CTPRVN_NM 
        FROM 
            TB_CMM_ADDR_CTPRVN 
    </select>
    
        <!-- 프로그램안내관리 게시글 목록 조회 -->
    <select id="selectPvtEnveduGrpExcelDownload" parameterType="PvtEnvEduGrpVo" resultType="PvtEnvEduGrpVo">
        /* PvtEnveduGrpDao.selectPvtEnveduGrpExcelDownload */
        SELECT
            C.CTPRVN_NM AS RGN_CD
            , A.INST_NM
            , D.CD_NM
            , A.RPRSV_NM
            , A.TELNO
            , A.HMPG
            , A.REG_DT
        FROM
            TB_CMM_INST A
            LEFT OUTER JOIN TB_CMM_ADDR_SIGNGU B ON A.RGN_CD = B.SIGNGU_CD
            LEFT OUTER JOIN TB_CMM_ADDR_CTPRVN C ON B.CTPRVN_CD = C.CTPRVN_CD
            LEFT OUTER JOIN TB_CMM_CD D ON A.INST_TYPE_CD = D.CD
        WHERE 
            1=1
            AND INST_TYPE_CD IN (108106, 108107)
            <if test="rgnCd != null and rgnCd != ''">
            AND C.CTPRVN_CD = #{rgnCd}
            </if>
            <if test="instNm != null and instNm != ''">
            AND INST_NM LIKE CONCAT('%',#{instNm},'%')
            </if>
    </select>
</mapper>