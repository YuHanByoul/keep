 <form class=" form-inline form-horizontal row-border" role="form" id ="bbsUpdateForm" >
        <div class="card-header p-b-0">
            <h3 class="sub-title"><strong>기본정보</strong></h3>
        </div>
        <div class="card-block-small p-t-0">
            <div class="row">
                <div class="col-lg-6">
                    <div class="mb-2 form-group row ">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" ><strong>게시판 코드</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm"  th:value="${paramMap.bbsid}" readonly/>
                        </div>
                    </div>
                    <div class="mb-2 form-group row required">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="boardName"><strong>게시판명</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="nm" id="nm" th:value="${paramMap.nm}" placeholder="게시판명"/>
                        </div>
                    </div>
                    <div class="mb-0 form-group row required">
                        <div class="col-auto">
                            <input type="hidden" class="js-single"/>
                            <input type="checkbox" class="js-single-small" name="nloginDwnldPermYnChk" id="nloginDwnldPermYnChk"
                            th:checked = "${paramMap.nloginDwnldPermYn == 'Y' }"/>
                            <label for="nloginDwnldPermYn" class="v-middle form-label">비로그인 파일다운로드</label>
                        </div>
                        <div class="col-auto">
                            <input type="checkbox" class="js-single-small" name="useYnChk" id="useYnChk" 
                            th:checked = "${paramMap.useYn == 'Y' }" />
                            <label for="useYn" class="v-middle form-label">게시판 사용</label>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="mb-2 form-group row required">
                        <span class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>게시판유형</strong></span>
                        <div class="col-sm-12">
                            <select id="clCd"  name="clCd" class="form-select form-select-sm form-control-sm" onchange="fn_validationCl">
                                <option value="1" th:selected="${paramMap.clCd == '1'}">일반형</option>
                                <option value="2" th:selected="${paramMap.clCd == '2'}">공지형</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-0 form-group row ">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="dc"><strong>게시판설명</strong></label>
                        <div class="col-sm-12">
                            <input class="form-control form-control-sm" type="text" name="dc" id="dc" th:value="${paramMap.dc}"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card-header p-t-0 p-b-0">
            <h4 class="sub-title"><strong>기능정보</strong></h4>
        </div>
        <div class="card-block-small p-t-0">
            <div class="mb-2 form-group row required">
                <div class="col-auto">
                    <label  class="form-label col-sm-12 col-form-label p-t-0 pb-1" >분류사용</label>
                    <input type="checkbox" class="js-single-small" name="clUseYnChk" id="clUseYnChk" 
                    th:checked = "${paramMap.clUseYn == 'Y' }" />
                </div>
                <div class="col-auto">
                    <label  class="form-label col-sm-12 col-form-label p-t-0 pb-1">답글사용</label>
                    <input type="checkbox" class="js-single-small" name="rplyUseYnChk" id="rplyUseYnChk" 
                    th:checked = "${paramMap.rplyUseYn == 'Y' }"/>
                </div>
                <div class="col-auto">
                    <label  class="form-label col-sm-12 col-form-label p-t-0 pb-1">댓글사용</label>
                    <input type="checkbox" class="js-single-small" name="cmntUseYnChk" id="cmntUseYnChk" 
                    th:checked = "${paramMap.cmntUseYn == 'Y' }" />
                </div>
                <div class="col-auto">
                    <label  class="form-label col-sm-12 col-form-label p-t-0 pb-1">첨부파일사용</label>
                    <input type="checkbox" class="js-single-small" name="atchfileUseYnChk" id="atchfileUseYnChk" 
                    th:checked = "${paramMap.atchfileUseYn == 'Y' }"/>
                </div>
                
                <div class="col-auto">
                    <label  class="form-label col-sm-12 col-form-label p-t-0 pb-1">고정공지사용</label>
                    <input type="checkbox" class="js-single-small" name="fxdNtcUseYnChk" id="fxdNtcUseYnChk" 
                    th:checked = "${paramMap.fxdNtcUseYn == 'Y' }"/>
                </div>
                
                <div class="col-auto">
                    <label  class="form-label col-sm-12 col-form-label p-t-0 pb-1">NEW사용</label>
                    <input type="checkbox" class="js-single-small" name="newUseYnChk" id="newUseYnChk"  
                    th:checked = "${paramMap.newUseYn == 'Y' }"/>
                </div>
                <div class="col-auto">
                    <label  class="form-label col-sm-12 col-form-label p-t-0 pb-1">HOT사용</label>
                    <input type="checkbox" class="js-single-small" name="hotUseYnChk" id="hotUseYnChk"  
                    th:checked = "${paramMap.hotUseYn == 'Y' }"/>
                </div>
            </div>
            
            <div class="row">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                
                    <div class="mb-2 form-group row">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="atchfileCnt"><strong>첨부파일 수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" 
                            name="atchfileCnt" id="atchfileCnt" th:value="${paramMap.atchfileCnt}" placeholder="첨부파일 수" />
                        </div>
                    </div>
                    
                    <div class="mb-2 form-group row">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="fxdNtcCnt"><strong>고정공지 수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" 
                            name="fxdNtcCnt" id="fxdNtcCnt" th:value="${paramMap.fxdNtcCnt}" placeholder="고정공지수" />
                        </div>
                    </div>
                    
                    <div class="mb-0 form-group row">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="hotUseStdrHits"><strong>HOT 기준 조회수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="hotUseStdrHits" id="hotUseStdrHits" 
                            placeholder="HOT 기준 조회수"  th:value="${paramMap.hotUseStdrHits}" />
                        </div>
                    </div>
                    
                </div>
                <div class="col-12 col-lg-6">
                    <div class="mb-2 form-group row">
                        <div class="input-group input-group-sm mb-0">
                            <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="atchfileSize"><strong>파일최대크기</strong></label>
                            <input type="text" class="form-control" aria-label="Text input with dropdown button" 
                            name="atchfileSize" id="atchfileSize" th:value="${paramMap.atchfileSize}"/>
                            <div class="input-group-text bg-primary">
                                MB
                            </div>
                        </div>
                    </div>
                    <div class="mb-2 form-group row">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="newIndictDaycnt"><strong>NEW 표시일 수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="newIndictDaycnt" id="newIndictDaycnt" 
                            th:value="${paramMap.newIndictDaycnt}" placeholder="new 표시일수"/>
                        </div>
                    </div>
                    <div class="mb-0 form-group row required">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="pagePstCnt"><strong>페이지 게시글 수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="pagePstCnt" id="pagePstCnt" 
                            th:value="${paramMap.pagePstCnt}" placeholder="페이지 게시글 개수 "/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-block-small">
        
            <button type="button" class="btn btn-disabled m-r-5" onclick="gridHelper1.resetListContent();">취소</button>
            
            <th:block sec:authorize-url="/mng/pop/insertPopUpNtc.do">            
                <button type="button" class="btn btn-primary" onclick="fn_updateBbs()">저장</button>
            </th:block>
            
        </div>
   <!--hidden 변수 저장  -->
   <input type="hidden"  id="bbsid" name="bbsid"  th:value = "${paramMap.bbsid}" >
   
   <span id="appendForm"></span>
</form>

<script type="text/javascript" src="/files/assets/pages/advance-elements/swithces.js"></script>
<script type="text/javascript" src="/files/assets/pages/advance-elements/select2-custom.js"></script>
		              
<script th:inline="javascript" >

	       $(function(){
		       
	    	   $('#clCd').change(function(){
	    	       fn_validationCl();
	    	       fn_validationInput();
		       });
	    	   $("input[type=checkbox]").bind("change",function(){
	    		   fn_validationInput();
	    	   })
	    	   
	    	   fn_validationCl();
	    	   fn_validationInput();
	       })
	       
	       function fn_validationCl(){
	    	   
	    	   //공지형인 경우 댓글, 답글 사용 선택 X 
	    	   if($("#clCd").val() == "2"){
		    	   
	    		   toggleSwitch("#rplyUseYnChk", false);
    			   $("#rplyUseYnChk").prop("disabled",true);
	    		   switchCherryArr["rplyUseYnChk"].disable();
	    		   
	    		   toggleSwitch("#cmntUseYnChk", false);
    			   $("#cmntUseYnChk").prop("disabled",true);
	    		   switchCherryArr["cmntUseYnChk"].disable();
    			   
	    		   $("#fxdNtcUseYnChk").removeAttr("disabled");
	    		   switchCherryArr["fxdNtcUseYnChk"].enable();
	    		   
	    	   }else{ //일반형 인 경우
		    	   
	    		   $("#rplyUseYnChk").removeAttr("disabled");
	    		   switchCherryArr["rplyUseYnChk"].enable();
	    		   
	    		   $("#cmntUseYnChk").removeAttr("disabled");
	    		   switchCherryArr["cmntUseYnChk"].enable();
	    		   
	    		   toggleSwitch("#fxdNtcUseYnChk", false);
	    		   $("#fxdNtcUseYnChk").prop("disabled",true);
	    		   switchCherryArr["fxdNtcUseYnChk"].disable();
	    	   }	    	      	   
	       } 
	       
	       function fn_validationInput(){
		       
	    	   var file_use  = ($("input[name='atchfileUseYnChk']").is(":checked"))?"Y":"N";
    		   var fixed_use = ($("input[name='fxdNtcUseYnChk']").is(":checked"))?"Y":"N";
    		   var new_use   = ($("input[name='newUseYnChk']").is(":checked"))?"Y":"N";
    		   var hot_use   = ($("input[name='hotUseYnChk']").is(":checked"))?"Y":"N";

    		   if(file_use == "N"){ 
        		   fn_disableTrue("atchfileCnt") ; 
        		   fn_disableTrue("atchfileSize");
    		   }else{ 
        		   fn_disableFalse("atchfileCnt") ; 
        		   fn_disableFalse("atchfileSize");
        	   }
    		   
    		   if(fixed_use == "N"){ 
        		   fn_disableTrue("fxdNtcCnt");
    		   }else{ 
        		   fn_disableFalse("fxdNtcCnt");
        	   }
    		   
    		   if(new_use == "N"){ 
        		   fn_disableTrue("newIndictDaycnt");
    		   }else{ 
        		   fn_disableFalse("newIndictDaycnt");
        	   }
    		   
    		   if(hot_use == "N"){ 
        		   fn_disableTrue("hotUseStdrHits");
    		   }else{ 
        		   fn_disableFalse("hotUseStdrHits");
        	   }
    		   
	       }
	       
	       //disalbed 속성 주기   
	       function fn_disableTrue(elementId){
	    	   $("#"+elementId).prop("disabled","true");
	       }
	       
	       //disalbed 속성 해제
	       function fn_disableFalse(elementId){
	    	   $("#"+elementId).removeAttr("disabled");
	       }
	       
	       var validator= $("#bbsUpdateForm").validate({
	 		    rules: {  
	 		    	 nm                 : { required: true   }
	     	         ,dc                : { maxlength : [400] }
	     	         ,pagePstCnt      : { required: true, digits:true  }
	     	         ,atchfileCnt      : { required: true, digits:true, range:[1,5]}
	     	         ,atchfileSize     : { required: true , number:true, range:[1,20]}
	     	         ,fxdNtcCnt       : { required: true , digits:true}
	     	         ,hotUseStdrHits : { required: true , digits:true}
	     	         ,newIndictDaycnt : { required: true , digits:true}
			    },
			    messages: {  
			    	nm                 : { required: "게시판명을 입력해 주십시오."   }
    	            ,dc                : { maxlength : "게시판 설명은 400자를 넘을 수 없습니다."}
			        ,pagePstCnt      : { required: "게시글 개수를 입력해 주십시오." , digits:"게시글 개수는 숫자만 입력 가능합니다!" }
	     	        ,atchfileCnt      : { required: "첨부 파일 개수를 입력해 주십시오. (1~ 5 사이 )", digits:"첨부 파일 개수는 숫자만 입력가능합니다" , range: "첨부파일은 5개 이하만 가능합니다."}
	     	        ,atchfileSize     : { required: "첨부 파일 사이즈를 입력해 주십시오.( 1 ~ 20 MB 사이)", digits:"첨부 파일 개수는 숫자만 입력가능합니다.", range: "첨부파일 사이즈는  20 MG(20,480 KB) 이하입니다." }
	     	        ,fxdNtcCnt       : { required: "고정공지수 갯수를 입력해 주십시오." ,number:"고정공지 개수는 숫자만 입력가능합니다."   }
	     	        ,hotUseStdrHits : { required: "HOT 사용일수를 입력해 주십시오." ,digits:"HOT 사용 일수는 숫자만 입력가능합니다." }
	     	        ,newIndictDaycnt : { required: "NEW 표시일수를 입력해 주십시오." ,digits:"new 표시일수는 숫자만 입력가능합니다."  }
			    }
	 		 })
	 		 
		 	function fn_updateBbs(){
		 	    //jquery 밸리데이션 체크 
   	 	        if($("#bbsUpdateForm").valid() == false) return;

   	 	        $("#appendForm").html("");
		 	    
   	 	        $("input[type=checkbox]").each((index,item)=>{
   	   	 	        
                    let ckbId = $(item).attr("id");
                    
	                if(!$("#"+ckbId).is(":disabled")){
                        let value = ($("#"+ckbId).is(":checked"))?"Y":"N";
                        let input_html = "<input type='hidden' id='"+ckbId.replaceAll("Chk","")+"' name='"+ckbId.replaceAll("Chk","")+"' value='"+value+ "'   '/>"  
	                	$("#appendForm").append(input_html);
	                }
   	   	 	    })
   	   	 	    
    	 	    //최종 의사 타진 
    	 	    if(!confirm("수정하시겠습니까?")) return;
 		        var data =  $("#bbsUpdateForm").serialize() ;
    	 	    
				$.ajax({
					url : "/bbs/updateBbs.do",
					type: 'POST',
					cache : false,
					dataType: 'json',
					data : data,
					success : function (data){
						if(data.result=="success"){
							alert("수정이 완료 되었습니다.");
							gridHelper1.resetListContent();
						}else{
							alert("수정 등록중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
						}
						closeWorkProgress();
					},
				 	error : function (error){
					} 
				});
			}
		 
   	   </script> 

