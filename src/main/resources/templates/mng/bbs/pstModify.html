 <form class="form-inline form-horizontal row-border" role="form" id ="pstUpdateForm" >

		<div class="panel panel-default">
	    	<div class="panel-heading" >
	      		<h4 >> 기본정보</h4>
	    	</div>
	        <div class="panel-body">
					
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger"> </span>게시판명</label>
					    <div class="col-md-10 form-control-static" style="text-align:left;">
   			                  <label class="form-control-static"><th:block th:text="${result.paramMap.nm}"/></label>
   			             </div>
					  </div>
					  
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger"> </span>작성자</label>
						<div class="col-md-10 form-control-static" style="text-align:left;">
   			               <label class="form-control-static"><th:block th:text="${result.paramMap.nm}"/></label>
   			             </div>
					  </div>
					  
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger"> </span>등록일</label>
					    <div class="col-md-10 form-control-static" style="text-align:left;">
   			              <label class="form-control-static"><th:block th:text="${result.paramMap.regDt}"/></label>
   			             </div>
					  </div>
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger"></span>조회수 </label>
					    <div class="col-md-10 form-control-static" style="text-align:left;">
   			              <label class="form-control-static"><th:block th:text="${result.paramMap.hits}"/></label>
   			             </div>
					  </div>
					  
                    <div class="form-group  col-md-12 row">
                      <label class="col-md-2 control-label form-control-static"><span class="text-danger"> </span>비로그인 조회허용여부</label>
                      <div class="col-md-10 form-control-static">
                        <span kattr:radio_yn="loginYn" label1="로그인후 " label2="로그인전 " addClass=" form-control-static "  th:attr="defaultVal=${result.paramMap.loginYn}" ></span>
                       </div>
                    </div>
                      
                    <th:block th:if="${result.paramMap.fxdNtcUseYn}=='Y'">
                      <div class="form-group  col-md-12 row">
                        <label class="col-md-2 control-label">
                             고정공지여부(<th:block th:text="${result.paramMap.curFxdNtcCnt}"/>/<th:block th:text="${result.paramMap.fxdNtcCnt}"/>)
                        </label>
                        <div class="col-md-2 form-control-static ">
                          <span kattr:radio_yn="fxdNtcYn" label1="상단고정" label2="미사용"  th:attr="defaultVal=${result.paramMap.fxdNtcYn == null ? 'N':result.paramMap.fxdNtcYn }"  >
                        </div>                
                        
                        
                        <div class="col-md-4 form-control-static ">
	                        <div class="date-picker-area" id="fxdNtcDtArea">
			                    <th:block kattr:date_pic="fxdNtcStrtDt" dateForm="yy-mm-dd" addStyle="width:110px;display: inline-block;"
			                    addClass=" input-sm" th:attr="dateDefault =${ #strings.substring(result.paramMap.fxdNtcStrtDt, 0,10)}"></th:block>
			                    ~
			                    <th:block kattr:date_pic="fxdNtcEndDt" dateForm="yy-mm-dd" addStyle="width:110px;display: inline-block;"
			                    addClass=" input-sm" th:attr="dateDefault =${ #strings.substring(result.paramMap.fxdNtcEndDt, 0,10)}"></th:block>
			                </div>
                        </div>
                        
                         <label class="control-label">
                           <th:block th:if ="${result.paramMap.fxdNtcYn !='Y' and result.paramMap.curFxdNtcCnt >= result.paramMap.fxdNtcCnt}">
                                                     이미 고정공지 게시글이 가득차 사용 할수 없습니다.
                               <input type="hidden" id="fxdNtcCntOverYn" value="Y">
                           </th:block></label>
                      </div>
                    </th:block>
                    
                    <th:block th:if="${result.paramMap.clUseYn}=='Y'">
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger">* </span>글 분류 </label>
					    <div class="col-md-10 form-control-static  " style="text-align:left;">
   			               <select id="bbsClid"  name="bbsClid"  class="form-control input-sm" style="width:200px;" >
					         <option value=""> - 전체 -</option>
					         
					         <th:block th:each="item : ${clList}">
					          <option th:if="${item.bbsClid} == ${result.paramMap.bbsClid}" th:value="${item.bbsClid}" th:text="${item.clNm} " selected></option>
					          <option th:else th:value="${item.bbsClid}" th:text="${item.clNm} " ></option>
					         </th:block>
					        </select>
					    </div>                
					   </div>
					 </th:block>
					 
		              <div class="form-group  col-sm-12 row">
						<label class="col-md-2 control-label"><span class="text-danger">* </span>제목</label>
					    <div class="col-md-10 form-control-static " style="text-align:left;">
   			              <input type="text"  class="form-control input-sm col-md-10" style="width:1000px;" id="title" name= "title" placeholder="제목"  th:value="${result.paramMap.title}"/>
					    </div>               <!-- class="form-control input-sm col-md-10" --> 
					  </div>
	
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger">* </span>내용</label>
					    <div class="col-md-10 form-control-static" style="text-align:left;">
   			              <textarea id="cntnts" name="cntnts" ><th:block th:text="${result.paramMap.cntnts}"></th:block></textarea>
					    </div>                
					  </div>
					  
			         <th:block th:if="${result.paramMap.atchfileUseYn} == 'Y' ">
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="btn-xs text-danger"></span>첨부파일</label>
					    <div class="form-control-static col-md-9 " style="text-align:left;">
				                        <div class="multiple-upload col-ms-12" >
											<label class="btn btn-primary btn-file"> 
												파일 업로드 <span id="fileInput">
												 <input id="multiFileInput" type="file" name="files"  size="10" accept="image/jpeg,image/gif,image/png,application/pdf" multiple style="display: none;">
												</span>
											</label> 
										 <th:block th:if="${result.fileMap}">
					   					    <div th:each="item : ${result.fileMap}" th:id="${item.fileid}">
					   					     
					   					       <a th:fileid ='${item.fileid}' th:fileIdntfcKey = "${item.fileIdntfcKey}"
					   					          th:onclick="downloadFileByFileid(this.getAttribute('fileid'),this.getAttribute('fileIdntfcKey'))"
					   					          href ="javascript:void(0)" >
					   					       
					   					           <th:block th:text="${item.orginlFileNm}" />(<th:block th:text="${T(com.kbrainc.plum.rte.util.FileUtil).readableFileSize(item.fileSize)}" />)
					   					       </a>
					   					       	<!-- <a th:name="${item.save_file_nm}" class = 'btn btn-xs btn-warnig' onclick = "fn_downFile(this.name)" > -->
					   					       	<a th:name="${item.fileid}" th:attr="data-idntfc-key=${item.fileIdntfcKey}" th:onclick="fn_deleteFileList(this.name, this.dataset.idntfcKey)" ><input type='button'  class = 'btn btn-xs btn-danger' value="X"    /></a>
					   					    </div>
										 </th:block>
										 
											<input type="hidden"  id = "filegrpid" name = "filegrpid"  th:value = "${result.paramMap.filegrpid}" />
											<div class="upload-response">
												<div id="multipleFileUploadError"></div>
												<div id="multipleFileUploadSuccess"></div>
											</div>
										</div>
					    </div>                
					  </div>
				  </th:block>
				  
				  <div style= 'text-align : right'>
		              <input  type="button" class="btn btn-sm btn-primary" id="insertPst" onclick="fn_updatePst()" value="수정" />
		              <input  type="button" class="btn btn-sm btn-danger"  onclick="fn_deletePst()" value="삭제" />
		              <input  type="button" class="btn btn-sm btn-default"  onclick="resetListContent()" value="취소"/>
	              </div>
	              
            </div>
        </div>
        
       <!--hidden 변수 저장  -->
		  <input type="hidden" name="bbsid"   th:value = "${result.paramMap.bbsid}" >
		  <input type="hidden" id="atchfileUseYn" name="atchfileUseYn"   th:value = "${result.paramMap.atchfileUseYn}" >
		  <input type="hidden" id="pstid" name="pstid"   th:value = "${result.paramMap.pstid}" >
		  
		<th:block th:if="${result.paramMap.atchfileUseYn} =='Y'">
		  <input type="hidden" id="atchfileCnt" name="atchfileCnt"   th:value = "${result.paramMap.atchfileCnt}" >
		  <input type="hidden" id="atchfileSize" name="atchfileSize"   th:value = "${result.paramMap.atchfileSize}">
		</th:block>
		   
      </form>
      
      
   <!--******************* 답글 사용시*****************************-->
    <th:block th:if="${bbsInfo.rplyUseYn} == 'Y' ">
    <div class="panel panel-default">
		    	<div class="panel-heading" >
		      		<h4 >> 답글</h4>
		    	</div>
	       <div class="panel-body">
	    
		    <!--답글 입력폼  START-->
		    <div class="panel-body">
		    <form id="pstUpdateForm000">
		             
		             <input type ="hidden"  id="currentFileCnt000" value="0" >
					  
  		              <div class="form-group  col-sm-12 row">
						<label class="col-md-2 control-label"><span class="text-danger">* </span>제목</label>
					    <div class="col-md-10 form-control-static " style="text-align:left;">
   			              <input type="text"  class="form-control input-sm col-md-10" style="width:1000px;" id="title000" name= "title000" placeholder="제목"/>
					    </div>               <!-- class="form-control input-sm col-md-10" --> 
					  </div>
	
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger">* </span>내용</label>
					    <div class="col-md-10 form-control-static" style="text-align:left;">
   			              <textarea id="cntnts000" name="cntnts000" ></textarea>
					    </div>                
					  </div>
					  
					  <th:block th:if="${bbsInfo.atchfileUseYn} == 'Y' ">
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="btn-xs text-danger"></span>첨부파일</label>
					    <div class="form-control-static col-md-9 " style="text-align:left;">
				            <div class="multiple-upload col-ms-12" >
								<label class="btn btn-primary btn-file">
								 
									파일 업로드 <span id="fileInput000">
									
									 <input id="multiFileInput000" onchange="fn_changeFile('000')" type="file" name="files"  size="10" 
									 accept="image/jpeg,image/gif,image/png,application/pdf" multiple style="display: none;">
									</span>
								</label> 
								<input type="hidden"  id = "filegrpid000" name = "filegrpid000"  value = "0" />
								<div class="upload-response">
									<div id="multipleFileUploadError"></div>
									<div id="multipleFileUploadSuccess000"></div>
								</div>
							</div>
					    </div>                
					  </div>
				  </th:block>
				  
				  <div style= 'text-align : right'>
		              <input  type="button" class="btn btn-sm btn-primary"   onclick="fn_insertReplyPst('000')" value="저장" />
		              <input  type="button" class="btn btn-sm btn-default"   onclick="reloadDetailPage()" value="취소"/>
	              </div>
		    </form>
		    </div>
   	        <!--답글 입력폼 END -->
   	         
	        <!--답글 리스트 -->
	        
 		    <div class="panel-heading" ><h4 >답글 리스트</h4></div>
	        
		    <div th:each="item : ${replyList}"  >
		    
		          <form th:id="pstUpdateForm+${item.pstid}">
		           
		             <input type ="hidden"  th:id="currentFileCnt+${item.pstid}" th:value="${item.currentFileCnt}" > 
  		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger"> </span>작성자</label>
						<div class="col-md-10 form-control-static" style="text-align:left;">
   			               <label class="form-control-static"><th:block th:text="${item.userNm}"/></label>
   			             </div>
					  </div>
					  
  		              <div class="form-group  col-sm-12 row">
						<label class="col-md-2 control-label"><span class="text-danger">* </span>제목</label>
					    <div class="col-md-10 form-control-static " style="text-align:left;">
   			              <input type="text"  class="form-control input-sm col-md-10" style="width:1000px;" th:id="title+${item.pstid}" th:name= "title+${item.pstid}" placeholder="제목"  
   			                     th:value="${item.title}"/>
					    </div>               <!-- class="form-control input-sm col-md-10" --> 
					  </div>
	
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="text-danger">* </span>내용</label>
					    <div class="col-md-10 form-control-static" style="text-align:left;">
   			              <textarea th:id="cntnts+${item.pstid}" th:name="cntnts+${item.pstid}" ><th:block th:text="${item.cntnts}"></th:block></textarea>
					    </div>                
					  </div>
					  
					  <th:block th:if="${bbsInfo.atchfileUseYn} == 'Y' ">
		              <div class="form-group  col-md-12 row">
						<label class="col-md-2 control-label"><span class="btn-xs text-danger"></span>첨부파일</label>
					    <div class="form-control-static col-md-9 " style="text-align:left;">
							<div class="multiple-upload col-ms-12">
								<label class="btn btn-primary btn-file">

									파일 업로드 <span th:id="fileInput+${item.pstid}">
												
												 <input th:id="multiFileInput+${item.pstid}" th:pstid="${item.pstid}" th:onchange="fn_changeFile(this.getAttribute('pstid'))" type="file" name="files" size="10"
														accept="image/jpeg,image/gif,image/png,application/pdf" multiple style="display: none;">
												</span>
								</label>

								<th:block th:if="${item.fileMap}">
					   					    <div th:each="file : ${item.fileMap}" th:id="${file.fileid}">
					   					     
<!-- 					   					       <a th:href="@{'/downloadFileByFileid.do?fileid='+${item.fileid}+'&file_idntfc_key='+${item.file_idntfc_key}}" target='_blank'> -->
					   					       <a th:fileid ='${file.fileid}' th:fileIdntfcKey = "${file.fileIdntfcKey}"
					   					          th:onclick="downloadFileByFileid(this.getAttribute('fileid'),this.getAttribute('fileIdntfcKey'))"
					   					          href ="javascript:void(0)" >
					   					       
					   					           <th:block th:text="${file.orginlFileNm}" />(<th:block th:text="${T(com.kbrainc.plum.rte.util.FileUtil).readableFileSize(file.fileSize)}" />)
					   					       </a>
					   					       	<!-- <a th:name="${item.save_file_nm}" class = 'btn btn-xs btn-warnig' onclick = "fn_downFile(this.name)" > -->
					   					       	<a th:name="${file.fileid}" th:attr="data-idntfc-key=${file.fileIdntfcKey}" th:pstid="${item.pstid}"  th:onclick="fn_deleteReplyFileList(this.name, this.dataset.idntfcKey,this.getAttribute('pstid'))" >
					   					       	<input type='button'  class = 'btn btn-xs btn-danger' value="X"    /></a>
					   					    </div>
										 </th:block>
										 
											<input type="hidden"  th:id = "filegrpid+${item.pstid}" th:name = "filegrpid+${item.pstid}"  th:value = "${item.filegrpid}" />
											<div class="upload-response">
												<div id="multipleFileUploadError"></div>
												<div th:id="multipleFileUploadSuccess+${item.pstid}"></div>
											</div>
										</div>
					    </div>                
					  </div>
				  </th:block>
				  
				  <div style= 'text-align : right'>
		              <input  type="button" class="btn btn-sm btn-primary"  th:pstid="${item.pstid}" th:onclick="fn_updateReplyPst(this.getAttribute('pstid'))" value="수정" />
		              <input  type="button" class="btn btn-sm btn-danger"   th:pstid="${item.pstid}" th:onclick="fn_deleteReplyPst(this.getAttribute('pstid'))" value="삭제" />
		              <input  type="button" class="btn btn-sm btn-default"   onclick="reloadDetailPage()" value="취소"/>
	              </div>
		    </form>
		    
		    </div>
  	       <!--답글 리스트 END-->
  	        
	    </div>
    </div>
    </th:block>
                      
   <!-- 댓글 사용시-->
   <th:block th:if="${result.paramMap.cmntUseYn} == 'Y' ">
	  <div class="panel panel-default">
	  
		<div class="panel-heading" >
			<h4 >> 댓글</h4>
		</div>
		    	
	    <div class="panel-body">
	         
	      <form id="cmntForm" >
	         <div class="table-responsive input-group-sm">
	            <div class="form-group">
		            <label class="col-md-2 control-label">댓글</label>
		            <div class="col-md-9 form-control-static">
		             <textarea id="cmntCntnts" name="cmntCntnts" class = "form-control"  ></textarea>
		            </div>
		            <div class="col-md-1 form-control-static">
		               <input type="button" class="btn btn-sm btn-primary"  onclick="fn_insertCmnt()" value="댓글등록"/>
		            </div>
	            </div>
	           </div>
	      </form>     
               
        <div class="form-group col-md-12 " >
            <th:block th:if="not ${cmntList.isEmpty()}">
              <div class="col-md-2 form-group" ></div>
                <div class="col-md-10 form-group">
                
	                 <div th:each="item : ${cmntList}" class="col-md-12" style="padding:10px; border-bottom:1px solid #cae1ef !important">
	                 
                       <form   th:id="replyForm+${item.cmntid}" >      
		                 <input type="hidden" id= "pstid"    name= "pstid"      th:value="${item.pstid}">
		                 <input type="hidden" id= "cmntid"   name= "cmntid"     th:value="${item.cmntid}">
		                 <input type="hidden" id= "dpth"     name= "dpth"       th:value="${item.dpth}">
		                 <input type="hidden" id= "ord"     name= "ord"       th:value="${item.ord}">
		                 <input type="hidden" id= "cmntGrp" name= "cmntGrp"   th:value="${item.cmntGrp}">
		                 
		                  <div th:if="${item.delYn} =='Y' " class="col-md-12 form-group text-left">
			                 <div class="col-md-10 form-group col-xs-8">
			                  <label><th:block th:utext="${item.dpthStr}"></th:block><th:block th:text="${item.nm}"></th:block> ( <th:block th:text="${item.acnt}"></th:block> )</label>
			                 </div>
			                 
			                 <div class="col-md-10 form-group col-xs-8">
	                         <h6><label><th:block th:utext="${item.paddingStr}"></th:block>삭제된 게시물입니다.</label></h6>
	                         </div>
	                      </div>
		                 
		                 <th:block th:if="${item.delYn} =='N'">
	 	                     <span  th:id="normalForm+${item.cmntid}">
	 	                     
			                 <div class="col-md-10 form-group col-xs-8" th:attr="style='padding-left:#{item.dpth}*10px;'">
			                  <label><th:block th:utext="${item.paddingStr}"></th:block><th:block th:utext="${item.dpthStr}"></th:block><th:block th:text="${item.nm}"></th:block> ( <th:block th:text="${item.acnt}"></th:block> )</label>
			                 </div>
			                 
			                 <div class="form-group col-md-2 col-xs-4 text-right">
			                   <input type="button" class="btn btn-xs btn-primary"  th:id="${item.cmntid}"  onclick="fn_openModifytReplyForm(this.id)" value="수정 "/>
			                   <input type="button" class="btn btn-xs btn-danger"   th:id="${item.cmntid}"  onclick="fn_deleteCmntReply(this.id)"value="삭제"/>
			                 </div>
		 	                  <div class="col-md-12 form-group " >
		 	                    <h6><th:span th:utext="${item.paddingStr}"></th:span><th:block th:text="${item.cntnts}"></th:block></h6>
		 	                  </div>
		 	                  <th:block th:if="${result.paramMap.rplyUseYn} == 'Y' ">
		 	                  <div class="col-md-12 form-group">
			                    <th:block th:utext="${item.paddingStr}"></th:block><input type="button" class="btn btn-xs btn-primary" th:id="${item.cmntid}" onclick="fn_openReplyForm(this.id)" value="답글"/>
		 	                  </div>
		 	                  </th:block>
		 	                 </span>
		 	                  
		 	                  <span  th:id="modifyForm+${item.cmntid}" style="display:none;">
				                 <div class="col-md-12 form-group " >
				                  <th:span th:utext="${item.paddingStr}"></th:span><label><th:block th:utext="${item.dpthStr}"></th:block><th:block th:text="${item.nm}">
				                  </th:block> ( <th:block th:text="${item.acnt}"></th:block> )</label>
				                 </div>
			 	                  <div class="col-md-12  form-group" >
			 	                    <th:span th:utext="${item.paddingStr}"></th:span><textarea class = "form-control"  name="modifyReplyCntnts" id="modifyReplyCntnts" ><th:block th:text="${item.cntnts}"></th:block></textarea>
			 	                  </div>
			 	                  <div class="form-group col-md-12 col-xs-12 ">
				                    <input type="button" class="btn btn-xs btn-primary" th:id="${item.cmntid}" onclick="fn_modifyCmntReply(this.id)" value="수정등록"/>
				                    <input type="button" class="btn btn-xs btn-primary" th:id="${item.cmntid}" onclick="fn_closeModifyReplyForm(this.id)" value="취소"/>
			 	                  </div>
		 	                  </span>
		 	                  
		 	              </th:block>    
	 	                  
	 	                  
	 	                  <div th:id ="replyCntntsForm+${item.cmntid}" class="col-md-12 form-group"  style="padding-left:0px;display:none">
	 	                    <div class="col-md-12 form-group ">
				              <textarea id="cntnts" name="cntnts" class = "form-control"  ></textarea>
				            </div>
				            <div class="col-md-12 form-control-static">
				               <input type="button" class="btn btn-xs btn-primary"  th:id="${item.cmntid}" onclick="fn_insertReply(this.id)"  value="답글등록"/>
				               <input type="button" class="btn btn-xs btn-primary"  th:id="${item.cmntid}" onclick="fn_cnacelInsertReply(this.id)"  value="취소 "/>
				            </div>
	 	                 </div>
	 	               </form>
                    </div> 
                </div>
            </th:block> 
            </div>
            
            <th:block th:if="not ${cmntList.isEmpty()}">
		 	    <input type="hidden" id="pageNumber" name="pageNumber" th:value="${cmntList[0].pageNumber} ">
		 	    <input type="hidden" id="totalPage" name="totalPage" th:value="${cmntList[0].totalPage}">
		 	    <div class="text-center" >
	               <th:block th:if="${cmntList[0].pageNumber} != 1 and ${cmntList[0].totalPage} > 1">
			 	       <span class="jsgrid-pager-nav-button"><a onclick="fn_paging(1)"> &lt; 처음 ㅣ</a></span>
			 	       <span class="jsgrid-pager-nav-button"><a th:name="${cmntList[0].pageNumber} - 1" onclick="fn_paging(this.name)">이전</a></span>
	               </th:block>
	               <th:block th:if="${cmntList[0].totalPage} > 1">
			 	     <th:block th:each="idx,item:${#numbers.sequence(1,cmntList[0].totalPage)}">
			 	       <span th:id="pager+${idx}" class="jsgrid-pager-nav-button "><a th:name="${idx}"  onclick="fn_paging(this.name)"><th:block th:text="${idx}"></th:block></a></span>
			 	     </th:block>
		 	       </th:block>
	               <th:block th:if="${cmntList[0].pageNumber} != ${cmntList[0].totalPage} and ${cmntList[0].totalPage} > 1">
			 	       <span class="jsgrid-pager-nav-button"><a th:name="${cmntList[0].pageNumber} + 1" onclick="fn_paging(this.name)">다음</a></span>
			 	       <span class="jsgrid-pager-nav-button"><a th:name="${cmntList[0].totalPage}"      onclick="fn_paging(this.name)">| 마지막 &gt;</a></span>
		 	       </th:block>
		 	    </div>
 	     </th:block>
 	     
   </div>
 </div>
</th:block>

<script th:inline="javascript" >

	var pstInfo = /*[[ ${result.paramMap} ]]*/null;

	$(function () {
		/*<![CDATA[*/
		// var bbsClid = /*[[ ${result.paramMap.bbsClid} ]]*/;
		/*]]>*/
		/* var bbsClid$ = $("#pstUpdateForm #bbsClid").val();
		 if(bbsClid != null || bbsClid != 'undefined' ){bbsClid=""};
		$("#bbsCl").val(bbsClid); */

		if ($("#fxdNtcCntOverYn").val() == 'Y') {
			$("input[name='fxdNtcYn'][value='Y']").attr("disabled", "true");
		}
	})

	function fn_paging(pageNum) {
		if (pageNum != $("#pageNumber").val()) {
			$("#pageNumber").val(pageNum);
			goModifyForm();
		}
	}

 function fn_cnacelInsertReply(cmntid) {
	 $("#replyForm" + cmntid + "  #cntnts").val("");
	 $("#replyCntntsForm" + cmntid).css("display", "none");
	 $("#normalForm" + cmntid).css("display", "block");
	 $("#modifyForm" + cmntid).css("display", "none");
 }

 function fn_closeModifyReplyForm(cmntid) {
	 $("#replyCntntsForm" + cmntid).css("display", "none");
	 $("#normalForm" + cmntid).css("display", "block");
	 $("#modifyForm" + cmntid).css("display", "none");
 }

 function fn_openModifytReplyForm(cmntid) {
	 $("#replyCntntsForm" + cmntid).css("display", "none");
	 $("#normalForm" + cmntid).css("display", "none");
	 $("#modifyForm" + cmntid).css("display", "block");
 }

 function fn_openReplyForm(cmntid) {
	 $("#replyCntntsForm" + cmntid).css("display", "block");
 }

 function fn_modifyCmntReply(cmntid) {
	 var cmntValidator = $("#replyForm" + cmntid).validate({
		 rules: {modifyReplyCntnts: {required: true}},
		 messages: {modifyReplyCntnts: {required: "답글 내용을 입력해 주십시오."}}

	 })
	 if ($("#replyForm" + cmntid).valid() == false) return;
	 var data = {
		 cntnts: $("#replyForm" + cmntid + " #modifyReplyCntnts").val(),
		 cmntid: $("#replyForm" + cmntid + " #cmntid").val(),
	 }
	 if (!confirm("답글을 수정 하시겠습니까?")) return;
	 var url = "/mng/bbs/updateCmnt.do";
	 fn_postAjax(url, data, updateMessage);
 }

 function fn_deleteCmntReply(cmntid) {
	 var data = {
		 cmntid: $("#replyForm" + cmntid + " #cmntid").val(),
		 delYn: 'Y'
	 }
	 if (!confirm("답글을 삭제 하시겠습니까?")) return;
	 var url = "/mng/bbs/updateCmntReplyDelYn.do";
	 fn_postAjax(url, data, updateMessage);
 }


 function goModifyForm() {
	 var modifyUrl = "/bbs/pstUpdateForm.html?pstid=" + $("#pstid").val() + "&pageNumber=" + $("#pageNumber").val();
	 loadContent(modifyUrl);
 }

 var insertMessage = function (data) {
	 if (data.result == "success") {
		 alert("등록이 완료 되었습니다.");
		 goModifyForm()
	 } else {
		 alert("등록중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
	 }
 }

 var updateMessage = function (data) {
	 if (data.result == "success") {
		 alert("저장이 완료 되었습니다.");
		 goModifyForm()
	 } else {
		 alert("수정중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
	 }
 }

 //답글
 function fn_insertReply(cmntid) {

	 var cmntValidator = $("#replyForm" + cmntid).validate({
		 rules: {cntnts: {required: true}},
		 messages: {cntnts: {required: "답글 내용을 입력해 주십시오."}}
	 })
	 if ($("#replyForm" + cmntid).valid() == false) return;
	 if (!confirm("답글을 저장하시겠습니까?")) return;
	 var dpth = $("#replyForm" + cmntid + "  #dpth").val();
	 var data = {
		 pstid: $("#replyForm" + cmntid + "  #pstid").val(),
		 cntnts: $("#replyForm" + cmntid + "  #cntnts").val(),
		 dpth: (dpth == null || dpth == '0' || dpth == '') ? 0 : Number(dpth),
		 prnts_cmntid: $("#replyForm" + cmntid + "  #cmntid").val(),
		 cmntGrp: $("#replyForm" + cmntid + "  #cmntGrp").val(),
		 ord: $("#replyForm" + cmntid + "  #ord").val()
	 }
	 var url = "/mng/bbs/insertCmntReply.do";
	 fn_postAjax(url, data, insertMessage);
 }

 var atchfileCnt = 0;
 var atchfileSize = 0;

 /*<![CDATA[*/
 var currentFileCnt = /*[[ ${result.currentFileCnt} ]]*/null;
 /*]]>*/

 var editor = null;
 var formData = new FormData();
 var uploadFileCnt = 0;

function disableFxdNtcDt(){
	var fxdNtcYn=$("input[name='fxdNtcYn']:checked").val();
	if(fxdNtcYn == 'Y'){
		$("#fxdNtcDtArea").show();
		$("#fxdNtcStrtDt").prop("disabled",true);
		$("#fxdNtcEndDt").prop("disabled",true);
	}else{
		$("#fxdNtcDtArea").hide();
		$("#fxdNtcStrtDt").prop("disabled",false);
		$("#fxdNtcEndDt").prop("disabled",false);
	}
}

 $(function(){

	 disableFxdNtcDt();

	 $("[name=fxdNtcYn]").click(function () {
		 disableFxdNtcDt();
	 })

	 if ($("#pageNumber").val() != null) {
		 $("#pager" + $("#pageNumber").val()).addClass(" jsgrid-pager-current-page ")
	 }

	 if ($("#atchfileCnt").val() != null && $("#atchfileCnt").val() != '0') {
		 atchfileCnt = $("#atchfileCnt").val();
	 }
	 if ($("#atchfileSize").val() != null && $("#atchfileSize").val() != '0') {
		 atchfileSize = $("#atchfileSize").val();
	 }

	 if (currentFileCnt > 0) uploadFileCnt = currentFileCnt;

	 //editor = CKEDITOR.replace("cntnts");
	 //에디터 엔터키 두줄 바꿈 제거 (shift + enter 처럼 바로 한줄 밑으로 떨어지게 함 )
	 editor = CKEDITOR.replace('cntnts', {enterMode: CKEDITOR.ENTER_BR});
	 validate();

	 fn_defaultDisplay();

	 $("input").click(function () {

		 fn_defaultDisplay();
	 })

	 $('#multiFileInput').on("change", function (event) {

		 var objFile = document.querySelector('#multiFileInput');
		 var formData = new FormData();
		 var content = "";

		 for (i = 0; i < objFile.files.length; i++) {
			 if (objFile.files[i].size > (atchfileSize * 1024 * 1024)) {
				 alert(atchfileSize + "MG 초과하는 파일은 업로드 하실수 없습니다.  : " + objFile.files[i].name);
			 } else if (uploadFileCnt + objFile.files.length > atchfileCnt) {
				 alert("첨부파일은  " + atchfileCnt + " 개 까지 가능합니다.");
				 break;
			 } else {
				 formData.append("files", objFile.files[i]);
				 uploadFileCnt++;
			 }
		 }

		 formData.append("filegrpid", $("#filegrpid").val());
		 formData.append("filegrpNm", "bbs");
		 formData.append("bbsid", $("#bbsid").val());

		 if (atchfileCnt > 0) {
			 $.ajax({
				 url: '/uploadMultipleFiles.do',
				 processData: false,
				 contentType: false,
				 data: formData,
				 type: 'POST',
				 success: function (response) {
					 if ($("#filegrpid").val() == '0' || $("#filegrpid").val() == '' || $("#filegrpid").val() == null) {
						 $("#filegrpid").val(response[0].filegrpid);
					 }
					 for (var i = 0; i < response.length; i++) {
						 content = "<div class ='' id='inputFiles" + response[i].fileid + "' style='' >" + response[i].orginlFileNm;
						 content += "&nbsp;&nbsp;<input type='button'  class = 'btn btn-xs btn-danger' onclick = fn_deleteFileList('" + response[i].fileid + "','" + response[i].fileIdntfcKey + "') value='X'/></div>";
						 $('#multipleFileUploadSuccess').append(content);
					 }
				 }
			 })

			 if (detectBrowser() == "other") {
				 $("#multiFileInput").val("");
			 } else {
				 $("#multiFileInput").replaceWith($("#multiFileInput").clone(true))
			 }
		 }
	 });
 })

 function fn_defaultDisplay() {
	 var loginYn = $("input[name='nloginDwnldPermYn']:checked").val();
	 $("#loginYn").val(loginYn);
	 var fxdNtcUseYn = $("input[name='fxdNtcUseYn']:checked").val();
	 if (fxdNtcUseYn == "N") {
		 fn_disableTrue("fxdNtcStrtDt");
		 fn_disableTrue("fxdNtcEndDt");
	 } else {
		 fn_disableFalse("fxdNtcStrtDt");
		 fn_disableFalse("fxdNtcEndDt");
	 }
 }

 function validate() {

	 $("#pstUpdateForm").validate({
		 ignore: [],
		 rules: {
			 title: {required: true, maxlength: 200}
			 , cntnts: {required: true, maxlength: 4000}
			 , bbsClid: {required: true}
		 },
		 messages: {
			 title: {required: "게시판명을 입력해 주십시오.", maxlength: "게시판 제목은 200자를 넘을 수 없습니다."}
			 , cntnts: {required: "게시글 내용을 입력해 주십시오.", maxlength: "게시판 내용은 4000자를 넘을 수 없습니다."}
			 , bbsClid: {required: "게시글 분류를 선택해주십시오 "}
		 }
	 })
 }

 function fn_updatePst() {
	 $('#cntnts').val(editor.getData());

	 if (!$('#pstUpdateForm').valid()) return;


	 var fxdNtcYn = $("input[name='fxdNtcYn']:checked").val();

	 if (fxdNtcYn == 'Y') {

		 var fxdNtcStrtDt = $("#fxdNtcStrtDt").val();
		 var fxdNtcEndDt = $("#fxdNtcEndDt").val();

		 if (fxdNtcStrtDt == null || fxdNtcStrtDt == "" || fxdNtcEndDt == null || fxdNtcEndDt == "") {
			 alert("고정공지 기간을 입력해주세요");
			 return;
		 } else {

			 var strtDt = fxdNtcStrtDt.replaceAll("-", "");
			 var endDt = fxdNtcEndDt.replaceAll("-", "");
			 if (strtDt > endDt) {
				 alert("고정공지 종료일이 시작일보다 작습니다.");
				 return;
			 }
		 }
	 } else {
		 $("#fxdNtcStrtDt").val('');
		 $("#fxdNtcEndDt").val('');
	 }

	 $.ajax({
		 url: "/bbs/updatePst.do",
		 type: 'POST',
		 cache: false,
		 dataType: 'json',
		 data: $("#pstUpdateForm").serialize(),
		 success: function (data) {
			 if (data.result == "success") {
				 alert("수정이 완료 되었습니다.");
				 fn_searchForm();
				 resetListContent();
			 } else {
				 alert("수정중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
			 }
		 }

	 })
 }

 //댓글 입력
 function fn_insertCmnt() {
	 var cmntValidator = $("#cmntForm").validate({
		 rules: {cmntCntnts: {required: true}},
		 messages: {cmntCntnts: {required: "댓글 내용을 입력해 주십시오."}}
	 })
	 if ($("#cmntForm").valid() == false) return;
	 if (!confirm("저장하시겠습니까?")) return;
	 var data = {
		 pstid: $("#pstid").val(),
		 cntnts: $("#cmntCntnts").val()
	 }
	 var url = "/bbs/insertCmnt.do";
	 fn_postAjax(url, data, function (data) {
		 if (data.result == "success") {
			 alert("등록이 완료 되었습니다.");
			 var modifyUrl = "/bbs/pstUpdateForm.html?pstid=" + $("#pstid").val();
			 loadContent(modifyUrl);
		 } else {
			 alert("등록중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
		 }
	 });
 }

 var deleteMessage = function (data) {
	 if (data.result == "success") {
		 alert("삭제가  완료 되었습니다.");
		 //fn_searchForm();
		 resetListContent();
	 } else {
		 alert("에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
	 }
 }

 //게시판 글 삭제
 function fn_deletePst() {
	 if (!confirm("삭제 하시겠습니까?")) {
		 return;
	 }
	 var data = $("#pstUpdateForm").serialize();
	 var url = "/bbs/deletePst.do";
	 fn_postAjax(url, data, deleteMessage);
 }
 
 /************************************답글 function 추가 ***********************************/

 var replyList = /*[[ ${replyList} ]]*/null;
 var rplyUseYn = /*[[ ${bbsInfo.rplyUseYn} ]]*/null;

 function reloadDetailPage() {
	 var modifyUrl = "/bbs/pstUpdateForm.html?pstid=" + pstInfo.pstid;
	 loadContent(modifyUrl);
 }

 var editor000;
 var obj = {};
 $(document).ready(function () {
     
     if(rplyUseYn == 'Y'){
    	 //답글 등록창 editor 초기화
    	 editor000 = CKEDITOR.replace("cntnts000", {enterMode: CKEDITOR.ENTER_BR});
     }
     
	 if (replyList.length > 0) {
		 replyList.forEach(function (item) {
			 //editor = CKEDITOR.replace("cntnts");
			 //에디터 엔터키 두줄 바꿈 제거 (shift + enter 처럼 바로 한줄 밑으로 떨어지게 함 )
			 //eval("editor" + item.pstid + "= CKEDITOR.replace(cntnts" + item.pstid + ", {enterMode: CKEDITOR.ENTER_BR})");
			 obj["editor" + item.pstid] = CKEDITOR.replace("cntnts" + item.pstid , {enterMode: CKEDITOR.ENTER_BR});
		 })
	 }
	 
 })

 function replyFormvalidate(pstid) {

	 $("#pstUpdateForm" + pstid).validate({
		 ignore: [],
		 rules: {
			 title: {required: true, maxlength: 200}
			 , cntnts: {required: true, maxlength: 4000}
		 },
		 messages: {
			 title: {required: "게시판명을 입력해 주십시오.", maxlength: "게시판 제목은 200자를 넘을 수 없습니다."}
			 , cntnts: {required: "게시글 내용을 입력해 주십시오.", maxlength: "게시판 내용은 4000자를 넘을 수 없습니다."}
		 }
	 })
 }

 //답글등록 
 function fn_insertReplyPst() {

	 replyFormvalidate('000');
	 $('#cntnts000').val(editor000.getData());
	 if (!$('#pstUpdateForm000').valid()) return;

	 var paramData = {
		 "bbsid": pstInfo.bbsid
		 , "prntsPstid": pstInfo.pstid
		 , "title": $("#title000").val()
		 , "cntnts": $('#cntnts000').val()
		 , "filegrpid": $('#filegrpid000').val()
	 }

	 $.ajax({
		 url: "/bbs/insertPst.do",
		 type: 'POST',
		 cache: false,
		 dataType: 'json',
		 data: paramData,
		 success: function (data) {
			 if (data.result == "success") {
				 alert("등록이 완료 되었습니다.");
				 reloadDetailPage();
			 } else {
				 alert("등록중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
			 }
		 }
	 })
 }

 //답글 수정 
 function fn_updateReplyPst(pstid) {
	 
	 replyFormvalidate(pstid);

	 $('#cntnts' + pstid).val(  obj["editor" + pstid].getData() );
	 
	 if (!$('#pstUpdateForm' + pstid).valid()) return;

	 var paramData = {
		 "pstid": pstid
		 , "title": $("#title" + pstid).val()
		 , "cntnts": $('#cntnts' + pstid).val()
		 , "filegrpid": $('#filegrpid' + pstid).val()
	 }
	 $.ajax({
		 url: "/bbs/updatePst.do",
		 type: 'POST',
		 cache: false,
		 dataType: 'json',
		 data: paramData,
		 success: function (data) {
			 if (data.result == "success") {
				 alert("수정이 완료 되었습니다.");
				 reloadDetailPage();
			 } else {
				 alert("수정중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
			 }
		 }
	 })
 }

 function fn_deleteReplyPst(pstid) {

	 if (!confirm("삭제 하시겠습니까?")) {
		 return;
	 }

	 var paramData = {"pstid": pstid};

	 var url = "/bbs/deletePst.do";

	 $.ajax({
		 url: url,
		 type: 'POST',
		 cache: false,
		 dataType: 'json',
		 data: paramData,
		 success: function (data) {
			 if (data.result == "success") {
				 alert("삭제 완료 되었습니다.");
				 reloadDetailPage();
			 } else {
				 alert("삭제중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
			 }
		 }

	 })
 }

 function fn_changeFile(pstid) {

	 var objFile = document.querySelector('#multiFileInput' + pstid);
	 var formData = new FormData();
	 var content = "";
	 var currentFileCount = Number($("#currentFileCnt" + pstid).val());
	 var uploadFileCount = 0;

	 for (i = 0; i < objFile.files.length; i++) {
		 if (objFile.files[i].size > (atchfileSize * 1024 * 1024)) {
			 alert(atchfileSize + "MG 초과하는 파일은 업로드 하실수 없습니다.  : " + objFile.files[i].name);
		 } else if (currentFileCount + objFile.files.length > atchfileCnt) {
			 alert("첨부파일은  " + atchfileCnt + " 개 까지 가능합니다.");
			 break;
		 } else {

			 formData.append("files", objFile.files[i]);
			 uploadFileCount++;
		 }
	 }

	 formData.append("filegrpid", $("#filegrpid" + pstid).val());
	 formData.append("filegrpNm", "bbs");
	 formData.append("bbsid", $("#bbsid").val());

	 if (atchfileCnt > 0) {
		 $.ajax({
			 url: '/uploadMultipleFiles.do',
			 processData: false,
			 contentType: false,
			 data: formData,
			 type: 'POST',
			 success: function (response) {

				 $("#currentFileCnt" + pstid).val(Number(currentFileCount) + Number(uploadFileCount))

				 if ($("#filegrpid" + pstid).val() == '0' || $("#filegrpid" + pstid).val() == '' || $("#filegrpid" + pstid).val() == null) {
					 $("#filegrpid" + pstid).val(response[0].filegrpid);
				 }
				 for (var i = 0; i < response.length; i++) {
					 content = "<div class ='' id='inputFiles" + response[i].fileid + "' style='' >" + response[i].orginlFileNm;
					 content += "&nbsp;&nbsp;<input type='button'  class = 'btn btn-xs btn-danger' onclick = fn_deleteReplyFileList('" + response[i].fileid + "','" + response[i].fileIdntfcKey + "','" + pstid + "') value='X'/></div>";
					 $('#multipleFileUploadSuccess' + pstid).append(content);
				 }
			 }
		 })

		 if (detectBrowser() == "other") {
			 $("#multiFileInput" + pstid).val("");
		 } else {
			 $("#multiFileInput" + pstid).replaceWith($("#multiFileInput" + pstid).clone(true))
		 }
	 }


 }

 function fn_deleteReplyFileList(fileid, fileIdntfcKey, pstid) {

	 if (!confirm("파일을 삭제하시겠습니까?")) {
		 return;
	 }
	 var curFileCnt = $("#currentFileCnt" + pstid).val();
	 curFileCnt = Number(curFileCnt) - 1;
	 curFileCnt = (curFileCnt == null || curFileCnt < 0) ? 0 : curFileCnt;
	 $("#currentFileCnt" + pstid).val(curFileCnt)
	 fn_deleteFile(fileid, fileIdntfcKey);
	 $("#inputFiles" + fileid).remove();
 } 
 
 </script> 
 	   

