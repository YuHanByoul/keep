<form class=" form-horizontal row-border" id="faqRegForm">

        <div class="panel panel-default">
          <div class="panel-heading">
					<h4>>FAQ 보기 & 수정</h4>
		  </div>
          <div class="panel-body">
				<div class="form-group">
					<label for="inputEmail3" class="col-sm-2 control-label"><span class="text-danger">* </span>FAQ 대상</label>
					<div class="col-sm-10 form-control-static">
							<div class="faq-radio"> 
                                <input type="radio" name="userSeCd" id="userSeCd11" value="P" checked><label for="userSeCd11">개인</label>
                                <input type="radio" name="userSeCd" id="userSeCd22" value="C"><label for="userSeCd22">기업</label>
							</div>
					</div>
				</div>
				<div class="form-group">
					<label for="clid" class="col-sm-2 control-label"><span class="text-danger">*</span>FAQ	분류</label>
					<div class="col-sm-10 form-control-static">
						<select kattr:faq-category-list="clid" name="clid" id="clid" class="form-control input-sm" style="width: 200px; padding:0px; padding-left:10px;"></select>
					</div>
				</div>

				<div class="form-group">
					<label for="inputEmail3" class="col-sm-2 control-label"><span class="text-danger">* </span>FAQ 제목</label>
					<div class="col-sm-10 form-control-static">
						<input type="text" class="form-control input-sm" id="title" name="title" required
							placeholder="제목">
					</div>
				</div>
				<div class="form-group">
					<label for="inputEmail3" class="col-sm-2 control-label"><span class="text-danger">* </span>FAQ 내용</label>
					<div class="col-sm-10 form-control-static">
						<textarea id="cntnts" name="cntnts" ></textarea>
					</div>
				</div>
				
				<div class="form-group">
					<label for="inputEmail3" class="col-sm-2 control-label"><span class="text-danger">* </span>FAQ 사용여부</label>
					<div class="col-sm-10 form-control-static">

						<div class="radio">
							<label> 
							   <span kattr:radio_yn="useYn" label1="사용" label2="미사용"  defaultVal="N" ></span>
							</label>
						</div>
					</div>
				</div>
				
				<div class="form-group">
					<div class="col-sm-offset-2 col-sm-10 text-right">
						<input type="button"  class="btn btn-primary" onclick="fn_modifyFaq()" value="저장"/>
						<a href="#" class="btn btn-default" onclick="toggleContent()"> 취소 </a>
					</div>
				</div>
		</div>
   </div>
   
</form>
		<script>
		//$.getScript( "/js/mng/faq/FAQ.js" );
		var editor;
		$(function(){
			 //editor = CKEDITOR.replace( 'cntnts' );
			 //에디터 엔터키 두줄 바꿈 제거 (shift + enter 처럼 바로 한줄 밑으로 떨어지게 함 )
			 editor =CKEDITOR.replace('cntnts', {enterMode: CKEDITOR.ENTER_BR});
			 
			 validate();
			 
			 fn_getClSelectBoxData();
			 
			 $('#faqRegForm input:radio[name=userSeCd]').click(function(){
					fn_getClSelectBoxData();
			 })			 
		});
		
		function fn_writeClSelectBox(data){
			var seledctedCD ="";
			if($("#clid").val()!=null && $("#clid").val()!= ''){
				seledctedCD =$("#clid").val();
			}
			var optionStr="<option value=''>선택</optipon>";
			for(var i=0 ;i < data.length; i++){
				optionStr += "<option value='" +data[i].clid +"'";
				if(seledctedCD == data[i].clid){
					optionStr += " selected "
				}
				optionStr += ">"+data[i].clNm+"</option>"
			}
			$("#clid").html(optionStr);
		}
		
		function fn_getClSelectBoxData(){
			var params ={
				 "userSeCd" : $('#faqRegForm input:radio[name=userSeCd]:checked').val()
				,"useYn" :'Y'
			}

			$.ajax({
				url : "/mng/faq/selectClList.do",
				contentType: "application/json; charset=utf-8",
				type: 'POST',
				cache : false,
				dataType: 'json',
				data :JSON.stringify(params),
				success : function (data){
                    fn_writeClSelectBox(data.list);
				},
			 	error : function (error){
				} 
			});
		}
		
		function validate(){
			$("#faqRegForm").validate({
			ignore:[],
		    rules   : {
		    	clid    : { required: true }
		    	,title  : { required: true } 
		    	,cntnts : { required: true } 
			},
		    messages: {
		    	clid    : { required: "FAQ 분류를 입력해 주십시오." } 
		    	,title  : { required: "FAQ 제목을 입력해 주십시오." } 
		    	,cntnts : { required: "FAQ 내용을 입력해 주십시오." }
			}
		   })
		}	
		
		function fn_modifyFaq(){
			
			$("#cntnts").val(editor.getData());
			
			if(!$("#faqRegForm").valid()){ return;}
			
			var params = { 
					"userSeCd": $("#faqRegForm input[name='userSeCd']:checked").val(),
					"clid": $("#faqRegForm select[name='clid']").val(),
					"title":  $("#faqRegForm input[name='title']").val(),
					"cntnts": editor.getData(),
					"useYn": $("#faqRegForm input[name='useYn']:checked").val()
			}
			
			FAQ.insert(params, function(){console.log('OK'); alert('등록되었습니다.'); resetListContent(); });
			
		}
		
				/**
		 * FAQ
		 */
		var FAQ = {
			insert: function(item, callback){
					let data = {
							"userSeCd": item.userSeCd,
							"clid": item.clid,
							"title": item.title,
							"cntnts": item.cntnts,
							"ord": item.ord,
							"useYn": item.useYn
					};
					$.ajax({
		                type: "POST",
		                contentType: "application/json; charset=utf-8",
		                url: "/mng/faq/add.do",
		                data: JSON.stringify(data),
		                dataType: "json"
		              }).done(function(response){

		            	  if(!response){
		            		  alert("추가에 실패하였습니다. 권한이 있는지 확인하십시오.");
		            	  }else{
		            	    if(typeof callback === 'function') callback();
		            	  }
		              });
					
			}

		}
		</script>
		
</body>
</html>