<form class=" form-inline form-horizontal row-border" id="insertPopUp">

        <div class="panel panel-default">
          <div class="panel-heading">
					<h4>> 등록</h4>
		  </div>
          <div class="panel-body">
            
              <input type="hidden" id="popupntcid" name="popupntcid"  th:value="${paramVO.popupntcid}"/>
              <input type="hidden" id="sid" th:value="${paramVO.siteid}"/>
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>사이트 </label>
                <div class="col-md-4  form-control-static">
                  <select id="siteid"  name="siteid"  class="form-control input-sm"  style="padding:0px; width:263px;" >
				     <option value=""> - 전체 -</option>
				     <option th:each="item : ${siteList}" th:value="${item.siteid}" th:text="${item.siteNm} "></option>
				  </select>
                </div>
             </div>
             
              <div class="form-group col-md-12 row">
				<label class="col-md-2 control-label"><span class="text-danger">*</span>노출위치</label>
                <div class="col-md-6 form-control-static">
                  <!-- <th:block kattr:radio_code="expsr_lc_cd" grpCd="106" th:attr="selectedCd=${paramVO.expsr_lc_cd}"  addClass=" input-sm" addStyle="padding:0px; width:150px; text-align:center;" ></th:block> -->
                  
                    <div class="form-con custom-radio">
                      <th:block th:if="${paramVO.expsrLcCd} == M" >
                       <label><input type="radio" name="expsrLcCd" value="M" checked ><span>메인</span></label>
                       <label><input type="radio" name="expsrLcCd" value="S"><span>메뉴</span></label>
                      </th:block>
                      <th:block th:if="${paramVO.expsrLcCd} != M" >
                       <label><input type="radio" name="expsrLcCd" value="M"  ><span>메인</span></label>
                       <label><input type="radio" name="expsrLcCd" value="S"checked><span>메뉴</span></label>
                      </th:block>
                    </div>
                  
                  
                </div>                
              </div>
              
              <div class="form-group col-md-12 row" id="selectMenuDiv" >
                <label class="col-md-2 control-label"><span class="text-danger">*</span>메뉴선택</label>
                <div class="col-md-6 form-control-static">
                    <input type="text" id="menuNm" name="menuNm" class="form-control input-sm" th:value="${paramVO.menuNm}" readOnly/>
                    <input type="button" class="btn btn-xs  btn-primary" value="메뉴선택" onclick="fn_openPopUp('menu')" />
                    <input type="hidden" id="menuid" name="menuid" class="form-control-static input-sm" th:value="${paramVO.menuid}"  />
                </div>
              </div>
              
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>로그인 필요여부</label>
                <div class="col-md-10 form-control-static">
                   <span kattr:radio_yn="loginNeedYn" label1="Y " label2="N"  th:attr="defaultVal=${paramVO.loginNeedYn}" isAdmin="true"></span>
                </div>
              </div>
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>공지대상</label>
                <div class="col-md-10 form-control-static">
                   <!-- <th:block kattr:radio_code="ntc_trgt_cd" grpCd="108"  th:attr="selectedCd=${paramVO.ntc_trgt_cd}" addClass=" input-sm" addStyle="padding:0px; width:150px; text-align:center;" ></th:block> -->
                   
                    <div class="form-con custom-radio">
                     <th:block th:if="${paramVO.ntcTrgtCd}=='T'">
                      <label><input type="radio" name="ntcTrgtCd" value="T" checked><span>전체</span></label>
                      <label><input type="radio" name="ntcTrgtCd" value="R"><span>역할</span></label>
                      </th:block>
                     <th:block th:if="${paramVO.ntcTrgtCd}!='T'">
                      <label><input type="radio" name="ntcTrgtCd" value="T" ><span>전체</span></label>
                      <label><input type="radio" name="ntcTrgtCd" value="R"checked><span>역할</span></label>
                      </th:block>
                    </div>
                   
                   
                </div>
              </div>
              
              <div class="form-group col-md-12 row" id="selectTargetDiv">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>역할선택</label>
                <div class="col-md-6 form-control-static">
                 <input type="text" id="ntcTrgtRoleidNm" name="ntcTrgtRoleidNm" class="form-control input-sm"  th:value="${paramVO.roleNm}" readOnly/>
                 <input type="button" class="btn btn-xs btn-primary" value="역할선택" onclick="fn_openPopUp('role')" />
                 <input type="hidden" id="ntcTrgtRoleid" name="ntcTrgtRoleid" class="form-control-static input-sm"  th:value="${paramVO.ntcTrgtRoleid}"/>
                </div>
              </div>
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>팝업사용기간</label>
                <div class="col-md-10 form-control-static">
                  <th:block kattr:date_pic="strtDt" dateForm="yy-mm-dd" th:attr="dateDefault=${paramVO.strtDt}" addClass="input-sm" addStyle="width:110px;display: inline-block;"></th:block>~
				  <th:block kattr:date_pic="endDt"  dateForm="yy-mm-dd" th:attr="dateDefault=${paramVO.endDt}" addClass="input-sm" addStyle="width:110px;display: inline-block;"></th:block>
                </div>
              </div>
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>팝업창 사이즈 </label>
                <div class="col-md-10 form-control-static">
                <label >가로 :</label>
	            <input type="text" id="widthSize" name="widthSize" class="form-control input-sm"  style="width:100px" th:value="${paramVO.widthSize}"/>
                <label >&nbsp;&nbsp;세로 &nbsp;:&nbsp;</label>
	            <input type="text" id="vrticlSize" name="vrticlSize" class="form-control input-sm"  style="width:100px" th:value="${paramVO.vrticlSize}"/>
                </div>
              </div>
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>팝업창 위치</label>
                <div class="col-md-10 form-control-static">
                <label >TOP :</label>
	            <input type="text" id="topLc" name="topLc"   class="form-control input-sm "  style="width:100px" th:value="${paramVO.topLc }"/>
                <label >&nbsp;&nbsp;LEFT :</label>
	            <input type="text" id="leftLc" name="leftLc" class="form-control input-sm "  style="width:100px" th:value="${paramVO.leftLc}"/>
                </div>
              </div>
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>팝업창 유형 </label>
                <div class="col-md-10 form-control-static">
                   <!-- <th:block kattr:radio_code="popup_type_cd" grpCd="107" th:attr="selectedCd=${paramVO.popup_type_cd}"  addClass=" input-sm" addStyle="padding:0px; width:150px; text-align:center;" ></th:block> -->
                   <div class="form-con custom-radio">
                      <th:block th:if="${paramVO.popupTypeCd} =='P'">
                      <label><input type="radio" name="popupTypeCd" value="P" checked><span>팝업</span></label>
                      <label><input type="radio" name="popupTypeCd" value="L"><span>레이어</span></label>
                      <label><input type="radio" name="popupTypeCd" value="M"><span>모달</span></label>
                      </th:block>
                      <th:block th:if="${paramVO.popupTypeCd} == 'L' ">
                      <label><input type="radio" name="popupTypeCd" value="P" ><span>팝업</span></label>
                      <label><input type="radio" name="popupTypeCd" value="L" checked><span>레이어</span></label>
                      <label><input type="radio" name="popupTypeCd" value="M"><span>모달</span></label>
                      </th:block>
                      <th:block th:if="${paramVO.popupTypeCd} == 'M' ">
                      <label><input type="radio" name="popupTypeCd" value="P" ><span>팝업</span></label>
                      <label><input type="radio" name="popupTypeCd" value="L"><span>레이어</span></label>
                      <label><input type="radio" name="popupTypeCd" value="M"checked><span>모달</span></label>
                      </th:block>
                    </div>
                    
                </div>
              </div>
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>제목</label>
                <div class="col-md-10 form-control-static">
                  <input type="text" id="title" name="title" class="form-control input-sm" style="width:500px" th:value="${paramVO.title}"/>
                </div>
              </div>
              
              <div class="form-group col-md-12 row">
                <label class="col-md-2 control-label"><span class="text-danger">*</span>내용</label>
                <div class="col-md-10 form-control-static">
                    <textarea id="cntnts" name="cntnts" >
                     <th:block th:text="${paramVO.cntnts}"/>
                    </textarea>
                </div>
              </div>
              
                 <div style= 'text-align : right'> 
                   <input  type="button" class="btn btn-sm btn-primary" id="insertPst" onclick="savePn()" value="수정" />
                   <input  type="button" class="btn btn-sm btn-danger" id="insertPst" onclick="deletePop()" value="삭제" />
		           <input type="button" class="btn btn-sm btn-default"  onclick="resetListContent()" value="취소"/>
  		         </div>
		       	
        </div>
      </div>
      
</form>
    
<script th:inline="javascript">
	var insertPopUpNtUrl = "/mng/pop/insertPopUpNtc.do";
	var updatePopUpNtUrl = "/mng/pop/updatePopUpNtc.do";
	var deletePopUpNtUrl = "/mng/pop/deletePopUpNtc.do";
	var editor = null;
	
	$(function(){
		/*<![CDATA[*/ 
		var siteid = /*[[ ${paramVO.siteid} ]]*/null; 
		/*]]>*/
		$("#insertPopUp select[name='siteid']").val(siteid);
		editor = CKEDITOR.replace('cntnts');
		validate();
		
		$("input:radio[name=expsrLcCd]").click(function(){
			fn_disableEexpsrLcCd();
		})
		$("input:radio[name=ntcTrgtCd]").click(function(){
			fn_disableTargetCd();
		})
		fn_disableEexpsrLcCd();
		fn_disableTargetCd()
	});
	
	function fn_disableEexpsrLcCd(){
		var chkCd = $("input:radio[name=expsrLcCd]:checked").val();
		if(chkCd=="M"){
			$("#selectMenuDiv").css("display","none");
			$("#menuid").attr("disabled",true);
			$("#menuNm").attr("disabled",true);
		}else{
			$("#selectMenuDiv").css("display","block");
			$("#menuid").attr("disabled",false);
			$("#menuNm").attr("disabled",false);
		}
		
	}
	
	function fn_disableTargetCd(){
		var chkCd = $("input:radio[name=ntcTrgtCd]:checked").val();
		if(chkCd=="T"){
			$("#selectTargetDiv").css("display","none");
			$("#ntcTrgtRoleid").attr("disabled",true);
			$("#ntcTrgtRoleidNm").attr("disabled",true);
		}else{
			$("#selectTargetDiv").css("display","block");
			$("#ntcTrgtRoleid").attr("disabled",false);
			$("#ntcTrgtRoleidNm").attr("disabled",false);
		}
		
	}

	function validate(){
		$("#insertPopUp").validate({
			ignore: [], // 에디터 사용시 추가해야한다.
		    rules: {
		    	siteid : {required: true }
		    	,loginNeedYn: {required: true }
		    	,menuNm: {required: true }
		    	,ntcTrgtRoleidNm: {required: true }
		    	,strtDt: {required: true }
		    	,endDt: {required: true }
		    	,widthSize: {required: true , digits:true }
		    	,vrticlSize: {required: true , digits:true}
		    	,topLc: {required: true , digits:true}
		    	,leftLc: {required: true , digits:true}
		    	,title : {required: true,maxlength: 200 }
		    	,cntnts: {required: true ,maxlength: 4000}
		    },
		    messages: { 
		    	siteid : {required: "사이트를 선택해 주십시오." }
		    	,loginNeedYn: {required: "노출위치를 선택해 주십시오."}
		       	,menuNm: {required: "메뉴아이디를 선택해 주십시오." }
		       	,ntcTrgtRoleidNm: {required: "역할을 선택해 주십시오." }
		    	,strtDt: {required: "팝업시작일자를 입력해 주십시오." }
		    	,endDt: {required: "팝업종료일자를 입력해 주십시오." }
		    	,widthSize: {required: "팝업 가로 사이즈를 입력해 주십시오."  }
		    	,vrticlSize: {required: "팝업 세로 사이즈를 입력해 주십시오." }
		    	,topLc: {required: "팝업  top 위치를 입력해 주십시오."  }
		    	,leftLc: {required: "팝업 left 위치를 입력해 주십시오." }
		    	,title:  {required: "팝업제목을 입력해 주십시오.", maxlength: "팝업 제목은 200자를 넘을 수 없습니다."   }
		    	,cntnts: {required: "팝업내용을 입력해 주십시오." , maxlength: "팝업 내용은 4000자를 넘을 수 없습니다." }
		    }
		});
	}
	
	function savePn(){
		
		$('#cntnts').val(editor.getData());
		if(!$('#insertPopUp').valid()) return;
		if(displayWorkProgress()){
			$.ajax({
				url: updatePopUpNtUrl,
				cache: false,
				dataType: 'json',
				data: $("#insertPopUp").serialize(),
				success: function(data){
					alert(data.msg);
					closeWorkProgress();
					resetListContent();
				}
			});
		}
	}
	
	function deletePop(){
		if(displayWorkProgress()){
			$.ajax({
				url: deletePopUpNtUrl,
				cache: false,
				dataType: 'json',
				data: { popupntcid: $("#popupntcid").val() },
				success: function(data){
					alert(data.msg);
					closeWorkProgress();
					resetListContent();
				}
			});
		}
	}
</script>
    
</body>