<form id="dsptCheckFrm" name="dsptCheckFrm"onsubmit="return false;">
<input type="hidden" id="aplyid" name="aplyid" th:value="${popupVo.aplyid}">

    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content type_2">
            <div class="modal-header">
                <h4 class="modal-title">입금확인</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card m-b-10">
                    <div class="card-block-small">
                        <div class="table-responsive">
                            <table class="table table-bordered td-wrap">
                                <colgroup>
                                    <col style="width:18%">
                                    <col style="width:32%">
                                    <col style="width:18%">
                                    <col style="width:32%">
                                </colgroup>
                                <tbody>
                                <tr>
                                    <th class="text-center v-middle table-light">시설</th>
                                    <td class="v-middle"><th:block th:text="${popupVo.fcltNm}"/></td>
                                    <th class="text-center v-middle table-light">공간</th>
                                    <td class="v-middle"><th:block th:text="${popupVo.spceNm}"/></td>
                                </tr>
                                <tr>
                                    <th class="text-center v-middle table-light">이용일시(금액)</th>
                                    <td class="v-middle">
			                            <th:block th:with="exid= ${#strings.arraySplit(popupVo.resveDt,'/')} ">
			                                <th:block th:each="item:${exid}" >[[${item}]]<br/>
			                                </th:block>
			                            </th:block>
                                    </td>
                                    <th class="text-center v-middle table-light">결제금액</th>
                                    <td class="v-middle"><th:block th:text="${#numbers.formatInteger(popupVo.amt, 0, 'COMMA') + '원'}"/></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <h3 class="sub-title mt-2"><strong>입금 정보</strong></h3>
                        <div class="row">
                            <div class="col-12 col-lg-6 mb-2">
                                <div class="mb-0 form-group required">
                                    <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="dpstDe"><strong>입금일</strong></label>
                                    <div class="col-12">
                                        <input type="date" class="form-control form-control-sm" name="dpstDe" id="dpstDe" th:value="${popupVo.dpstDe}">
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-lg-6 mb-3">
                                <div class="mb-0 form-group required">
                                    <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="dpstAmt"><strong>입금금액</strong></label>
                                    <div class="d-flex align-items-center">
                                        <div class="col">
                                            <input type="text" class="form-control form-control-sm" name="dpstAmt" id="dpstAmt" th:value="${#numbers.formatInteger(popupVo.dpstAmt, 0, 'COMMA')}">
                                        </div>
                                        <span class="ps-2">원</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="saveBtn" class="btn btn-primary waves-effect waves-light "   onclick="saveDsptCheck()">저장</button>
            </div>
        </div>
    </div>
</form>

<script th:inline="javascript">

$(function(){
	$("#dpstDe").val(new Date().toISOString().slice(0, 10));
})

var validator = $("#dsptCheckFrm").validate({
    onsubmit: false,
      rules: {
    	     dpstDe    : { required :true }
            , dpstAmt  : { required :true, number :true }
        },
        messages: {
    	     dpstDe    : { required : "입금일을 입력해주십시오."}
            , dpstAmt  : { required : "입금금액을 입력해주십시오.", number : "숫자만 입력 가능 합니다." }
        }
})

function saveDsptCheck() {

	if(!($("#dsptCheckFrm").valid())) return;
	
	if(!confirm("입금확인처리 하시겠습니까?")){return;}
	
	var paramData = {
         "aplyid"   : $("#dsptCheckFrm #aplyid").val()
        , "dpstDe"  : $("#dsptCheckFrm #dpstDe").val()
        , "dpstAmt" : $("#dsptCheckFrm #dpstAmt").val().replace(/,/g, "")
    }
	
	if(displayWorkProgress()){
    
	    $.ajax({
	        url: "/mng/rcpmnyBfe/updateDsptCheck.do",
	        type: 'POST',
	        cache : false,
	        dataType: 'json',
	        data : paramData,
	        success : function (data){
	            if(data.result=="success"){
	                alert(data.msg);
	                gridHelper2.resetPageContent();
	                dsptCheckAddModal.hide();
	            }else{
	                alert(data.msg);
	            }
	            closeWorkProgress();
	        },
	        error : function (error){
	        }
	    });
	}
    
};

</script>