<form id="refndFrm">
    <input type="hidden" id="aplyid" name="aplyid" th:value="${rcpmnyAfter.aplyid}">

    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content type_2">
            <div class="modal-header">
                <h4 class="modal-title">입금확인</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="mb-10 card-block-small">
                        <div class="mb-2 row align-items-end">
                            <div class="mb-2 row">
                                <div class="col-12 col-lg-6">
                                    <div class="mb-0 form-group row">
                                        <label class="col-md-2 control-label"><span class="text-danger"> </span>시설</label>
                                        <div class="col-md-10 form-control-static" style="text-align:left;">
                                            <label class="form-control-static"><th:block th:text="${rcpmnyAfter.fcltNm}"/></label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-6">
                                    <div class="mb-0 form-group row">
                                        <label class="col-md-2 control-label"><span class="text-danger"> </span>공간</label>
                                        <div class="col-md-10 form-control-static" style="text-align:left;">
                                            <label class="form-control-static"><th:block th:text="${rcpmnyAfter.spceNm}"/></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-2 row">
                                <div class="col-12 col-lg-6">
                                    <div class="mb-0 form-group row">
                                        <label class="col-md-2 control-label"><span class="text-danger"> </span>이용일(시)</label>
                                        <div class="col-md-10 form-control-static" style="text-align:left;">
                                            <label class="form-control-static">
                                                <th:block th:text="${#dates.format(rcpmnyAfter.bgngDt, 'yyyy-MM-dd')}"/> ~
                                                <th:block th:text="${#dates.format(rcpmnyAfter.endDt, 'yyyy-MM-dd')}"/>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-6">
                                    <div class="mb-0 form-group row">
                                        <label class="col-md-2 control-label"><span class="text-danger"> </span>결제금액</label>
                                        <div class="col-md-10 form-control-static" style="text-align:left;">
                                            <label class="form-control-static"><th:block th:text="${rcpmnyAfter.amt}"/></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-2 row">
                                <div class="col-12 col-lg-6">
                                    <div class="mb-0 form-group row">
                                        <label class="col-md-2 control-label"><span class="text-danger"> </span>입금금액</label>
                                        <div class="col-md-10 form-control-static" style="text-align:left;">
                                            <label class="form-control-static"><th:block th:text="${rcpmnyAfter.dpstAmt}"/></label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-6">
                                    <div class="mb-0 form-group row">
                                        <label class="col-md-2 control-label"><span class="text-danger"> </span>입금일</label>
                                        <div class="col-md-10 form-control-static" style="text-align:left;">
                                            <label class="form-control-static"><th:block th:text="${rcpmnyAfter.dpstDe}"/></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card m-b-10">
                    <div class="card-block-small">
                        <div class="mb-2 row">
                            <div class="col-12">
                                <div class="mb-0 form-group row">
                                    <label class="col-md-2 control-label"><span class="text-danger"> </span>환불요청금액</label>
                                    <div class="col-md-10 form-control-static" style="text-align:left;">
                                        <input type="text" class="form-control form-control-sm" name="rfndAmt" id="rfndAmt" placeholder="환불요청금액" th:value="${rcpmnyAfter.rfndAmt}"/>
                                        원
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-0 form-group required">
                            <span class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>환불요청정보</strong></span>
                            <div class="col-sm-12 row">
                                <div class="col-sm-4">
                                    <span kattr:select_code="rfndBankCd" grpCd="154" firstOptTxt="- 선택 -" th:attr="selectedCd=${rcpmnyAfter.rfndBankCd}" addClass="form-select form-select-sm form-control-sm" ></span>
                                </div>
                                <div class="col-sm-5">
                                    <input type="text" class="form-control form-control-sm" name="rfndBacnt" id="rfndBacnt" placeholder="입금계좌번호" th:value="${rcpmnyAfter.rfndBacnt}"/>
                                </div>
                                <div class="col-sm-3">
                                    <input type="text" class="form-control form-control-sm" name="rfndPyrNm" id="rfndPyrNm" placeholder="예금주명" th:value="${rcpmnyAfter.rfndPyrNm}"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="saveBtn" class="btn btn-primary waves-effect waves-light "   onclick="saveResveCancel()">저장</button>
            </div>
        </div>
    </div>
</form>
<script th:inline="javascript">

    function saveResveCancel() {

        if(!confirm("환불처리 하시겠습니까?")){return;}

        var data = {
            "aplyid"      : $("#aplyid").val()
            , "rfndAmt"      : $("#rfndAmt").val()
            , "rfndBankCd" : $("#rfndBankCd").val()
            , "rfndBacnt" : $("#rfndBacnt").val()
            , "rfndPyrNm" : $("#rfndPyrNm").val()
        }

        $.ajax({
            url: "/mng/rcpmnyAfter/updateRefnd.do",
            type: 'POST',
            cache : false,
            dataType: 'json',
            data : data,
            success : function (data){
                if(data.result=="success"){
                    alert("환불처리가 완료 되었습니다.");
                    refndAddModal.hide();
                    gridHelper2.resetPageContent();
                }else{
                    alert("환불처리중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
                }
            },
            error : function (error){
            }
        });
    };

</script>