<form id="suppSaveForm">
<input type="hidden" id="aplyid" name="aplyid" th:value="${supplementVo.aplyid}">
<input type="hidden" id="splmntid" name="splmntid" th:value="${supplementVo.splmntid}">
<input type="hidden" id="ansSttsCd" name="ansSttsCd" th:value="${supplementVo.ansSttsCd}">
    <div id="ansIng" class="modal-dialog modal-lg" role="document">
        <div class="modal-content type_2">
            <div class="modal-header">
                <h4 class="modal-title">보완요청</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card m-b-10">
                    <div class="card-block-small">
                        <div class="mb-2 form-group row required">
                            <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="appointedApprovalPopupDegree"><strong>내용</strong></label>
                            <div class="col-12">
                                <textarea rows="5" cols="5" class="form-control form-control-sm" placeholder="Default textarea" id="dmndCn" name="dmndCn"><th:block th:text="${supplementVo.dmndCn}"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="saveBtn" class="btn btn-primary waves-effect waves-light" onclick="saveSupp()">저장</button>
            </div>
        </div>
    </div>
</form>

<div id="ansSucc" class="modal-dialog modal-lg" role="document">
    <div class="modal-content type_2">
        <div class="modal-header">
            <h4 class="modal-title">보완완료</h4>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                <span aria-hidden="true"></span>
            </button>
        </div>
        <div class="modal-body">
            <div class="card m-b-10">
                <div class="card-block-small">
                    <div class="mb-3 form-group row required">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="popInput02"><strong>내용</strong></label>
                        <div class="col-12">
<!--                             <input type="text" class="form-control form-control-sm" name="popInput02" id="popInput02" th:value="${supplementVo.dmndCn}" readonly=""> -->
                            <textarea rows="5" cols="5" class="form-control form-control-sm"><th:block th:text="${supplementVo.dmndCn}" readonly="readonly"></textarea>
                        </div>
                    </div>
                    <div class="mb-0 form-group row required">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="popInput03"><strong>답변내용</strong></label>
                        <div class="col-12">
                            <textarea rows="5" cols="5" class="form-control form-control-sm"><th:block th:text="${supplementVo.ansCn}" readonly></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary waves-effect waves-light" onclick="suppModal.hide();">확인</button>
        </div>
    </div>
</div>

<script th:inline="javascript">
if ($("#ansSttsCd").val() == "201101") {
	$("#ansIng").show();
	$("#ansSucc").hide();	
} else {
	$("#ansIng").hide();
    $("#ansSucc").show();   
}

var validator= $("#chgAplyDtlPopupFrm").validate({
    rules    : { dmndCn : { required: true, maxlength: 500 } }
  , messages : { dmndCn : { required:"보완요청 내용을 입력해 주십시오." , maxlength: '내용은 500자를 넘을 수 없습니다.' } }
});

function saveSupp() {
	var vUrl = "";
	if(0 == Number($("#splmntid").val())){
    	//insert
		vUrl = "/mng/bizAply/req/insertSplmnt.do";
	}else{
		//update
		vUrl = "/mng/bizAply/req/updateSplmnt.do";
	}
	if(!($("#suppSaveForm").valid())) return;
	if(!confirm("저장 하시겠습니까?")){return;}

	var data =  $("#suppSaveForm").serialize();
    $.ajax({
        url : vUrl,
        type: 'POST',
        cache : false,
        dataType: 'json',
        data : data,
        success : function (data){
            if(data.result=="success"){
                alert("저장이 완료 되었습니다.");
                suppModal.hide();
                gridHelper2.resetListContent();
            }else{
                alert("저장중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
            }
        },
        error : function (error){
        }
    });
};

</script>