<!-- [팝업] 보완완료 -->
<form id="rptSplmntDmndPopupFrm">
    <input type="hidden" id="mode" name="mode" th:value="${mode}">
    <input type="hidden" id="reportid" name="reportid" th:value="${reportid}">

    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content type_2">
            <div class="modal-header">
                <h4 class="modal-title">보완요청</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card m-b-10">
                    <div class="card-block-small">
                        <div class="mb-3 form-group row required">
                            <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="popInput02"><strong>내용</strong></label>
                            <div class="col-12">
                                <textarea rows="5" cols="5" class="form-control form-control-sm" placeholder="보완요청 내용" id="dmndCn" name="dmndCn"></textarea>
                            </div>
                        </div>
                        <div class="mb-0 form-group row required" id="ansCnDiv">
                            <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="popInput03"><strong>답변내용</strong></label>
                            <div class="col-12">
                                <textarea rows="5" cols="5" class="form-control form-control-sm" placeholder="Default textarea" id="ansCn" name="ansCn" readonly=""></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary waves-effect waves-light" onclick="rptSplmntDmndPop.saveFrm();">저장</button>
            </div>
        </div>
    </div>
</form>
<!-- //[팝업] 보완완료 -->
<script th:inline="javascript">
    /*<![CDATA[*/
	var  rptSplmntDmndDtlInfo = /*[[ ${rptSplmntDmndDtlInfo} ]]*/null;
	/*]]*/

	var validator= $("#rptSplmntDmndPopupFrm").validate({
        rules: {
            dmmCn : { required: true, maxlength:500 }
        },
        messages: {
        	dmmCn : { required:"내용을 입력해주십시오", maxlength:"내용은 500자 이하여야 합니다."}
        }
    })

    var rptSplmntDmndPop = {

    	insertUrl: "/mng/bizAply/bizRpt/insertRptSplmnt.do",
        init:function(){
        	//보완요청
        	if($("#mode").val() == "req"){
        		$("#ansCnDiv").hide();
        	}else{
        		$("#ansCnDiv").show();
        	}
        },
        saveFrm : function(){

        	if($("#mode").val() == "req"){
        		if(!($("#rptSplmntDmndPopupFrm").valid())) return;

                if(!confirm("저장하시겠습니까?")) return;

                var data = $("#rptSplmntDmndPopupFrm").serialize();

                if(displayWorkProgress()){
                    $.ajax({
                        url : rptSplmntDmndPop.insertUrl,
                        type: 'POST',
                        cache : false,
                        dataType: 'json',
                        data : data,
                        success : function (data){
                        	debugger;
                            if(data.result=="success"){
                                alert(data.msg);
                                rptSplmntDmndModal.hide();
                                mdlRptSbmsnDtl.setGrid();

                            }else{
                                alert(data.msg);
                            }
                            closeWorkProgress();
                        }
                    });
                }

        	}
        }
    };

    $(function() {
    	rptSplmntDmndPop.init();
    });
</script>