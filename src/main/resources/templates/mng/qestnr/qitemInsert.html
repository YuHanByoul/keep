<form id ="qitemInsertForm">
    <div class="card-header p-t-0 p-b-0">
        <h3 class="sub-title"><strong>문항유형</strong></h3>
    </div>
    <div class="card-block-small p-t-0">
        <div class="mb-2 row">
            <div class="col-12 col-lg-6">
                <div class="mb-0 form-group">
                    <div class="col-sm-12">
                        <th:block kattr:select_code="qitemTypeCd" grpCd="107" upprCd="0" selectedCd="107100" onchange="qitemInsert.onChangeQitemType" firstOptTxt="" addClass="form-select form-select-sm form-control-sm" isAdmin="true"></th:block>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card-block-small p-t-0">
        <div class="mb-2 form-group row required">
            <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="oxTypeProblem"><strong>문항</strong></label>
            <div class="col-sm-12">
                <textarea rows="5" cols="5" class="form-control form-control-sm" placeholder="문항을 입력해주세요." id="cn" name="cn"></textarea>
            </div>
        </div>
        <div class="mb-2 form-group row">
            <div class="col-12">
                <input type="checkbox" class="js-single-small" name="useYn" id="useYn" checked/>
                <label for="oxTypeUseStatus" class="v-middle">문항 사용</label>
            </div>
        </div>
        <!--선택형-->
        <div class="col-12" id="qitemType107100">
            <div class="mb-2 form-group required row">
                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>보기수</strong></div>
                <div class="col-12">
                    <select name="exCnt107100" id="exCnt107100" class="form-select form-select-sm form-control-sm" onchange="qitemInsert.onChangeExCnt();">
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4" selected>4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                    </select>
                </div>
            </div>
            <div class="mb-2 form-group row" id="exRow1071001">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071001"><strong>1번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071001" id="exCn1071001" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row" id="exRow1071002">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071002"><strong>2번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071002" id="exCn1071002" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row" id="exRow1071003">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071003"><strong>3번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071003" id="exCn1071003" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row" id="exRow1071004">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071004"><strong>4번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071004" id="exCn1071004" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row d-none" id="exRow1071005">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071005"><strong>5번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071005" id="exCn1071005" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row d-none" id="exRow1071006">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071006"><strong>6번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071006" id="exCn1071006" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-0 form-group row d-none" id="exRow1071007">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071007"><strong>7번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071007" id="exCn1071007" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
        </div>
        <!--//선택형-->
        <!--OX형-->
        <div class="col-12 d-none" id="qitemType107101">
            <div class="mb-2 form-group row">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071011"><strong>O</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn107101" id="exCn1071011" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-0 form-group row">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071012"><strong>X</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071012" id="exCn1071012" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
        </div>
        <!--//OX형-->
        <!--복수선택형-->
        <div class="col-12 d-none" id="qitemType107102">
            <div class="mb-2 form-group required row">
                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>보기수</strong></div>
                <div class="col-12">
                    <select name="exCnt107102" id="exCnt107102" class="form-select form-select-sm form-control-sm" onchange="qitemInsert.onChangeExCnt();">
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4" selected>4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                    </select>
                </div>
            </div>
            <div class="mb-2 form-group row" id="exRow1071021">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071021"><strong>1번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071021" id="exCn1071021" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row" id="exRow1071022">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071022"><strong>2번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071022" id="exCn1071022" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row" id="exRow1071023">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071023"><strong>3번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071023" id="exCn1071023" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row" id="exRow1071024">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071024"><strong>4번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071024" id="exCn1071024" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row d-none" id="exRow1071025">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071025"><strong>5번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071025" id="exCn1071025" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-2 form-group row d-none" id="exRow1071026">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071026"><strong>6번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071026" id="exCn1071026" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
            <div class="mb-0 form-group row d-none" id="exRow1071027">
                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071027"><strong>7번</strong></label>
                <div class="col-sm-12">
                    <input type="text" class="form-control form-control-sm" name="exCn1071027" id="exCn1071027" placeholder="보기 내용을 입력해주세요."/>
                </div>
            </div>
        </div>
        <!--//복수선택형-->
        <!--척도형-->
        <div class="col-12 d-none" id="qitemType107103">
            <div class="mb-2 form-group required row">
                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>보기수</strong></div>
                <div class="col-12">
                    <select name="exCnt107103" id="exCnt107103" class="form-select form-select-sm form-control-sm" onchange="qitemInsert.onChangeExCnt();">
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5" selected>5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                    </select>
                </div>
            </div>

            <div class="mb-2 row" id="exRow1071031">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071031"><strong>1번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071031" id="exCn1071031" placeholder="보기 내용을 입력해주세요." value="매우 그렇다"/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exScr1071031"><strong>1번 점수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exScr1071031" id="exScr1071031" placeholder="점수를 입력해주세요." value="5"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row" id="exRow1071032">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071032"><strong>2번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071032" id="exCn1071032" placeholder="보기 내용을 입력해주세요." value="그렇다"/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exScr1071032"><strong>2번 점수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exScr1071032" id="exScr1071032" placeholder="점수를 입력해주세요." value="4"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row" id="exRow1071033">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071033"><strong>3번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071033" id="exCn1071033" placeholder="보기 내용을 입력해주세요." value="보통이다"/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exScr1071033"><strong>3번 점수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exScr1071033" id="exScr1071033" placeholder="점수를 입력해주세요." value="3"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row" id="exRow1071034">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071034"><strong>4번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071034" id="exCn1071034" placeholder="보기 내용을 입력해주세요." value="그렇지 않다"/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exScr1071034"><strong>4번 점수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exScr1071034" id="exScr1071034" placeholder="점수를 입력해주세요." value="2"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-0 row" id="exRow1071035">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071035"><strong>5번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071035" id="exCn1071035" placeholder="보기 내용을 입력해주세요." value="전혀 그렇지 않다"/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exScr1071035"><strong>5번 점수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exScr1071035" id="exScr1071035" placeholder="점수를 입력해주세요." value="1"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-0 row d-none" id="exRow1071036">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071036"><strong>6번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071036" id="exCn1071036" placeholder="보기 내용을 입력해주세요." value=""/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exScr1071036"><strong>6번 점수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exScr1071036" id="exScr1071036" placeholder="점수를 입력해주세요." value=""/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-0 row d-none" id="exRow1071037">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071037"><strong>7번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071037" id="exCn1071037" placeholder="보기 내용을 입력해주세요." value=""/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exScr1071037"><strong>7번 점수</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exScr1071037" id="exScr1071037" placeholder="점수를 입력해주세요." value=""/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--//척도형-->
        <!--혼합형-->
        <div class="col-12 d-none" id="qitemType107106">
            <div class="mb-2 form-group required row">
                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>보기수</strong></div>
                <div class="col-12">
                    <select name="exCnt107106" id="exCnt107106" class="form-select form-select-sm form-control-sm" onchange="qitemInsert.onChangeExCnt();">
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5" selected>5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                    </select>
                </div>
            </div>

            <div class="mb-2 row align-items-end" id="exRow1071061">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071061"><strong>1번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071061" id="exCn1071061" placeholder="보기 내용을 입력해주세요."/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <div class="border-checkbox-section">
                            <div class="border-checkbox-group border-checkbox-group-inverse">
                                <input class="border-checkbox" type="checkbox" name="etcYn1071061" id="etcYn1071061">
                                <label class="form-label border-checkbox-label" for="etcYn1071061">
                                    기타
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row align-items-end" id="exRow1071062">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071062"><strong>2번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071062" id="exCn1071062" placeholder="보기 내용을 입력해주세요."/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <div class="border-checkbox-section">
                            <div class="border-checkbox-group border-checkbox-group-inverse">
                                <input class="border-checkbox" type="checkbox" name="etcYn1071062" id="etcYn1071062">
                                <label class="form-label border-checkbox-label" for="etcYn1071062">
                                    기타
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row align-items-end" id="exRow1071063">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071063"><strong>3번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071063" id="exCn1071063" placeholder="보기 내용을 입력해주세요."/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <div class="border-checkbox-section">
                            <div class="border-checkbox-group border-checkbox-group-inverse">
                                <input class="border-checkbox" type="checkbox" name="etcYn1071063" id="etcYn1071063">
                                <label class="form-label border-checkbox-label" for="etcYn1071063">
                                    기타
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row align-items-end" id="exRow1071064">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071064"><strong>4번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071064" id="exCn1071064" placeholder="보기 내용을 입력해주세요."/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <div class="border-checkbox-section">
                            <div class="border-checkbox-group border-checkbox-group-inverse">
                                <input class="border-checkbox" type="checkbox" name="etcYn1071064" id="etcYn1071064">
                                <label class="form-label border-checkbox-label" for="etcYn1071064">
                                    기타
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row align-items-end" id="exRow1071065">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071065"><strong>5번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071065" id="exCn1071065" placeholder="보기 내용을 입력해주세요."/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <div class="border-checkbox-section">
                            <div class="border-checkbox-group border-checkbox-group-inverse">
                                <input class="border-checkbox" type="checkbox" name="etcYn1071065" id="etcYn1071065">
                                <label class="form-label border-checkbox-label" for="etcYn1071065">
                                    기타
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row align-items-end  d-none" id="exRow1071066">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071066"><strong>6번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071066" id="exCn1071066" placeholder="보기 내용을 입력해주세요."/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <div class="border-checkbox-section">
                            <div class="border-checkbox-group border-checkbox-group-inverse">
                                <input class="border-checkbox" type="checkbox" name="etcYn1071066" id="etcYn1071066">
                                <label class="form-label border-checkbox-label" for="etcYn1071066">
                                    기타
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-2 row align-items-end d-none" id="exRow1071067">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="exCn1071067"><strong>7번</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="exCn1071067" id="exCn1071067" placeholder="보기 내용을 입력해주세요."/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-auto">
                    <div class="mb-0 form-group">
                        <div class="border-checkbox-section">
                            <div class="border-checkbox-group border-checkbox-group-inverse">
                                <input class="border-checkbox" type="checkbox" name="etcYn1071067" id="etcYn1071067">
                                <label class="form-label border-checkbox-label" for="etcYn1071067">
                                    기타
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <p class="mb-0 text-warning">&#8251; 기타로 설정한 보기는 서술형 입력을 필수로 입력해야 합니다.</p>
        </div>
        <!--//혼합형-->
    </div>
    
    <div class="card-block-small p-t-0">
        <button type="button" class="btn btn-disabled m-r-5" onclick="qitemInsert.offInsertQitem();">취소</button>
        <th:block sec:authorize-url="/mng/qestnr/insertQestnr.do"><button type="button" class="btn btn-primary" onclick="qitemInsert.onInsertQitem();">저장</button></th:block>
    </div>
</form>

<script th:inline="javascript">
    var qitemInsert = {
        qitemType: "107100",
        
        init: function() {
            var elemsingleSmallList = document.querySelectorAll('.js-single-small');
            for(var i = 0; i < elemsingleSmallList.length; i++) {
                new Switchery(elemsingleSmallList[i], {color: "#4680ff", jackColor: "#fff", size: "small"});
           }
           
           this.registEvent();
           this.setValid();
        },
        
        registEvent: function() {
            var _this = this;
        },
        
        onChangeQitemType: function() {
            var qitemType = $('#qitemTypeCd').val();
            $('#qitemType' + this.qitemType).addClass("d-none");
            $('#qitemType' + qitemType).removeClass("d-none");
            this.qitemType = qitemType;
        },
        
        onChangeExCnt: function() {
            var type = this.qitemType;
            var exCnt = $('#exCnt' + type).val();
            for(var i = 3; i <= 7; i++) {
                var ex = $("#exRow" + type + i);
                if(i > exCnt) {
                    ex.addClass("d-none");
                } else {
                    ex.removeClass("d-none");
                }
            }
        },
        
        setValid: function() {
            var validator = $('#qitemInsertForm').validate({
                rules: {
                    qestnrKndCd: {required: true},
                    cn: {required: true, maxlength: 400},
                },
                messages: {
                    qitemTypeCd: {required: "문항유형을 선택해주세요."},
                    cn: {required: "문항을 입력해주세요.", maxlength: "문항은 400자 이하여야 합니다."},
                }
            });
        },
        
        onInsertQitem: function() {
            if(!($("#qitemInsertForm").valid())) return;
            
            var qitemType = $("#qitemTypeCd").val();
            if(qitemType != "107104" && qitemType != "1071051") { // 선택형, OX형, 복수선택, 척도형, 혼합형 유효성 확인
                var exCnt = $('#exCnt' + qitemType).val();
                if(qitemType == "107101") { // OX형인 경우 보기수는 2개 고정
                    exCnt = 2;
                }
                var exampleList = [];
                for(var i = 1; i <= exCnt; i++) {
                    var cn = $("#exCn" +qitemType + i);
                    var scr = $("#exScr" +qitemType + i);
                    var etcYn = $("#etcYn" + qitemType + i);
                    if(!$.trim(cn.val())) {
                        if(!etcYn.is(":checked")) {
                            alert("보기 내용을 입력해주세요.");
                            cn.focus();
                            return false;                            
                        }
                    } else if(qitemType == "107103") { // 척도형인 경우 점수입력 확인
                        if(!$.trim(scr.val())) {
                            alert("점수를 입력해주세요.");
                            scr.focus();
                            return false;
                        }    
                    }
                    var example = {
                        exNo: i, cn: cn.val(), 
                        scr: qitemType == "107103" ? scr.val() : 0, 
                        etcYn: qitemType == "107106" && etcYn.is(":checked") ? "Y" : "N"
                    };
                    exampleList.push(example);
                }
            }
            
            // 데이터 설정
            var items = $("#qitemGrid").jsGrid("option", "data");
            var param = {
                qestnrid: Number(qestnrDetail.qestnrid[0]),
                qitemTypeCd: qitemType,
                cn: $("#cn").val(),
                exCnt: qitemType != "107104" && qitemType != "1071051" ? exCnt : 0,
                ordr: items.length == 0 ? 1 : items[0].totalCount + 1,
                useYn: $("#useYn").is(":checked") ? "Y" : "N",
                etcYn: "N"
            };
            
            if(qitemType != "107104" && qitemType != "1071051") { // 선택형, OX형, 복수선택, 척도형, 혼합형
                $(exampleList).each(function(index, item) {
                    param["exampleList[" + index + "].exNo"] = item.exNo;
                    param["exampleList[" + index + "].cn"] = item.cn;
                    param["exampleList[" + index + "].scr"] = item.scr;
                    param["exampleList[" + index + "].etcYn"] = item.etcYn;
                });
            }
            
            if(displayWorkProgress()) {
                $.ajax({
                    url : "/mng/qestnr/insertQitem.do",
                    type: "POST",
                    cache: false,
                    dataType: "json",
                    data: param,
                    success: function(response) {
                        if(response.result == "success") {
                            alert(response.msg);
                            qestnrGrid.resetPageContent();
                            qitemGrid.resetListContent();
                            qestnrGrid.showContent();
                        } else {
                            alert(response.msg);
                        }
                        closeWorkProgress();
                    }
                });
            }
        },
        
        offInsertQitem: function() {
            qitemGrid.toggleContent();
        }
    };
    
    qitemInsert.init();
</script>