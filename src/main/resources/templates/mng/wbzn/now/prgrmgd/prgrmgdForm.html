<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
	layout:decorator="layout/mng/mainLayout">

<body>
	<div layout:fragment="content">
		<style>
		.hide
		{
		   display:none;
		}
		</style>
		<form name="searchFrm" id="searchFrm"  action="" class="form-inline" onsubmit="return false;">
		<div class="card">
			<div class="card-block-small">
			    <!-- 키워드 filter -->
			    <div class="row">
			        <div class="col-lg-3 mb-2 mb-lg-0">
			            <div class="mb-0 form-group row">
			                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>키워드</strong></div>
			                <div class="input-group input-group-sm input-group-dropdown mb-0">
			                    <select name="searchType" id="searchType" class="form-select form-control form-control-primary form-bg-primary">
			                        <option value="">- 선택 -</option>
			                        <option value="ttl">제목</option>
			                    </select>
			                    <input type="text" class="form-control form-control-sm" name="searchKeyword" id="searchKeyword" aria-label="Text input with dropdown button">
			                </div>
			            </div>
			        </div>
			        <div class="col-lg-3 mb-2 mb-lg-0">
			            <div class="mb-0 form-group row">
			                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>지역구분</strong></div>
			                <div class="col-sm-12">
			                    <select name="searchSeCd" id="searchSeCd" class="form-select form-select-sm form-control-sm">
			                        <option value="">- 전체 -</option>
			                        <option value="서울">서울</option>
			                        <option value="경기/인천">경기/인천</option>
			                        <option value="강원/제주">강원/제주</option>
			                        <option value="호남권">호남권</option>
			                        <option value="충청권">충청권</option>
			                        <option value="영남권">영남권</option>
			                    </select>
			                </div>
			            </div>
			        </div>
			        <div class="col-lg-3 mb-2 mb-lg-0">
			            <div class="mb-0 form-group row">
			                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>연도</strong></div>
			                <div class="col-sm-12">
			                    <select name="searchYr" id="searchYr" class="form-select form-select-sm form-control-sm">
			                        <option value="">- 전체 -</option>
									<th:block th:each="year : ${years}">
									<option th:value="${year}"><th:block th:text="${year}" /></option>
									</th:block>
			                    </select>
			                </div>
			            </div>
			        </div>
			        <div class="col-lg-3">
			            <div class="mb-0 form-group row">
			                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>월</strong></div>
			                <div class="col-sm-12">
			                    <select name="searchMm" id="searchMm" class="form-select form-select-sm form-control-sm">
			                        <option value="">- 전체 -</option>
									<th:block th:each="month : ${month}">
									<option th:value="${month}"><th:block th:text="${month}" /></option>
									</th:block>
			                    </select>
			                </div>
			            </div>
			        </div>
			    </div>
			    <!-- //키워드 filter -->
			    <!-- 키워드 filter-btn -->
			        <div class="m-t-20 text-center">
			            <button class="btn btn-disabled m-r-5" onclick="fn_init()">초기화</button>
			            <button type="submit" class="btn btn-primary" onclick="fn_searchForm()">검색</button>
			        </div>
			    </div>
			</div>
		</form>

		<div class="row">
			<div class="col-sm-12">
				<div class="card">
					<div class="row p-20 p-b-0">
						<div class="col-12 col-md-6">
							<h5>
								<strong>프로그램안내 검색결과</strong>
							</h5>
						</div>
						<div class="col-12 col-md-6 text-right">
							<button type="button"
								class="btn btn-primary waves-effect waves-light" onclick="fn_goInsertForm();">등록</button>
						</div>
						<div class="card-block">
							<table id="jsGrid" class="table-responsive"></table>
							<div id="listPager" class="text-center"></div>
						</div>
					</div>

				</div>

			</div>
		</div>




		<!-- Content Area -->
		<div id="contentPanel" style="display:none" class="card"></div>
		
		<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
		<script type="text/javascript" src="/js/common/jsgrid-master/dist/jsgrid.min.js"></script>
		<script th:inline="javascript">
			var selectedItems = [];
			var gridHelper1;         
			$(function(){
				gridHelper1 = new GridHelper('jsGrid','contentPanel');
				writeJsGridData();
			});
			
			
		    function fn_goInsertForm(){
		        var insertUrl ="/mng/wbzn/now/prgrmgd/prgrmgdInsertForm.html";
		    	    gridHelper1.loadContent(insertUrl);
		    }
		     
		    function fn_searchForm(){
		    	gridHelper1.resetListContent();
		    }
		    
		    function fn_init() {
		        $("#searchType").val('');
		        $("#searchKeyword").val('');
		        $("#searchSeCd").val('');
		        $("#searchYr").val('');
		        $("#searchMm").val('');
		    }
		        
		    function writeJsGridData(){
				$("#jsGrid").jsGrid({
					height: "auto",
				    width: "100%",
				    autoload: true,
				    sorting: true,
				    paging: true,
				    pagerContainer: "#listPager",
				    pagerFormat: "{first} {prev} {pages} {next} {last}",
				    pagePrevText: "이전",
				    pageNextText: "다음",
				    pageFirstText: " < 처음 ㅣ",
				    pageLastText: " | 마지막 >",
			        pageSize: 10,
			        pageButtonCount: 10,
			        pageLoading: true,
			        pageIndex: 1,
			        noDataContent: "데이터가 없습니다.",
			        
			        controller: {
			            loadData: function (filter) {
			            	var data = $.Deferred();
			            	    	            	
			            	var formData = $('#searchFrm').serializeArray();
			            	var params = [
			            			{name: "pageNumber", value: filter.pageIndex},
			            			{name: "rowPerPage", value: filter.pageSize},
			            	]
			            	
			            	if(filter.sortField != undefined){
			            		params.push({name: "orderField", value: filter.sortField});
		    					params.push({name: "orderDirection", value: filter.sortOrder});
			            	}else{
			            		params.push({name: "orderField", value: 'reg_dt'});
			            	}
		
			            	formData = formData.concat(params);
			            	
			                $.ajax({
			                  type: "GET",
			                  contentType: "application/json; charset=utf-8",
			                  url: "/mng/wbzn/now/prgrmgd/selectPrgrmgdList.do",
			                  dataType: "json",
			                  data: formData
			                }).done(function(response){
			                	var da = {
		                                data : escapeGridData(response.list)
		                                ,itemsCount : response.totalCount
		                            };
			                  data.resolve(da);
			                });
			                return data.promise();
			            },
			        },
			        fields: [
			        	{ name: 'enveduid', css: 'hide' }
		                ,{ title: 'No.' ,name: 'rowNumber',    type: "number", width : "80", align:"center",  sorting :false }
		                ,{ title: '연-월'    ,name: 'yrMm',    type: "text", width: "150", align:"center" }
		                ,{ title: '지역구분'    ,name: 'enveduSeCd', type: "text", width: "150", align:"center" }
		                ,{ title: '제목'   ,name: 'ttl',   type: "text", width: "auto" }
		                ,{ title: '작성자'   ,name: 'nm',   type: "text", width: "150", align:"center" }
		                ,{ title: '등록일' ,name: 'regDt',  type: "text", width: "150", align:"center" }
			        ],
			        rowClick: function(args) {
			        	if(args.event.originalEvent.target.cellIndex == 0 || isNaN(args.event.originalEvent.target.cellIndex)) return;
			        	var detailUrl = "";
						if(args.item.thmbnFileid != null && args.item.filegrpid != null) {
							detailUrl = "/mng/wbzn/now/prgrmgd/prgrmgdUpdateForm.html?enveduid=" + args.item.enveduid + "&thmbnFileid=" + args.item.thmbnFileid + "&filegrpid=" + args.item.filegrpid; 
						}else {
							detailUrl = "/mng/wbzn/now/prgrmgd/prgrmgdUpdateForm.html?enveduid=" + args.item.enveduid; 
						}
			       	    gridHelper1.loadContent(detailUrl);
			       	    gridHelper1.rowClick(args);
			        },
			        onPageChanged: function(args) {
			            selectedItems = [];
			        }
		    	});
		 		
			    var selectItem = function(item) {
				    selectedItems.push(item);
				    if($(".singleCheckbox").length == $(".singleCheckbox:checked").length) {
		                $("#selectAllCheckbox").prop("checked", true);
		            } else {
		                $("#selectAllCheckbox").prop("checked", false);
		            }
				};
			     
			    var unselectItem = function(item) {
				    selectedItems = $.grep(selectedItems, function(i) {
				    return i !== item;
				    });
				    if(selectedItems.length == 0) {
				    	$('#selectAllCheckbox').attr('checked', false);
				    }
				    if($(".singleCheckbox").length == $(".singleCheckbox:checked").length) {
		                $("#selectAllCheckbox").prop("checked", true);
		            } else {
		                $("#selectAllCheckbox").prop("checked", false);
		            }
			    };
				
			    $("#selectAllCheckbox").click(function(item) {
			    	selectedItems = [];
			    	if(this.checked) { // check select status
			            $('.singleCheckbox').each(function() { 
			                this.checked = true;   
			                selectItem($(this).parent().next().text());           
			            });	
			        }else {
			            $('.singleCheckbox').each(function() { 
			                this.checked = false;      
			                unselectItem(item);
			            });  
			            selectedItems = [];
			        }
			   	});
			}
		</script>

		<script src="/js/ckeditor/ckeditor.js"></script>
	</div>
</body>
</html>