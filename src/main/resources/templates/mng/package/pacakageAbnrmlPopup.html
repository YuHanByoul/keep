<!-- [팝업] 이상 등록 -->
<form id="abnrmlFrm">

    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content type_2">
            <div class="modal-header">
                <h4 class="modal-title">이상 등록 </h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card m-b-10">
                    <div class="card-block-small">
                        <div class="mb-3 form-group">
                            <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="code"><strong>개체코드</strong></label>
                            <div class="col-12">
                                <input type="text" class="form-control form-control-sm"  th:value="${resVo.indvdno}" disabled>
                            </div>
                        </div>
                        <div class="border p-20 rounded mb-3">
                            <ul class="box-desc-list">
                            
                                <li class="mb-3" th:each="item,stat : ${tchaidCmpstnList}">
                                    <p class="mb-1"><strong><th:block th:text="${item.tchaidNm}" /> <th:block th:text="${item.qntyCmpstn}" />세트   </strong></p>
                                    <div><th:block th:text="${item.cmpntNms}"></div>
                                </li>
                            </ul>
                        </div>
                        <div class="row form-group required">
                            <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="popupContents"><strong>이상 내용</strong></label>
                            <div class="col-sm-12">
                                <textarea rows="5" cols="5" class="form-control form-control-sm" id="cn" name="cn"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="createAbnrml()">저장</button>
            </div>
        </div>
    </div>
  </form>
 <!-- //[팝업] 이상 등록 -->
 
 <script th:inline="javascript">

	 /*<![CDATA[*/ 
	 var resVo = /*[[${resVo}]]*/null; 
	 /*]]>*/

	 var validator= $("#abnrmlFrm").validate({
	      onsubmit: false,
	        rules: {
	              cn  :  { required: true , maxlength: 500}
	          },
	          messages: {
	              cn  :  { required: "이상내용을 입력해주십시오" ,maxlength :"이상내용을 100자를 넘을 수 없습니다."}
	          }
	 })
	 
	 createAbnrml=()=>{
	
		  if(!($("#abnrmlFrm").valid())) return;
	
	      if(!confirm("꾸러미 개체를 이상 상태로 저장합니다.")) return;
	      
	      if(displayWorkProgress()){
	          $.ajax({
	              url : "/mng/package/insertPackageindvdAbnrm.do",
	              type: 'POST',
	              cache : false,
	              traditional : true, //필수
	              dataType: 'json',
	              data : {
	            	      packageindvdid  : resVo.packageindvdid
	                     ,cn   : $("#cn").val()
	                     ,nrmltYn :"N"
		                 ,nrmltPrcsYn :"N"
	              },
	              success : function (data){
	                  if(data.result=="success"){
	                      alert(data.msg);
	                      var curPage = $("#detailJsGrid").jsGrid("option", "pageIndex");
	                      $("#detailJsGrid").jsGrid("openPage", curPage);
	                      packageModal.hide();
	                      $("#detailContentPanel").html("");
	                  }else{
	                      alert(data.msg);
	                  }
	                  
	                  closeWorkProgress();
	              }
	          });
	      }
	   }
</script>
