<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
	layout:decorator="layout/mng/mainLayout">

<body>
	<div layout:fragment="content">
        <style>
        .hide
        {
           display:none;
        }
        </style>
	
		<div class="page-body">
			<div class="row">
			    <!-- 필터 부분 -->
                <div class="col-12">
					<!-- Date-range picker css  -->
					<link rel="stylesheet" type="text/css" href="/files/bower_components/bootstrap-daterangepicker/daterangepicker.css">
					<form name="searchFrm" id="searchFrm" action="@{/}" onsubmit="return false;" class="card">
					
						<!-- 필터 부분 -->
	                    <div class="card-block-small">
	                        <div class="row">
	                            <div class="col-lg-3 col-md-6 mb-3">
	                                <div class="mb-0 form-group row">
	                                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>사업분야</strong></div>
	                                    <div class="col-12">
	                                        <th:block kattr:select_code="searchFldCd" grpCd="173" upprCd="0" selectedCd="" onchange="" firstOptTxt="- 전체 -" isAdmin="true"></th:block>
	                                    </div>
	                                </div>
	                            </div>
	                            <div class="col-lg-3 col-md-6 mb-3">
	                                <div class="mb-0 form-group row">
	                                    <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="filterOperationAgency"><strong>공모명</strong></label>
	                                    <div class="col-12">
	                                        <input type="text" class="form-control form-control-sm" id="searchPcntstNm" name="searchPcntstNm" aria-label="Text input with dropdown button">
	                                    </div>
	                                </div>
	                            </div>
	                        </div>
	                        <div class="mt-1 p-t-20 text-center border-top">
	                            <button class="btn btn-disabled m-r-5" onclick="fn_init()">초기화</button>
	                            <button class="btn btn-primary" onclick="fn_searchForm()">검색</button>
	                        </div>
	                    </div>
					</form>
                </div>
                <div class="col-12">
					<div class="card">
                        <div class="row p-20 p-b-0">
                            <div class="col-12">
                                <h5><strong>잔액 및 이자관리 검색결과</strong></h5>
                            </div>
                        </div>
						<div class="card-block-small">
							<div class="dt-responsive table-responsive">
								<div id="order-table_wrapper" class="dataTables_wrapper dt-bootstrap4">
									<table id="jsGrid" class="table-responsive"></table>
									<div id="listPager" class="text-center"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- Content Area -->
				<div class="col-12">
				   <div id="contentPanel" style="display: none" class="card"></div>
				</div>   
			</div>
		</div>
		<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
		<script type="text/javascript" src="/js/common/jsgrid-master/dist/jsgrid.min.js"></script>
		<!-- Date-range picker js -->
		<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
		<script type="text/javascript" src="/files/bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>
		
		<script th:inline="javascript">
		    var gridHelper1;
		    
		    $(function() {
		        gridHelper1 = new GridHelper('jsGrid', 'contentPanel');
		        writeJsGridData();
		    });
		
		    function fn_searchForm() {
		        gridHelper1.resetListContent();
		    }
		
		    function fn_init() {
		        //$("#searchSttsCd").val('');
		        gridHelper1.resetListContent();
		    }
		
		    function writeJsGridData() {
		        $("#jsGrid").jsGrid({
		            height: "auto",
		            width: "100%",
		            autoload: true,
		            sorting: true,
		            paging: true,
		            pagerContainer: "#listPager",
		            pagerFormat: "{first} {prev} {pages} {next} {last}",
		            pagePrevText: "이전",
		            pageNextText: "다음",
		            pageFirstText: " < 처음 ㅣ",
		            pageLastText: " | 마지막 >",
		            pageSize: 10,
		            pageButtonCount: 10,
		            pageLoading: true,
		            pageIndex: 1,
		            noDataContent: "데이터가 없습니다.",
		
		            controller: {
		                loadData: function (filter) {
		                    var data = $.Deferred();
		                                            
		                    var formData = $('#searchFrm').serializeArray();
		                    var params = [
		                            {name: "pageNumber", value: filter.pageIndex},
		                            {name: "rowPerPage", value: filter.pageSize},
		                    ]
		                    
		                    if(filter.sortField != undefined){
		                        params.push({name: "orderField", value: filter.sortField});
		                        params.push({name: "orderDirection", value: filter.sortOrder});
		                    }else{
		                        params.push({name: "orderField", value: 'reg_dt'});
		                    }
		                    formData = formData.concat(params);
		                    
		                    $.ajax({
		                        type: "GET",
		                        contentType: "application/json; charset=utf-8",
		                        url: "/mng/clclnMng/clclnBlncInt/selectClclnBlncIntList.do",
		                        dataType: "json",
		                        data: formData,
		                      }).done(function(response){
		                          var da = {
		                                  data : escapeGridData(response.list)
		                                  ,itemsCount : response.totalCount
		                              };
		                        data.resolve(da);
		                      });
		                      return data.promise();
		                  },                
		            },
		            fields : [
		                { name : 'pcntstid', css : 'hide' }
		              , { title : 'No.', name : 'rowNumber', type : "number", width : "80", align : "center", sorting : false }
		              , { title : '사업분야', name : 'fldNm', type : "text", width : "140", align : "center" }
		              , { title : '공모명', name : 'pcntstNm', type : "text", width : "180", align : "center" }
		              , { title : '총지원금액', name : 'totAmt', type : "number", width : "120", align : "center", itemTemplate: function(value) {
		                    return value.toLocaleString();
		                }}
		              , { title : '반납금액', name : 'rturnAmt', type : "number", width : "120", align : "center", itemTemplate: function(value) {
		                    return value.toLocaleString();
		                }}
		              , { title : '반납완료', name : 'rturnCmptnCnt', type : "text", width : "100", align : "center" }
		              , { title : '반납미완료', name : 'rturnIncmptnCnt', type : "text", width : "100", align : "center" }
		            ],
		            
		            rowClick : function(args) {
		                if (args.event.originalEvent.target.cellIndex == 0 || isNaN(args.event.originalEvent.target.cellIndex)) return;
		                var detailUrl = detailUrl = "/mng/clclnMng/clclnBlncInt/clclnBlncIntDetailForm.html?pcntstid=" + args.item.pcntstid;
		                gridHelper1.loadContent(detailUrl);
		                gridHelper1.rowClick(args);
		            },
		            onPageChanged : function(args) {
		                selectedItems = [];
		            }
		        });
		    }
		</script>
		<script src="/js/ckeditor/ckeditor.js"></script>		
	</div>
</body>
</html>