<div class="card">
    <form id="fcltSttsForm">
        <input type="hidden" id="aplyid" name="aplyid" th:value="${eduInstVo.aplyid}"/>
        <input type="hidden" id="fcltKey" name="fcltKey" th:value="${eduInstVo.fcltKey}"/>
        <input type="hidden" id="sttsCd" name="sttsCd" th:value="${eduInstVo.sttsCd}"/>
        <div class="card-header p-b-0">
            <h3 class="sub-title"><strong>시설개요</strong></h3>
        </div>
        <div class="card-block-small p-t-0">
            <div class="row">
                <div class="col-12 col-lg-4 mb-3">
                    <div class="mb-0 form-group required">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for=""><strong>임대 여부</strong></label>
                        <div class="col-sm-12">
                            <div class="form-radio">
                                <div class="radio radio-inline">
                                    <label class="mb-0 form-label">
                                        <input type="radio" id="rentYn1" name="rentYn1" value="Y" th:checked="${eduInstVo.rentYn eq 'Y'}">
                                        <i class="helper"></i>임대
                                    </label>
                                </div>
                                <div class="radio radio-inline">
                                    <label class="mb-0 form-label">
                                        <input type="radio" id="rentYn2" name="rentYn2" value="N" th:checked="${eduInstVo.rentYn eq 'N' or eduInstVo.rentYn eq null}">
                                        <i class="helper"></i>소유
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-4 mb-3">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for=""><strong>임대기간</strong></label>
                        <div class="col-sm-12">
                            <input type="text" title="임대기간" class="form-control form-control-sm icon-date" placeholder="임대기간를 입력해 주세요" maxlength="100" id="rentPrd" name="rentPrd"
                                   th:value="${eduInstVo.rentPrd}"/>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-4 mb-3">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for=""><strong>연건평(m2)</strong></label>
                        <div class="d-flex align-items-center">
                            <div class="col">
                                <input type="number" class="form-control form-control-sm" title="연건평(m2)" placeholder="연건평을 입력해 주세요" maxlength="12" id="totar" name="totar"
                                       th:value="${eduInstVo.totar}"/>
                            </div>
                            <span class="ps-2">m<sup>2</sup></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 col-lg-4 mb-3">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for=""><strong>숙박시설 보유여부</strong></label>
                        <div class="col-sm-12">
                            <div class="form-radio">
                                <div class="radio radio-inline">
                                    <label class="mb-0 form-label">
                                        <input type="radio" id="styFcltHoldYn1" name="styFcltHoldYn" value="Y" th:checked="${eduInstVo.styFcltHoldYn eq 'Y'}">
                                        <i class="helper"></i>보유
                                    </label>
                                </div>
                                <div class="radio radio-inline">
                                    <label class="mb-0 form-label">
                                        <input type="radio" id="styFcltHoldYn2" name="styFcltHoldYn" value="N"
                                               th:checked="${eduInstVo.styFcltHoldYn eq 'N' or eduInstVo.styFcltHoldYn eq null}">
                                        <i class="helper"></i>미보유
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-4 mb-3">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for=""><strong>면적(m2)</strong></label>
                        <div class="d-flex align-items-center">
                            <div class="col">
                                <input type="number" class="form-control form-control-sm" title="면적(m2)" placeholder="면적을 입력해 주세요" maxlength="12" id="styFcltAr" name="styFcltAr"
                                       th:value="${eduInstVo.styFcltAr}"/>
                            </div>
                            <span class="ps-2">m<sup>2</sup></span>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-4 mb-3">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for=""><strong>수용인원</strong></label>
                        <div class="d-flex align-items-center">
                            <div class="col">
                                <input type="number" class="form-control form-control-sm" title="수용인원" placeholder="수용인원을 입력해 주세요" maxlength="10" id="styFcltNope"
                                       name="styFcltNope" th:value="${eduInstVo.styFcltNope}"/>
                            </div>
                            <span class="ps-2">명</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-header p-t-0 p-b-0">
            <h3 class="sub-title"><strong>강의실</strong></h3>
        </div>
        <div class="card-block-small p-t-0">
            <div class="mb-3 table-border-style">
                <div class="table-responsive">
                    <table class="table table-framed">
                        <thead>
                        <tr>
                            <th class="text-center v-middle" style="width:60px;">No</th>
                            <th class="text-center v-middle">강의실명</th>
                            <th class="text-center v-middle">면적</th>
                            <th class="text-center v-middle">수용인원</th>
                            <th class="text-center v-middle" style="width:120px">설정</th>
                        </tr>
                        </thead>
                        <tbody id="lctrum1Tbody">
                        <tr th:id=' lctrum1Tr + ${j.count} ' th:if='${lctrum1.seCd=="251101" && #lists.size(lctrumList1) > 0}' th:each='lctrum1, j: ${lctrumList1}'>
                            <td class="text-center">
                                <th:block th:text="${j.count}"/>
                            </td>
                            <td><input type="text" class="form-control form-control-sm" maxlength="100" title="강의실명" id="nm" name="nm" th:value="${lctrum1.nm}"></td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="col">
                                        <input type="number" class="form-control form-control-sm" maxlength="12" title="면적(m2)" id="ar" name="ar" th:value="${lctrum1.ar}">
                                    </div>
                                    <span class="ps-2">m<sup>2</sup></span>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="col">
                                        <input type="number" class="form-control form-control-sm" maxlength="10" title="수용인원" id="nope" name="nope" th:value="${lctrum1.nope}">
                                        <input type="hidden" title="구분코드" id="seCd" name="seCd" th:value="${lctrum1.seCd}">
                                    </div>
                                    <span class="ps-2">명</span>
                                </div>
                            </td>
                            <td>
                                <div class="btn-group-sm">
                                    <button onclick="lctrum1AddRow(this);" type="button" class="btn btn-primary m-r-5" th:if="${j.last}">추가</button>
                                    <button onclick="lctrum1RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button>
                                </div>
                            </td>
                        </tr>
                        <tr th:unless="${#lists.size(lctrumList1) > 0}">
                            <td class="text-center">1</td>
                            <td><input type="text" class="form-control form-control-sm" maxlength="100" title="강의실명" id="nm" name="nm"></td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="col">
                                        <input type="number" class="form-control form-control-sm" maxlength="12" title="면적(m2)" id="ar" name="ar">
                                    </div>
                                    <span class="ps-2">m<sup>2</sup></span>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="col">
                                        <input type="number" class="form-control form-control-sm" maxlength="10" title="수용인원" id="nope" name="nope">
                                        <input type="hidden" title="구분코드" id="seCd" name="seCd" value="251101">
                                    </div>
                                    <span class="ps-2">명</span>
                                </div>
                            </td>
                            <td>
                                <div class="btn-group-sm">
                                    <button onclick="lctrum1AddRow(this);" type="button" class="btn btn-primary m-r-5">추가</button>
                                    <button onclick="lctrum1RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="card-header p-t-0 p-b-0">
            <h3 class="sub-title"><strong>실습실</strong></h3>
        </div>
        <div class="card-block-small p-t-0">
            <div class="mb-3 table-border-style">
                <div class="table-responsive">
                    <table class="table table-framed">
                        <thead>
                        <tr>
                            <th class="text-center v-middle" style="width:60px;">No</th>
                            <th class="text-center v-middle">실습실명</th>
                            <th class="text-center v-middle">면적</th>
                            <th class="text-center v-middle">수용인원</th>
                            <th class="text-center v-middle" style="width:120px">설정</th>
                        </tr>
                        </thead>
                        <tbody id="lctrum2Tbody">
                        <tr th:id=' lctrum2Tr + ${k.count} ' th:if='${lctrum2.seCd=="251102"}' th:each='lctrum2, k: ${lctrumList2}'>
                            <td class="text-center">
                                <th:block th:text="${k.count}"/>
                            </td>
                            <td>
                                <input type="text" class="form-control form-control-sm" maxlength="100" title="강의실명" id="nm" name="nm" th:value="${lctrum2.nm}">
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="col">
                                        <input type="text" class="form-control form-control-sm" maxlength="12" title="면적(m2)" id="ar" name="ar" th:value="${lctrum2.ar}">
                                    </div>
                                    <span class="ps-2">m<sup>2</sup></span>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="col">
                                        <input type="text" class="form-control form-control-sm" maxlength="10" title="수용인원" id="nope" name="nope" th:value="${lctrum2.nope}">
                                        <input type="hidden" title="구분코드" id="seCd" name="seCd" th:value="${lctrum2.seCd}">
                                    </div>
                                    <span class="ps-2">명</span>
                                </div>
                            </td>
                            <td>
                                <div class="btn-group-sm">
                                    <button onclick="lctrum2AddRow(this);" type="button" class="btn btn-primary m-r-5" th:if="${k.last}">추가</button>
                                    <button onclick="lctrum2RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button>
                                </div>
                            </td>
                        </tr>
                        <tr th:unless="${#lists.size(lctrumList2) > 0}">
                            <td class="text-center">1</td>
                            <td>
                                <input type="text" class="form-control form-control-sm" maxlength="100" title="강의실명" id="nm" name="nm">
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="col">
                                        <input type="text" class="form-control form-control-sm" maxlength="12" title="면적(m2)" id="ar" name="ar">
                                    </div>
                                    <span class="ps-2">m<sup>2</sup></span>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="col">
                                        <input type="text" class="form-control form-control-sm" maxlength="10" title="수용인원" id="nope" name="nope">
                                        <input type="hidden" title="구분코드" id="seCd" name="seCd" value="251102">
                                    </div>
                                    <span class="ps-2">명</span>
                                </div>
                            </td>
                            <td>
                                <div class="btn-group-sm">
                                    <button onclick="lctrum2AddRow(this);" type="button" class="btn btn-primary m-r-5">추가</button>
                                    <button onclick="lctrum2RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="card-header p-t-0 p-b-0">
            <h3 class="sub-title"><strong>교육설비 등</strong></h3>
        </div>
        <div class="card-block-small p-t-0">
            <div class="mb-3 table-border-style">
                <div class="table-responsive">
                    <table class="table table-framed">
                        <thead>
                        <tr>
                            <th class="text-center v-middle" style="width:60px;">No</th>
                            <th class="text-center v-middle">설비명</th>
                            <th class="text-center v-middle">수량</th>
                            <th class="text-center v-middle">활용방안</th>
                            <th class="text-center v-middle">비고</th>
                            <th class="text-center v-middle" style="width:120px">설정</th>
                        </tr>
                        </thead>
                        <tbody id="eqp1Tbody">
                        <tr th:id=' eqp1Tr + ${n.count} ' th:if='${eqpList != null}' th:each='eqp, n: ${eqpList}'>
                            <td class="text-center">
                                <th:block th:text="${n.count}"/>
                            </td>
                            <td>
                                <input type="text" class="form-control form-control-sm" maxlength="100" title="설비명" id="nm" name="nm" th:value="${eqp.nm}">
                            </td>
                            <td>
                                <input type="number" class="form-control form-control-sm" maxlength="10" title="수량" id="qnty" name="qnty" th:value="${eqp.qnty}">
                            </td>
                            <td>
                                <input type="text" class="form-control form-control-sm" maxlength="100" title="활용방안" id="prcuseMthd" name="prcuseMthd" th:value="${eqp.prcuseMthd}">
                            </td>
                            <td>
                                <input type="text" class="form-control form-control-sm" maxlength="100" title="비고" id="rmrk" name="rmrk" th:value="${eqp.rmrk}">
                            </td>
                            <td>
                                <div class="btn-group-sm">
                                    <button onclick="eqp1AddRow(this);" type="button" class="btn btn-primary m-r-5" th:if="${n.last}">추가</button>
                                    <button onclick="eqp1RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button>
                                </div>
                            </td>
                        </tr>
                        <tr th:unless="${#lists.size(eqpList) > 0}">
                            <td class="text-center">1</td>
                            <td>
                                <input type="text" class="form-control form-control-sm" maxlength="100" title="설비명" id="nm" name="nm">
                            </td>
                            <td>
                                <input type="number" class="form-control form-control-sm" maxlength="10" title="수량" id="qnty" name="qnty">
                            </td>
                            <td>
                                <input type="text" class="form-control form-control-sm" maxlength="100" title="활용방안" id="prcuseMthd" name="prcuseMthd">
                            </td>
                            <td>
                                <input type="text" class="form-control form-control-sm" maxlength="100" title="비고" id="rmrk" name="rmrk">
                            </td>
                            <td>
                                <div class="btn-group-sm">
                                    <button onclick="eqp1AddRow(this);" type="button" class="btn btn-primary m-r-5">추가</button>
                                    <button onclick="eqp1RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="card-block-small">
            <button type="button" onclick="gridHelper1.toggleContent();" class="btn btn-disabled">취소</button>
            <button type="button" onclick="fn_save()" class="btn btn-primary">저장</button>
        </div>
    </form>
</div>

<script th:inline="javascript">
    var insertUrl = "/mng/eduInst/insertFcltStts.do";
    var updateUrl = "/mng/eduInst/updateFcltStts.do";

    $("input[name='rentPrd']").daterangepicker({
        autoUpdateInput: false,
        locale: {
            format: "YYYY-MM-DD",
        },
    });

    $("input[name^='rentPrd']").on('apply.daterangepicker', function (ev, picker) {
        $(this).val(picker.startDate.format('YYYY-MM-DD') + ' ~ ' + picker.endDate.format('YYYY-MM-DD'));
    });

    function lctrum1AddRow(obj) {
        var html = '<div class="btn-group-sm"><button onclick="lctrum1AddRow(this);" type="button" class="btn btn-primary m-r-5"">추가</button>';
        html += '<button onclick="lctrum1RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button></div>';
        var clickedRow = $(obj).parent().parent().parent();
        $(obj).remove();
        var newrow = clickedRow.clone();
        var ordr = Number(clickedRow.find("td:first").text()) + 1;
        newrow.find("td:first").html(ordr);
        newRow.find('input').not("#seCd").val('');
        //newrow.find("td > input").val("");
        //newrow.find("td > textarea").val("");
        newrow.find("td:last").html(html);
        newrow.insertAfter(clickedRow.parent().parent().find("tr:last"));
    }

    function lctrum1DelRow(obj) {
        var html = '<div class="btn-group-sm"><button onclick="lctrum1AddRow(this);" type="button" class="btn btn-primary m-r-5">추가</button>';
        html += '<button onclick="lctrum1RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button></div>';

        var tableObj = $(obj).parent().parent().parent().parent();
        $(obj).parent().parent().parent().remove();
        tableObj.find("tr:last").find("td:last").html(html);
        tableObj.find("tr").each(function (i) {
            $(this).find("td:first").text(i + 1);
        });
    }

    function lctrum2AddRow(obj) {
        var html = '<div class="btn-group-sm"><button onclick="lctrum2AddRow(this);" type="button" class="btn btn-primary m-r-5"">추가</button>';
        html += '<button onclick="lctrum2RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button></div>';
        var clickedRow = $(obj).parent().parent().parent();
        $(obj).remove();
        var newrow = clickedRow.clone();
        var ordr = Number(clickedRow.find("td:first").text()) + 1;
        newrow.find("td:first").html(ordr);
        newRow.find('input').not("#seCd").val('');
        //newrow.find("td > input").val("");
        //newrow.find("td > textarea").val("");
        newrow.find("td:last").html(html);
        newrow.insertAfter(clickedRow.parent().parent().find("tr:last"));
    }

    function lctrum2DelRow(obj) {
        var html = '<div class="btn-group-sm"><button onclick="lctrum2AddRow(this);" type="button" class="btn btn-primary m-r-5">추가</button>';
        html += '<button onclick="lctrum2RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button></div>';

        var tableObj = $(obj).parent().parent().parent().parent();
        $(obj).parent().parent().parent().remove();
        tableObj.find("tr:last").find("td:last").html(html);
        tableObj.find("tr").each(function (i) {
            $(this).find("td:first").text(i + 1);
        });
    }

    function eqp1AddRow(obj) {
        var html = '<div class="btn-group-sm"><button onclick="eqp1AddRow(this);" type="button" class="btn btn-primary m-r-5"">추가</button>';
        html += '<button onclick="eqp1RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button></div>';
        var clickedRow = $(obj).parent().parent().parent();
        $(obj).remove();
        var newrow = clickedRow.clone();
        var ordr = Number(clickedRow.find("td:first").text()) + 1;
        newrow.find("td:first").html(ordr);
        newRow.find('input').val('');
        //newrow.find("td > input").val("");
        //newrow.find("td > textarea").val("");
        newrow.find("td:last").html(html);
        newrow.insertAfter(clickedRow.parent().parent().find("tr:last"));
    }

    function eqp1DelRow() {
        var html = '<div class="btn-group-sm"><button onclick="eqp1AddRow(this);" type="button" class="btn btn-primary m-r-5">추가</button>';
        html += '<button onclick="eqp1RemoveRow(this);" type="button" class="btn btn-inverse">삭제</button></div>';

        var tableObj = $(obj).parent().parent().parent().parent();
        $(obj).parent().parent().parent().remove();
        tableObj.find("tr:last").find("td:last").html(html);
        tableObj.find("tr").each(function (i) {
            $(this).find("td:first").text(i + 1);
        });
    }

    function fn_save() {

        if (!($("#fcltSttsForm").valid())) return;

        if (!confirm("저장하시겠습니까?")) return;

        var param = {};
        var lctrumList = [];
        var eqpList = [];

        $('#lctrum1Tbody tr').each(function (index, value) {
            var nm = $(this).find('input[name="nm"]').val();
            var ar = $(this).find('input[name="ar"]').val();
            var nope = $(this).find('input[name="nope"]').val();
            var seCd = $(this).find('input[name="seCd"]').val();

            lctrumList.push({
                nm: nm
                , ar: ar == '' ? 0 : ar
                , nope: nope == '' ? 0 : nope
                , seCd: seCd
            });
        });

        $('#lctrum2Tbody tr').each(function (index, value) {
            var nm = $(this).find('input[name="nm"]').val();
            var ar = $(this).find('input[name="ar"]').val();
            var nope = $(this).find('input[name="nope"]').val();
            var seCd = $(this).find('input[name="seCd"]').val();
            lctrumList.push({
                nm: nm
                , ar: ar == '' ? 0 : ar
                , nope: nope == '' ? 0 : nope
                , seCd: seCd
            });
        });

        $('#eqp1Tbody tr').each(function (index, value) {
            var nm = $(this).find('input[name="nm"]').val();
            var qnty = $(this).find('input[name="qnty"]').val();
            var prcuseMthd = $(this).find('input[name="prcuseMthd"]').val();
            var rmrk = $(this).find('input[name="rmrk"]').val();

            eqpList.push({
                nm: nm
                , qnty: qnty
                , prcuseMthd: prcuseMthd
                , rmrk: rmrk
            });
        });

        param = {
            aplyid: $("#aplyid").val()
            , rentYn: $("#rentYn1").attr("checked") ? 'Y' : 'N'  /** 임대 여부 */
            , rentPrd: $("#rentPrd").val()          /** 임대 기간 */
            , totar: $("#totar").val()            /** 총면적 */
            , styFcltHoldYn: $("#styFcltHoldYn1").attr("checked") ? 'Y' : 'N'    /** 숙박 시설 보유 여부 */
            , styFcltAr: $("#styFcltAr").val()        /** 숙박 시설 면적 */
            , styFcltNope: $("#styFcltNope").val()      /** 숙박 시설 인원수 */
            , sttsCd: $("#sttsCd").val() == '248101' ? '248102' : $("#sttsCd").val()
            , lctrumList: lctrumList
            , eqpList: eqpList
        };

        var key = $("#fcltKey").val()
        if (key != null && key != '' && key != 0) {
            url = updateUrl;
        } else {
            url = insertUrl;
        }
        if (displayWorkProgress()) {
            $.ajax({
                url: url,
                type: 'POST',
                cache: false,
                dataType: 'json',
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify(param),
                success: function (data) {
                    if (data.result == "success") {
                        alert(data.msg);
                        gridHelper1.resetListContent();
                    } else {
                        alert(data.msg);
                    }
                    closeWorkProgress();
                }
            });
        }
    };
    $(function () {

//         	var validator= $("#fclstForm").validate({
//                 rules: {
//                      ctprvnCd       : { required: true }
//                     ,instEml        : { isBlank : true, maxlength: 50 }
//                     ,aplcntNm       : { isBlank : true ,maxlength: 50 }
//                     ,aplcntMoblphon : { isBlank : true}
//                     ,aplcntEml      : { isBlank : true, maxlength: 50 }
//                 },
//                 messages: {
//                     ctprvnCd        : { required: "시도를 선택해 주십시오."}
//                     ,instEml        : { isBlank : "입력값에 공백이 있습니다.", maxlength: "이메일은 50자 이하여야 합니다." }
//                     ,aplcntNm       : { isBlank : "입력값에 공백이 있습니다.", maxlength: "신청자명은 20자 이하여야 합니다." }
//                     ,aplcntMoblphon : { isBlank : "입력값에 공백이 있습니다." }
//                     ,aplcntEml      : { isBlank : "입력값에 공백이 있습니다.", maxlength: "이메일은 50자 이하여야 합니다." }
//                 }
//             })

    });
</script>
</div>
</body>
</html>