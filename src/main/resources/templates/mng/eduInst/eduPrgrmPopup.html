    <form id="eduPrgrmPopFrom" >
        <input type="hidden" id="aplyid" name="aplyid" th:value="${eduInstVo.aplyid}" />
        <input type="hidden" id="idx" name="idx" th:value="${eduInstVo.idx}" />
	    <div class="modal-dialog modal-lg" role="document">
	        <div class="modal-content type_2">
	            <div class="modal-header">
	                <h4 class="modal-title">프로그램 검색 </h4>
	                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
	                    <span aria-hidden="true"></span>
	                </button>
	            </div>
	            <div class="modal-body">
	                <div class="card">
	                    <div class="card-block-small">
	                        <div class="row">
	                            <div class="col-12 col-lg-4 mb-3">
	                                <div class="mb-0 form-group">
	                                    <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for=""><strong>프로그램명</strong></label>
	                                    <div class="col-12">
	                                        <input type="text" class="form-control form-control-sm" title="프로그램명" placeholder="프로그램명을 입력해 주세요." id="searchPrgrmNm" name="searchPrgrmNm" onkeydown="if(event.keyCode == 13){searchPrgrmList(); return false;};">
	                                    </div>
	                                </div>
	                            </div>
	                            <div class="col-12 col-lg-4 mb-3">
	                                <div class="mb-0 form-group">
	                                    <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for=""><strong>지정번호</strong></label>
	                                    <div class="col-12">
	                                        <input type="text" class="form-control form-control-sm" title="지정번호" placeholder="지정번호를 입력해 주세요." id="searchDsgnNo" name="searchDsgnNo" onkeydown="if(event.keyCode == 13){searchPrgrmList(); return false;};">
	                                    </div>
	                                </div>
	                            </div>
	                        </div>
	                        <div class="mt-1 p-t-20 text-center border-top">
	                            <button type="button"  class="btn btn-disabled m-r-5"  onclick="reset();">초기화</button>
	                            <button type="submit" class="btn btn-primary" onclick="searchPrgrmList(); return false;">검색</button>
	                            
	                        </div>
	                    </div>
	                </div>
	                <div class="card m-b-10">
	                    <div class="card-block-small">
	                        <div class="row">
	                            <div class="col-12">
	                                <table id="prgrmGrid" class="table-responsive"></table>
	                                <div id="userListPager" class="text-center"></div>
	                            </div>
	                        </div>
	                    </div>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-primary waves-effect waves-light" onclick="selectPrgrmBtn()">등록</button>
	            </div>
	        </div>
	    </div>
    </form>

    <script th:inline="javascript">
		var selectedItem;

	    $(function(){
	        writePrgrmGridData();
	    });
	    
	    searchPrgrmList = () =>{
	        $("#prgrmGrid").jsGrid("reset");
	    }
	    
	    function writePrgrmGridData(){
	        $("#prgrmGrid").jsGrid({
	            height: "auto",
	            width: "100%",
	            autoload: true,
	            sorting: true,
	            paging: true,
	            pagerContainer: "#userListPager",
	            pagerFormat: "{first} {prev} {pages} {next} {last}",
	            pagePrevText: "이전",
	            pageNextText: "다음",
	            pageFirstText: "< 처음ㅣ",
	            pageLastText: "ㅣ 마지막 >",
	            pageSize: 10,
	            pageButtonCount: 10,
	            pageLoading: true,
	            pageIndex: 1,
	            noDataContent: "데이터가 없습니다.",
	            controller: {
	                loadData: function (filter) {
	                    var data = $.Deferred();
	                    var formData = $('#eduPrgrmPopFrom').serializeArray();
	                    var params = [
	                            {name: "pageNumber", value: filter.pageIndex},
	                            {name: "rowPerPage", value: filter.pageSize},
	                    ]
	
	                    if(filter.sortField != undefined){
	                        params.push({name: "orderField", value: filter.sortField});
	                        params.push({name: "orderDirection", value: filter.sortOrder});
	                    }else{
	                        params.push({name: "orderField", value: 'RFRNC_PRGRMID'});
	                    }
	
	                    formData = formData.concat(params);
	
	                    $.ajax({
	                      type: "GET",
	                      contentType: "application/json; charset=utf-8",
	                      url: "/mng/eduInst/selectDsgnPrgrmList.do",
	                      dataType: "json",
	                      data: formData
	                    }).done(function(response){
	                        var da = {
	                                data : escapeGridData(response.list)
	                                ,itemsCount : response.totalCount
	                            };
	                      data.resolve(da);
	                    });
	                    return data.promise();
	                },
	            },
	            fields: [
	                {
	                    headerTemplate: function() {},
	                    itemTemplate : function(_, item) {
	                        return item.aplyCnt > 0 ? $("<input>").attr("type", "checkbox").attr("disabled", true) 
	                                : $("<input>").attr("type", "checkbox").attr("class", "singleCheckbox").attr("id","userid-"+item.userid).on("change" , function () {
	                                    $(this).is(":checked") ? selectItem(item) : unselectItem()
	                                });
	                    },
	                    align: "center",
	                    width: "30",
	                    sorting: false
	                }
	                , { title: 'No.'    ,name: 'rowNumber', type: "number", width : "80",  align:"center",  sorting :false }
	                , { title: '프로그램명'   ,name: 'rfrncPrgrmNm'       , type: "text",   width : "150",  align:"center" }
	                , { title: '지정번호' ,name: 'dsgnNo' , type: "text",   width : "120",  align:"center" }
	            ],
	            rowClick: function(args) {
	                if(args.event.originalEvent.target.cellIndex == 0 || isNaN(args.event.originalEvent.target.cellIndex)) return;
	            },
	        });
	        var selectItem = function(item) {
	            selectedItem = item;
	            $(".singleCheckbox:checked").prop("checked",false);
	            $("#userid-"+item.userid).prop("checked",true);
	        };
	
	        var unselectItem = function() {
	            selectedItem = "";
	            $('#selectAllCheckbox').attr('checked', false);
	        };
	    }
	
	    function selectPrgrmBtn(){
	        if (selectedItem == "" || selectedItem == null) {
	            alert("프로그램을 선택하십시요.");
	            return;
	        }
	        var idx= $("#idx").val();
	        $("#rfrncPrgrmid"+idx).val(selectedItem.rfrncPrgrmid);
	        $("#prgrmNm"+idx).val(selectedItem.rfrncPrgrmNm);
	        
	        selectedItem = "";
	        eduPrgrmModal.hide();
	        closeWorkProgress();
	    }
	    
	    function reset() {
	        $("#popupFilterKeywordSelect").val("opt1");
	        $("#popupFilterKeywordInput").val("");
	    }	    
    </script>
