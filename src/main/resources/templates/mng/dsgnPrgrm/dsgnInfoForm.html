<form id="dsgnInfoFrm">
	<div class="tab-pane active" id="assignInfo" role="tabpanel">
		<div class="card-header p-t-0 p-b-0">
		    <h3 class="sub-title"><strong>신청 정보</strong></h3>
		</div>
		<div class="card-block-small p-t-0">
		    <div class="mb-2 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoProgramName"><strong>프로그램명</strong></label>
		                <div class="col-sm-12">
		                    <input type="text" class="form-control form-control-sm" name="prgrmNm" id="prgrmNm" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.prgrmNm}" readonly/>
		                </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoAgencyName"><strong>기관명</strong></label>
		                <div class="col-sm-12">
		                    <input type="text" class="form-control form-control-sm" name="applyInfoAgencyName" id="applyInfoAgencyName" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.instNm}"  readonly/>
		                </div>
		            </div>
		        </div>
		    </div>
		    <div class="mb-2 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1">
		                    <strong>기관유형</strong></div>
		                <div class="col-12">
		                    <span kattr:select_code="instTypeCd" th:attr="grpCd=108,selectedCd=${dsgnAplyInfo.instTypeCd}" firstOptTxt="- 전체 -" addClass="form-select form-select-sm form-control-sm" isAdmin="true" isDisable/>
		                </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoRepresentativeName"><strong>대표자명</strong></label>
		                <div class="col-sm-12">
		                    <input type="text" class="form-control form-control-sm" name="applyInfoRepresentativeName" id="applyInfoRepresentativeName" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.prgrmNm}"  readonly/>
		                </div>
		            </div>
		        </div>
		    </div>
		    <div class="mb-2 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoApplicant"><strong>신청자</strong></label>
		                <div class="col-12 row">
		                    <div class="col-8">
		                        <input type="text" class="form-control form-control-sm" name="applyInfoApplicant" id="applyInfoApplicant" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.aplcntNm}" readonly/>
		                    </div>
		                    <div class="col-4 btn-group-sm">
		                        <button type="button" class="btn btn-inverse" data-bs-toggle="modal" data-bs-target="#memberSearchPopup">
		                            담당자 변경
		                        </button>
		                    </div>
		                </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoManagerPhoneNum"><strong>담당자연락처</strong></label>
		                <div class="col-sm-12">
		                    <input type="text" class="form-control form-control-sm" name="applyInfoManagerPhoneNum" id="applyInfoManagerPhoneNum" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.aplcntMoblphon}" readonly/>
		                </div>
		            </div>
		        </div>
		    </div>
		    <div class="mb-2 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoManagerEmail"><strong>담당자 이메일</strong></label>
		                <div class="col-12">
		                    <input type="text" class="form-control form-control-sm" name="applyInfoManagerEmail" id="applyInfoManagerEmail" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.aplcntEml}" readonly/>
		                </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="applyInfoBusinessNum"><strong>사업자등록번호</strong></label>
		                <div class="col-12">
		                    <input type="text" class="form-control form-control-sm" name="brno" id="brno" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.brno}" readonly/>
		                </div>
		            </div>
		        </div>
		    </div>
		    <div class="mb-2 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoAgencyEmail"><strong>기관 이메일</strong></label>
		                <div class="col-12">
		                    <input type="text" class="form-control form-control-sm" name="applyInfoAgencyEmail" id="applyInfoAgencyEmail" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.instEml}" readonly/>
		                </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoAgencyPhoneNum"><strong>기관 연락처</strong></label>
		                <div class="col-12">
		                    <input type="text" class="form-control form-control-sm" name="applyInfoAgencyPhoneNum" id="applyInfoAgencyPhoneNum" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.instCntct}" readonly/>
		                </div>
		            </div>
		        </div>
		    </div>
		    <div class="mb-2 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1">
		                    <strong>지역</strong></div>
		                <div class="col-12">
		                    <span kattr:select_code="rgnCd" th:attr="grpCd=125,selectedCd=${dsgnAplyInfo.instRgnCd}" firstOptTxt="- 전체 -" addClass="form-select form-select-sm form-control-sm" isAdmin="true" isDisable>
		                </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoAgencyHomePage"><strong>기관 홈페이지</strong></label>
		                <div class="col-12">
		                    <input type="text" class="form-control form-control-sm" name="applyInfoAgencyHomePage" id="applyInfoAgencyHomePage" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.instHmpg}" readonly/>
		                </div>
		            </div>
		        </div>
		    </div>
		    <div class="mb-2 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoAgencyAddress"><strong>기관주소</strong></label>
		                <div class="col-sm-12">
		                    <input type="text" class="form-control form-control-sm" name="agencyAddress" id="agencyAddress" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.instAddr}" readonly/>
		                </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoAgencyDetailAddress"><strong>상세주소</strong></label>
		                <div class="col-sm-12">
		                    <input type="text" class="form-control form-control-sm" name="agencyDetailAddress" id="agencyDetailAddress" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.instDtladdr}" readonly/>
		                </div>
		            </div>
		        </div>
		    </div>
		    <div class="mb-2 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>증빙서류</strong></div>
                        <div class="col-sm-12">

                            <input type="file" id="evdncDcmntFile" name="evdncDcmntFile" class="form-control form-control-sm"/>

                            <div class="row">
                                <th:block th:if="${fileList != null}">


                                <div class="row">
                                <th:block th:if="${fileList != null}">
                                    <div th:each="item : ${fileList}" th:id="${item.fileid}" class="col-auto">
                                        <th:block th:if="${item.orginlFileNm != null}">
                                            <span th:fileid='${item.fileid}' th:fileIdntfcKey="${item.fileIdntfcKey}" th:onclick="downloadFileByFileid(this.getAttribute('fileid'),this.getAttribute('fileIdntfcKey'))" href="javascript:void(0)" class='label label-inverse'>
                                                <th:block th:text="${item.orginlFileNm}" /> <a th:name="${item.fileid}" th:attr="data-idntfc-key=${item.fileIdntfcKey}" th:onclick="fn_deleteFileList(this.name, this.dataset.idntfcKey)" class='text-white'><th:block th:text="X"</th:block></a>
                                            </span>
                                        </th:block>
                                    </div>
                                 </th:block>
                                 </div>
                           </div>

                        </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <div class="form-label col-sm-12 col-form-label p-t-0 pb-1">
		                    <strong>지정상태</strong></div>
		                <div class="col-12">
		                    <span kattr:select_code="sttsCd" th:attr="grpCd=111,selectedCd=${dsgnAplyInfo.sttsCd}" firstOptTxt="- 전체 -" addClass="form-select form-select-sm form-control-sm" isAdmin="true">
		                </div>
		            </div>
		        </div>
		    </div>
		    <div class="mb-0 row">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoDegree"><strong>차수 / 지정번호</strong></label>
		                <div class="col-sm-12">
		                    <input type="text" class="form-control form-control-sm" name="assignInfoDegree" id="assignInfoDegree" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.cyclNo}" readonly/>
		                </div>
		            </div>
		        </div>
		        <div class="col-12 col-lg-6">
		            <div class="mb-0 form-group">
		                <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="assignInfoAssignAvailableDate"><strong>지정유효기간</strong></label>
		                <div class="col-sm-12">
		                    <input type="text" class="form-control form-control-sm" name="assignInfoAssignAvailableDate" id="assignInfoAssignAvailableDate" placeholder="Text Input Validation" th:value="${dsgnAplyInfo.dsgnPrd}" readonly/>
		                </div>
		            </div>
		        </div>
		    </div>
		</div>
		<div class="card-header p-t-0 p-b-0">
		    <div class="mb-2 row">
		        <div class="col-12 btn-group-sm">
		            <button type="button" class="col-auto btn btn-inverse m-r-5">목록</button>
		            <button type="button" class="col-auto btn btn-disabled m-r-5" data-bs-toggle="modal" data-bs-target="#reAssignPopup">재지정</button>
		            <button type="button" class="col-auto btn btn-disabled m-r-5" data-bs-toggle="modal" data-bs-target="#assignCancelPopup">지정취소</button>
		            <button type="button" class="col-auto btn btn-primary m-r-5">인쇄</button>
		            <button type="button" class="col-auto btn btn-primary m-r-5" data-bs-toggle="modal" data-bs-target="#assignProgramIntroPopup">지정프로그램 개요보기</button>
		            <button type="button" class="col-auto btn btn-primary">지정프로그램 상세보기</button>
		        </div>
		    </div>
		    <div class="sub-title row m-l-0 m-r-0 m-b-0 align-items-center">
		        <div class="col-12 col-lg-6 mb-2 mb-lg-0 p-l-0">
		            <strong>지정 내역</strong>
		        </div>
		        <div class="col-12 col-lg-6 text-right p-r-0 btn-group-sm">
		            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#assignUpdatePopup">지정정보 변경
		            </button>
		        </div>
		    </div>
		</div>
		<div class="card-block-small p-t-0">
		    <div class="col-12 table-border-style">
		        <div class="table-responsive">
                    <table id="dsgnDsctnGrid" class="table-responsive"></table>
                    <!--
		            <table class="table">
		                <thead>
		                <tr>
		                    <th class="text-center v-middle" style="width: 60px;">No.</th>
		                    <th class="text-center v-middle" style="width: 120px;">지정상태
		                    </th>
		                    <th class="text-center v-middle" style="width: 60px;">차수</th>
		                    <th class="text-center v-middle" style="width: 100px;">지정번호</th>
		                    <th class="text-center v-middle" style="width: 100px;">지정획득일</th>
		                    <th class="text-center v-middle" style="width: 100px;">지정취소일</th>
		                    <th class="text-center v-middle">지정유효기간</th>
		                    <th class="text-center v-middle" style="width: 120px;">등록일</th>
		                    <th class="text-center v-middle">등록자</th>
		                </tr>
		                </thead>
		                <tbody>
		                <tr>
		                    <td class="text-center v-middle">3</td>
		                    <td class="text-center v-middle">지정승인</td>
		                    <td class="text-center v-middle">5</td>
		                    <td class="text-center v-middle">2023-005</td>
		                    <td class="text-center v-middle">2023-05-07</td>
		                    <td class="text-center v-middle">-</td>
		                    <td class="text-center v-middle">2023-05-07 ~ 2023-05-07</td>
		                    <td class="text-center v-middle">2023-05-07 10:00</td>
		                    <td class="text-center v-middle">김운영(kimadm)</td>
		                </tr>
		                <tr>
		                    <td class="text-center v-middle">2</td>
		                    <td class="text-center v-middle">지정승인</td>
		                    <td class="text-center v-middle">5</td>
		                    <td class="text-center v-middle">2023-005</td>
		                    <td class="text-center v-middle">2023-05-07</td>
		                    <td class="text-center v-middle">-</td>
		                    <td class="text-center v-middle">2023-05-07 ~ 2023-05-07</td>
		                    <td class="text-center v-middle">2023-05-07 10:00</td>
		                    <td class="text-center v-middle">김운영(kimadm)</td>
		                </tr>
		                <tr>
		                    <td class="text-center v-middle">1</td>
		                    <td class="text-center v-middle">지정승인</td>
		                    <td class="text-center v-middle">5</td>
		                    <td class="text-center v-middle">2023-005</td>
		                    <td class="text-center v-middle">2023-05-07</td>
		                    <td class="text-center v-middle">-</td>
		                    <td class="text-center v-middle">2023-05-07 ~ 2023-05-07</td>
		                    <td class="text-center v-middle">2023-05-07 10:00</td>
		                    <td class="text-center v-middle">김운영(kimadm)</td>
		                </tr>
		                </tbody>
		            </table>
		             -->
		        </div>
		    </div>
		</div>
	</div>
</form>

<script th:inline="javascript">

//보완요청 그리드
function writeSplmntDmndGridData(){

    $("#dsgnDsctnGrid").jsGrid({
//         height: "auto",
        height: "220px",
        width: "100%",
        autoload: true,
        sorting: true,
        paging: false,
        pagerContainer: "#splmntDmndListPager",
        pagerFormat: "{first} {prev} {pages} {next} {last}",
        pagePrevText: "이전",
        pageNextText: "다음",
        pageFirstText: " < 처음 ㅣ",
        pageLastText: " | 마지막 >",
//         pageSize: 5,
        pageButtonCount: 10,
        pageLoading: true,
        pageIndex: 1,
        noDataContent: "데이터가 없습니다.",

        controller: {
            loadData: function (filter) {
                var data = $.Deferred();

                var formData = $('#searchFrm').serializeArray();
                var params = [
                        {name: "pageNumber", value: filter.pageIndex},
                        {name: "rowPerPage", value: filter.pageSize},
                        {name: "prgrmid", value: prgrmid},

                ]

                if(filter.sortField != undefined){
                    params.push({name: "orderField", value: filter.sortField});
                    params.push({name: "orderDirection", value: filter.sortOrder});
                }else{
                    params.push({name: "orderField", value: 'reg_dt'});
                }

                formData = formData.concat(params);

                $.ajax({
                  type: "GET",
                  contentType: "application/json; charset=utf-8",
                  url: "/mng/dsgnPrgrm/selectDsgnDsctnList.do",
                  dataType: "json",
                  data: formData
                }).done(function(response){

console.log("@@@@@1");
//
console.log("@@@@@2");
                    var da = {
                            data : escapeGridData(response.dsgnDsctnList)
                            ,itemsCount : response.totalCount
                        };
                  data.resolve(da);
                });
                return data.promise();
            },
        },
        fields: [
             { name: 'prgrmid', css:'hide'}
            ,{ title: 'No.'         ,name: 'rowNumber',    type: "number", width : "80", align:"center",  sorting :false }
            ,{ title: '지정상태'    ,name: 'sttsCdNm',     type: "text", width: "100", align:"center"}
            ,{ title: '차수'        ,name: 'dsgnCycl',     type: "text", width: "100", align:"center"}
            ,{ title: '지정번호'    ,name: 'dsgnNo',       type: "text", width: "100", align:"center" }
            ,{ title: '지정획득일'  ,name: 'dsgnObtainDe', type: "text", align:"center" }
            ,{ title: '지정취소일'  ,name: 'dsgnCnclDe',   type: "text", align:"center" }
            ,{ title: '지정유효기관',name: 'cmptnPrcsDe',  type: "text", align:"center" }
            ,{ title: '등록일'      ,name: 'regDt',        type: "text", align:"center" }
            ,{ title: '등록자'      ,name: 'rgtrNm',       type: "text", align:"center" }
        ],

        rowClick: function(args) {

            if(args.event.originalEvent.target.cellIndex == 0 || isNaN(args.event.originalEvent.target.cellIndex)) return;

            var detailUrl = "/mng/asgsysSrng/dsgnAplyDetailForm.html?prgrmid=" + args.item.prgrmid;

            gridHelper1.loadContent(detailUrl);
            gridHelper1.rowClick(args);
        },
        onPageChanged: function(args) {
            selectedItems = [];
        }
    });

}

//담당자변경
var picAltmntModal;
var openPicChgModal = (modeYn) => {
    var mode = modeYn
    var url = "/mng/asgsysSrng/picAltmntPopup.html?mode="+mode;

    $("#picAltmntPopup").load(url, function(response, status, xhr) {
        if (status == "success") {
            picAltmntModal = new bootstrap.Modal($('#picAltmntPopup'));
            picAltmntModal.show();
        }
    });
}

function initDsgnInfoFrm(){
	writeSplmntDmndGridData();
}

initDsgnInfoFrm();
</script>
