<style>
    .hide {
        display: none;
    }
</style>

<form id="objcInfoFrm">
    <div class="tab-pane" id="protestRequest" role="tabpanel">
        <div class="card-header p-t-0 p-b-0">
            <h3 class="sub-title"><strong>기본 정보</strong></h3>
        </div>
        <div class="card-block-small p-t-0">
            <div class="mb-2 row">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="protestRequestProgramName"><strong>프로그램명</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="protestRequestProgramName" id="protestRequestProgramName" th:value="${dsgnAplyInfo.prgrmNm}" readonly>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-6">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="protestRequestAgencyName"><strong>기관명</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="protestRequestAgencyName" id="protestRequestAgencyName" th:value="${dsgnAplyInfo.instNm}" readonly>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-0 row">
                <div class="col-12 col-lg-6 mb-2 mb-lg-0">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="protestRequestDegree"><strong>차수 / 지정번호</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="protestRequestDegree" id="protestRequestDegree" th:value="${dsgnAplyInfo.cyclNo}" readonly>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-6">
                    <div class="mb-0 form-group">
                        <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="protestRequestAssignAvailableDate"><strong>지정유효기간</strong></label>
                        <div class="col-sm-12">
                            <input type="text" class="form-control form-control-sm" name="protestRequestAssignAvailableDate" id="protestRequestAssignAvailableDate" th:value="${dsgnAplyInfo.dsgnPrd}"
                                   readonly>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-header p-t-0 p-b-0">
            <h3 class="sub-title"><strong>이의 신청</strong></h3>
        </div>
        <div class="card-block-small p-t-0">
            <div class="col-12 table-border-style">
                <table id="objcJsGrid" class="table-responsive"/>
                <div id="objcListPager" class="text-center"/>
            </div>
        </div>
    </div>
</form>

<div class="modal fade" id="objcInfoModal"/>

<script th:inline="javascript">
    var objcInfo = {
        selectListUrl: "/mng/dsgnPrgrm/selectObjcList.do",
        modalUrl: '/mng/dsgnPrgrm/objcInfoPopup.html',

        init: function () {
            modal = null;
            objcInfo.writeObjcListData();
        },

        writeObjcListData: function () {
            $('#objcJsGrid').jsGrid({
                height: "260",
                width: "100%",
                autoload: true,
                sorting: true,
                paging: true,
                pagerContainer: "#objcListPager",
                pagerFormat: "{first} {prev} {pages} {next} {last}",
                pagePrevText: "이전",
                pageNextText: "다음",
                pageFirstText: " < 처음 ㅣ",
                pageLastText: " | 마지막 >",
                pageSize: 1000,
                pageButtonCount: 10,
                pageLoading: true,
                pageIndex: 1,
                noDataContent: "데이터가 없습니다.",
                controller: {
                    loadData: function (filter) {
                        var data = $.Deferred();
                        $.ajax({
                            type: "GET",
                            url: objcInfo.selectListUrl + "?prgrmid=" + prgrmid,
                            dataType: "json",
                        }).done(function (response) {
                            var da = {
                                data: escapeGridData(response.list)
                                , itemsCount: response.totalCount
                            };
                            data.resolve(da);
                        });
                        return data.promise();
                    },
                },
                fields: [
                    {name: 'aplyid', css: 'hide'},
                    {title: 'No.', name: 'rowNumber', type: "number", width: "80", align: "center", sorting: false},
                    {title: '상태', name: 'aplySttsCdNm', type: 'text', width: '100', align: 'center'},
                    {title: '이의사유', name: 'ttl', type: 'text', width: '300'},
                    {title: '등록일시', name: 'regDt', type: 'text', width: '150', align: 'center'},
                    {title: '완료처리일', name: 'ansDt', type: 'text', width: '120', align: 'center'}
                ],
                rowClick: function (args) {
                    objcInfo.showPopup(args.item.aplyid);
                }
            });
        },

        showPopup: function (aplyid) {
            var url = objcInfo.modalUrl + "?aplyid=" + aplyid;
            $("#objcInfoModal").load(url, function (response, status, xhr) {
                if (status == "success") {
                    objcInfo.modal = new bootstrap.Modal($('#objcInfoModal'));
                    objcInfo.modal.show();
                }
            });
        }
    }

    $(function () {
        objcInfo.init();
    });
</script>
</div>
</body>
</html>