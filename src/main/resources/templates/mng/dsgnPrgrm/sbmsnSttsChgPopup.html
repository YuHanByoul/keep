<form id="sbmsnSttsPopFrm">
    <input type="hidden" id="cyclid" name="cyclid" th:value="${popInfo.cyclid}">
    <input type="hidden" id="sttsCd" name="sttsCd" th:value="${popInfo.sttsCd}">

    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content type_2">
            <div class="modal-header">
                <h4 class="modal-title">제출상태 상태변경</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card m-b-10">
                    <div class="card-block-small">
                        <div class="mb-2 form-group row required">
                            <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>제출상태</strong></div>
                            <div class="col-12 mt-1">
                                <div class="form-radio">
                                    <div class="radio radio-inline">
                                        <label class="mb-0 form-label">
                                            <input type="radio" id="sbmsnSttsCd1" name="sbmsnSttsCd" th:checked="${popInfo.sttsCd=='128103'? true:false}" value='128103'>

                                            <i class="helper"></i>제출확인
                                        </label>
                                    </div>
                                    <div class="radio radio-inline">
                                        <label class="mb-0 form-label">
                                            <input type="radio" id="sbmsnSttsCd2" name="sbmsnSttsCd" th:checked="${popInfo.sttsCd=='128104'? true:false}" value='128104'>
                                            <i class="helper"></i>이행확인심사
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-0 form-group row">
                            <div class="form-label col-sm-12 col-form-label p-t-0 pb-1">
                                <strong>담당자 배정</strong></div>
                            <div class="col-sm-12 btn-group-sm">
                                <button type="button" class="btn btn-inverse" id="openPicPopBtn" onclick="openSearchPicPop()">담당자 검색</button>
                            </div>
                            <div class="m-0 row">
                                <div class="col-12 row border rounded p-t-10 p-b-10 m-0 mt-2" >
                                    <div class="col-auto" id="mng_list_area">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary waves-effect waves-light" onclick="poSave()">저장</button>
            </div>
        </div>
    </div>

</form>

<div class="modal fade" id="openSearchPicPopup" aria-hidden="true" data-bs-backdrop="static"></div>
<script th:inline="javascript">


    function poSave(){


    	if(($(sbmsnSttsCd2).prop("checked") && $("input[id^='cnstnt']").length==0)){
    		alert("이행확인심사인 경우 담당자를 선택해 주세요.");
    		return;
    	}
    	if(!confirm("저장하시겠습니까?")) return;

    	var param={};

    	param["sttsCd"]= $('#sbmsnSttsCd1').prop('checked') ?
    			             $('#sbmsnSttsCd1').val() : $('#sbmsnSttsCd2').prop('checked') ? $('#sbmsnSttsCd2').val() : ''

    	param["cyclid"]=$("#cyclid").val();
    	param["picid"]=$("input[id^='cnstnt']").length==0?'':$("input[id^='cnstnt']").val();

        if(displayWorkProgress()){
            $.ajax({
                url : "/mng/dsgnPrgrm/updateSbmsnStts.do",
                type: 'POST',
                cache : false,
                dataType: 'json',
                data : param,
                success : function (data){
                    if(data.result=="success"){
                        alert(data.msg);
                        sbmsnSttsChgModal.hide();
                        operRsltGridHelper.resetListContent();
                    }else{
                    	alert(data.msg);
                    }
                    closeWorkProgress();
                },
                error : function (error){
                }
            });
       }
    }

    function deleteMng(id){
    	$("#mng_list_"+id).remove();
    };

    var openSearchPicModal;
    var openSearchPicPop = () => {
        var url = "/mng/dsgnPrgrm/searchPicPopup.html";

        $("#openSearchPicPopup").load(url, function(response, status, xhr) {
            if (status == "success") {
                openSearchPicModal = new bootstrap.Modal($('#openSearchPicPopup'));
                openSearchPicModal.show();
            }
        });
    }

    $(function() {
    	$("[name=sbmsnSttsCd]").on("change",function(){
    		$("sttsCd").val($(this).val());

    		if($(this).val()=='128104'){
    			$("#openPicPopBtn").prop("disabled","");
    			$("#mng_list_area").children().prop('disabled', false);
    		}else{
    			$("#openPicPopBtn").prop("disabled","disabled");

    			$("#mng_list_area").children().prop('disabled', true);

    		}
    	});
    });




</script>
</div>
</body>
</html>