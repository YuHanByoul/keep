<form id ="jntpurchsOrderUpdateForm">
    <input type="hidden" name="orderid" th:value="${orderInfo.orderid}"/>
    <div class="card-header p-b-0">
        <h3 class="sub-title"><strong>기본 정보</strong></h3>
    </div>
    <div class="card-block-small p-t-0">
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>공동구매모집명</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.jntpurchsNm}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>공동구매모집번호</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.jntpurchsno}"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>공동구매모집기간</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${#dates.format(orderInfo.bgngDt, 'yyyy-MM-dd HH:mm:ss') + ' ~ ' + #dates.format(orderInfo.endDt, 'yyyy-MM-dd HH:mm:ss')}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>모집상태</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.jntpurchsSttsCdNm}"></div>
                </div>
            </div>
        </div>
        <div class="mb-0 row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>접수번호</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.orderno}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group required">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>신청상태</strong></div>
                    <div class="col-12">
                        <span  kattr:select_code="sttsCd" th:attr="grpcd=181, selectedCd=${orderInfo.sttsCd}" isAdmin="true"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-header p-t-0 p-b-0">
        <h3 class="sub-title"><strong>공동구매 정보</strong></h3>
    </div>
    <div class="card-block-small p-t-0">
        <div class="row">
            <div class="col-12 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>교구명(교구번호)</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.tchaidNm}"></div>
                </div>
            </div>
            <!--
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>교구번호</strong></div>
                    <div class="col-12 p-t-5 p-b-5">
                        G-K-01011
                    </div>
                </div>
            </div>
            -->
        </div>
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>교구유형</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.tchaidTypeCdNm}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>교육유형</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.eduTypeCdNm}"></div>
                </div>
            </div>
        </div>
        <!--
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>교육주제</strong></div>
                    <div class="col-12 p-t-5 p-b-5">처리필요</div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>교육대상</strong></div>
                    <div class="col-12 p-t-5 p-b-5">처리필요</div>
                </div>
            </div>
        </div>
        -->
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>모둠구성</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.teamCmpstnCdNm}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>수량</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.qnty}"></div>
                </div>
            </div>
        </div>
        <div class="mb-0 row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>공동구매 예상 금액</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${#numbers.formatInteger(orderInfo.amt, 0, 'COMMA') + '원'}"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-header p-t-0 p-b-0">
        <h3 class="sub-title"><strong>신청자 정보</strong></h3>
    </div>
    <div class="card-block-small p-t-0">
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>신청자 ID</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.acnt}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>회원유형</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.userType == 'C' ? '기관담당자' : '개인회원'}"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>신청기관</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.instNm}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>기관유형</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.instTypeCdNm}"></div>
                </div>
            </div>
        </div>
        <div class="mb-0 row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>휴대전화</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.telno}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>이메일</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.eml}"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-header p-t-0 p-b-0">
        <h3 class="sub-title"><strong>배송지 정보</strong></h3>
    </div>
    <div class="card-block-small p-t-0">
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group required">
                    <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="shippingRecipient"><strong>받으시는 분</strong></label>
                    <div class="col-12">
                        <input type="text" class="form-control form-control-sm" name="recptr" id="recptr" placeholder="" th:value="${orderInfo.recptr}">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group required">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1">
                        <strong>휴대전화</strong></div>
                    <div class="input-group input-group-sm input-group-dropdown mb-0">
                        <!--
                        <select name="shippingPhoneNum0Select" class="form-select form-control form-control-sm">
                            <option value="opt1">primary</option>
                            <option value="opt2">Type 2</option>
                            <option value="opt3">Type 3</option>
                            <option value="opt4">Type 4</option>
                            <option value="opt5">Type 5</option>
                            <option value="opt6">Type 6</option>
                            <option value="opt7">Type 7</option>
                            <option value="opt8">Type 8</option>
                        </select>
                        -->
                        <input type="text" class="form-control form-control-sm" name="recptrTelno" id="recptrTelno" th:value="${orderInfo.recptrTelno}"/>
                    </div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group required">
                    <label class="form-label col-sm-12 col-form-label p-t-0 pb-1" for="recptrEml"><strong>이메일</strong></label>
                    <div class="col-12">
                        <input type="text" class="form-control form-control-sm" name="recptrEml" id="recptrEml" placeholder="" th:value="${orderInfo.recptrEml}">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>주소</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.dlvyAddr}"></div>
                </div>
            </div>
            <div class="col-12 col-lg-6 mb-3">
                <div class="mb-0 form-group">
                    <div class="form-label col-sm-12 col-form-label p-t-0 pb-1"><strong>상세주소</strong></div>
                    <div class="col-12 p-t-5 p-b-5" th:text="${orderInfo.dlvyAddrDtl}"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-block-small">
        <button type="button" class="btn btn-disabled m-r-5" onclick="jntpurchsOrderUpdate.offUpdateJntpurchsOrder();">취소</button>
        <th:block sec:authorize-url="/mng/jntpurchs/updateJntpurchsOrder.do">
            <button type="button" class="btn btn-primary" onclick="jntpurchsOrderUpdate.onUpdatetJntpurchsOrder();">저장</button>
        </th:block>
    </div>
</form>

<div class="modal fade" id="tchaidListPopup" aria-hidden="true" data-bs-backdrop="static"></div>

<script th:inline="javascript">
    var jntpurchsOrderUpdate = {
        init: function() {
            this.setValid();
            this.registEvent();
        }
        
        , registEvent: function() {
            // TODO
        }
        
        , setValid: function() {
            var validator = $('#jntpurchsUpdateForm').validate({
                rules: {
                    recptr: {required: true}
                    , recptrTelno: {required: true}
                    , recptrEml: {digits: true}
                }
                , messages: {
                    recptr: {required: "받으시는 분을 입력해주세요."}
                    , recptrTelno: {required: "받으시는 분 휴대전화를 입력해주세요."}
                    , recptrEml: {required: "받으시는 분 이메일을 입력해주세요."}
                }
            });
        }
        
        , onUpdatetJntpurchsOrder: function() {
            if(!($("#jntpurchsOrderUpdateForm").valid())) return;
            
            var param = $("#jntpurchsOrderUpdateForm").serialize();
            if(displayWorkProgress()) {
                $.ajax({
                    url : "/mng/jntpurchs/updateJntpurchsOrder.do",
                    type: "POST",
                    cache: false,
                    dataType: "json",
                    data: param,
                    success: function(response) {
                        if(response.result == "success") {
                            alert(response.msg);
                            jntpurchsOrderGrid.resetPageContent();
                        } else {
                            alert(response.msg);
                        }
                        closeWorkProgress();
                    }
                });
            }
        }
        
        , offUpdateJntpurchsOrder: function() {
            jntpurchsOrderGrid.toggleContent();
        }
    };
    
    jntpurchsOrderUpdate.init();        
</script>