<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
    xmlns:sec="http://www.thymeleaf.org/extras/spring-security" 
    xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout" 
    layout:decorator="layout/front/simpleLayout"
>
    <body>
        <th:block layout:fragment="content">
            <form id="authForm" name="authForm" th:action="@{/front/membership/step4.html}" method="post">
            <input type="hidden" name="type" id="type" th:value="${data.type}" />
            <input type="hidden" name="tosAgreYn" id="tosAgreYn" th:value="${data.tosAgreYn}" />
            <input type="hidden" name="privcyAgreYn" id="privcyAgreYn" th:value="${data.privcyAgreYn}" />
            <input type="hidden" name="prvcThptyPvsnAgreYn" id="prvcThptyPvsnAgreYn" th:value="${data.prvcThptyPvsnAgreYn}" />
            <input type="hidden" name="childJoinAgreYn" th:if="${data.type == 'C'}" id="childJoinAgreYn" th:value="${param.childJoinAgreYn}" />
            <input type="hidden" name="wbznAplyAgreYn" id="wbznAplyAgreYn" th:value="${data.wbznAplyAgreYn}" />
            <input type="hidden" name="pencodeData" id="pencodeData" value="" />
            <input type="hidden" name="encodeData" id="encodeData" value="" />
            <input type="hidden" name="onepassEncodeData" id="onepassEncodeData" th:value="${data.onepassEncodeData}" />
            <input type="hidden" name="returnUrl" id="returnUrl" th:value="${data.returnUrl}" />
            <input type="hidden" name="userid" id="userid" value="" />
            
            <section>
                <div class="underline-title">
                    <h2>회원가입</h2>
                </div>
        
                <div class="steps">
                    <ol>
                        <li>
                            <div class="steps-inner">
                                <span>01</span>
                                <strong>회원가입 유형</strong>
                            </div>
                        </li>
                        <li>
                            <div class="steps-inner">
                                <span>02</span>
                                <strong>약관동의</strong>
                            </div>
                        </li>
                        <li class="active" title="현재 단계" aria-current="step">
                            <div class="steps-inner">
                                <span>03</span>
                                <strong>본인인증</strong>
                            </div>
                        </li>
                        <li>
                            <div class="steps-inner">
                                <span>04</span>
                                <strong>회원정보입력</strong>
                            </div>
                        </li>
                        <li>
                            <div class="steps-inner">
                                <span>05</span>
                                <strong>가입완료</strong>
                            </div>
                        </li>
                    </ol>
                </div>
    
                <div class="cert-list">
                    <ul>
                        <li>
                            <div class="thumb"><img src="/images/front/member/cert-list01.png" alt=""></div>
                            <dl>
                                <dt th:if="${data.type == 'C'}">법정대리인(보호자)<br>휴대폰 인증</dt>
                                <dt th:unless="${data.type == 'C'}">휴대폰 인증</dt>
                                <dd>&lsquo;<b class="fc-green">인증하기</b>&rsquo; 버튼을 클릭하여 실명인증을 진행해주세요.</dd>
                            </dl>
                            <div class="btn-inner">
                                <button type="button" class="btn-medium btn-green" onclick="fnAuthPopup()">인증하기</button>
                            </div>
                        </li>
                    </ul>
                </div>
    
                <div class="box-desc-list bg7 mt50">
                    <ul>
                        <li>[정보통신망 이용촉진 및 정보보호 등에 관한 법률시행령에 제 29조 10에 따른 본인확인란, 공인인증기관 그 밖에 본인확인서비스를 제공하는 제3자를 통하여 본인임을 확인하는 것을 의미합니다.</li>
                        <li>환경교육포털은 개인정보에 대한 유출 및 도용을 방지하기 위해 본인인증을 시행하고 있습니다.</li>
                        <li>회원님의 개인정보는 항상 암호화되어 처리됩니다.</li>
                        <li>본인인증 시 제공되는 정보는 해당 인증기관에서 직접 수집하며, 인증 이외 용도로 이용 또는 저장하지 않습니다.</li>
                    </ul>
                </div>
            </section>
            </form>
            <form name="form_chk" th:action="@{/CheckPlusSafeModel/checkplus.html}" method="post">
                <input type="hidden" name="type" th:value="${data.type}" />
                <input type="hidden" name="kind" value="auth" />
            </form>
            <script language='javascript'>
                window.name ="Parent_window";
                var popupChk = null;
                
                function fnAuthPopup(){
                    popupChk = window.open('', 'popupChk', 'width=500, height=550, top=100, left=100, fullscreen=no, menubar=no, status=no, toolbar=no, titlebar=yes, location=no, scrollbar=no');
                    document.form_chk.target = "popupChk";
                    document.form_chk.submit();
                }
                
                function setEncodeData(encodeData, userid) {
                    popupChk.close();
                    setTimeout(function(){
                        if($("#type").val() == 'C') {
                            document.authForm.pencodeData.value = encodeData;
                        } else {
                            document.authForm.encodeData.value = encodeData;
                            if(userid != undefined) {
                                if(!confirm("가입된 정보로 계속 하시겠습니까?")) {
                                    alert("이미가입된 정보입니다.");
                                    return;
                                }else{
                                    document.authForm.userid.value = userid;
                                }
                            }
                        }
                        document.authForm.submit();
                    }, 300);
                }
                
            </script>
            <script th:inline="javascript">

                $(function(){
                   /*[# th:if="${data.alertMsg}"]*/
                       alert([[${data.alertMsg}]]);
                   /*[/]*/
                });

            </script>
        </th:block>
    </body>
</html>