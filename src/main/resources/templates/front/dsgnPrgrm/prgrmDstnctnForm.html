<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout" layout:decorator="layout/front/nolnbSubLayout">
<body>
    <div layout:fragment="content">
        <form id="dstnctnForm" name="dstnctnForm" th:action="@{/front/dsgnPrgrm/prgrmEvlForm.html}" method="post">
        <input type="hidden"  id="prgrmid"   name="prgrmid"   th:value="${aplyInfo.prgrmid}" />
        <input type="hidden"  id="dstnctnid" name="dstnctnid" th:value="${aplyInfo.dstnctnid}" />
        <input type="hidden"  id="sttsCd"    name="sttsCd"    th:value="${aplyInfo.sttsCd}" />
        <input type="hidden"  id="opner"     name="opner"     th:value="${opner==null ?'':opner}" />

        <div class="steps" id="steps" th:if="${opner!='myPage'}">
            <ol>
                <li>
                    <div class="steps-inner"><span>01</span> <strong>약관동의</strong></div>
                </li>
                <li>
                    <div class="steps-inner"><span>02</span> <strong>신청정보 확인 및 <br class="pc-only"> 증빙자료 등록</strong>
                    </div>
                </li>
                <li class="active" title="현재 단계">
                    <div class="steps-inner"><span>03</span> <strong>프로그램 우수성</strong></div>
                </li>
                <li>
                    <div class="steps-inner"><span>04</span> <strong>신청완료</strong></div>
                </li>
            </ol>
        </div>


        <div class="row row-section">
            <div class="col col-small">
                <div class="sticky-navigation">
                    <strong class="tit">프로그램 정보 항목</strong>
                    <div class="sticky-steps">
                        <ul id='prgrmNav'>
                            <li class="active"><a href="javascript:navClick('/front/dsgnPrgrm/prgrmDstnctnForm.html')" >프로그램 우수성</a></li>
                            <li><a href="javascript:navClick('/front/dsgnPrgrm/prgrmOperMngForm.html')" >프로그램 운영관리</a></li>
                            <li><a href="javascript:navClick('/front/dsgnPrgrm/prgrmEvlForm.html')" >프로그램 평가</a></li>
                            <li><a href="javascript:navClick('/front/dsgnPrgrm/ldrQlfcForm.html')" >지도자의 자격 및 배치</a></li>
                            <li><a href="javascript:navClick('/front/dsgnPrgrm/sftyMngForm.html')" >안전관리</a></li>
                            <li><a href="javascript:navClick('/front/dsgnPrgrm/chkListForm.html')" >체크리스트</a></li>
                        </ul>
                        <div class="btn-wrap">
                            <div class="center">
                                <button type="button" class="btn-large btn-gray"  onclick="doSave()">중간저장</button>
                                <button type="button" class="btn-large btn-green" onclick="doSave('next')" id="nextBtn">다음</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col col-wide" id="scrlDiv">

                <div class="table-caption mt0">
                    <div class="left">
                        <h3 class="sub-title">프로그램 개요</h3>
                    </div>
                    <div class="right">
                        <p class="desc">
                            <span class="ast">*</span>표시는 필수 입력 정보입니다.
                        </p>
                    </div>
                </div>
                <div class="table-row table-row-mo">
                    <table>
                        <caption>프로그램 개요 - 프로그램 명, 컨설팅 진행여부, 지원사업, 운영형태, 운영일정, 교육주제, 교육대상, 교육장소, 교육인원, 교육시간, 프로그램 참가비용, 교육사진</caption>
                        <colgroup>
                            <col style="width: 140px;"><col>
                        </colgroup>
                        <tbody>
                            <tr>
                                <th scope="row">프로그램 명<i class="ast" title="필수입력">*</i></th>
                                <td>
                                    <div class="form-input">
                                        <input type="text" title="프로그램 명" placeholder="프로그램 명 입력" id="prgrmNm" name="prgrmNm" th:value="${aplyInfo.prgrmNm}">
                                    </div>
                                    <p class="feedback"></p>
                                    <p class="desc">프로그램명은 프로그램의 첫 인상을 좌우하는 부분입니다. 기존의 익숙한 이름보다는 창의적인 이름으로 작성하길 권장합니다.</p>
                                </td>
                            </tr>

                            <tr>
                                <th scope="row">컨설팅 진행여부<i class="ast" title="필수입력">*</i></th>
                                <td>
                                    <div class="form-input" id="cnsltngDiv">
                                        <div class="form-check-list">
                                            <input type="hidden"  id="cnsltngPrgrsYn" name="cnsltngPrgrsYn" th:value="${aplyInfo.cnsltngPrgrsYn}" />
                                            <label class="inp"><input type="radio" id="cnsltngPrgrsYn1" name="cnsltngPrgrsYn1" th:checked="${aplyInfo.cnsltngPrgrsYn=='N'}" value="N"><b>컨설팅 미진행</b></label>
                                            <label class="inp"><input type="radio" id="cnsltngPrgrsYn2" name="cnsltngPrgrsYn2" th:checked="${aplyInfo.cnsltngPrgrsYn=='Y'}" value="Y"><b class="mr10">컨설팅 진행</b>

                                                <select title="컨설팅 진행"  id="cnsltngid" name="cnsltngid" th:attr="disabled=${aplyInfo.cnsltngPrgrsYn == Y ? true:false}">
                                                    <option value=""> - 선택 - </option>
                                                    <th:block th:if="${#lists.size(csltngList) > 0}" th:each="list, i: ${csltngList}">
                                                        <option th:value="${list.cnsltngid}" th:selected="${list.cnsltngid == aplyInfo.cnsltngid}"><th:block th:text="${list.prgrmNm}" /></option>
                                                    </th:block>
                                                </select>

                                            </label>
                                        </div>
                                    </div>
                                    <p class="feedback"></p>
                                    <p class="desc">컨설팅 내역은 지성 신청 전에 신청하는 프로그램으로 컨설팅을 진행하신 분께서는 컨설팅 받은 내역을 선택해주세요. </p>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">지원사업<i class="ast" title="필수입력">*</i></th>
                                <td>
                                    <div class="form-check-list" id="styYnDiv">
                                        <input type="hidden"  id="styYn" name="styYn" th:value="${aplyInfo.styYn}" />
                                        <label class="inp"><input type="radio" id="styYn2" name="styYn2" th:checked="${aplyInfo.styYn=='N'}" value="N"><b class="mr10">비숙박</b>
                                        <label class="inp"><input type="radio" id="styYn1" name="styYn1" th:checked="${aplyInfo.styYn=='Y'}" value="Y"><b class="mr10">숙박</b></label>

                                            <span class="form-input mo-flex-wrap">
                                                <input type="number" class="ar" title="박" style="flex: 0 0 50px; width: 50px;" id="styNight" name="styNight" th:value="${aplyInfo.styNight}" th:attr="disabled=${aplyInfo.styYn == Y ? 'disabled': ''}" onchange="setDay(this.value)"/><div class="bul">박</div>
                                                <input type="number" class="ar" title="일" style="flex: 0 0 50px; width: 50px;" id="styDaytm" name="styDaytm" th:value="${aplyInfo.styDaytm}" th:attr="disabled=${aplyInfo.styYn == Y ? 'disabled': ''}" /><div class="bul">일</div>
                                            </span>
                                        </label>

                                        <p class="feedback"></p>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">운영형태<i class="ast" title="필수입력">*</i></th>
                                <td>
                                    <div class="form-input">
                                        <span kattr:select_code="operFrmCd" th:attr="grpcd=120, selectedCd=${aplyInfo.operFrmCd}" firstOptTxt="- 선택 -" title="운영형태"></span>
                                    </div>
                                    <p class="feedback"></p>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">운영일정<i class="ast" title="필수입력">*</i></th>
                                <td id="operSchdlTd">
                                    <div class="form-input">
                                        <label class="inp"><input type="checkbox" name="wholMm" value="Y" id="wholMm"  th:checked = "${aplyInfo.wholMm =='Y'}"><b>전월</b></label>
                                        <label class="inp"><input type="checkbox" name="jan"    value="Y" id="jan"     th:checked = "${aplyInfo.jan  =='Y'}"><b>1월</b></label>
                                        <label class="inp"><input type="checkbox" name="feb"    value="Y" id="feb"     th:checked = "${aplyInfo.feb  =='Y'}"><b>2월</b></label>
                                        <label class="inp"><input type="checkbox" name="mar"    value="Y" id="mar"     th:checked = "${aplyInfo.mar  =='Y'}"><b>3월</b></label>
                                        <label class="inp"><input type="checkbox" name="apr"    value="Y" id="apr"     th:checked = "${aplyInfo.apr  =='Y'}"><b>4월</b></label>
                                        <label class="inp"><input type="checkbox" name="may"    value="Y" id="may"     th:checked = "${aplyInfo.may  =='Y'}"><b>5월</b></label>
                                        <label class="inp"><input type="checkbox" name="june"   value="Y" id="june"    th:checked = "${aplyInfo.june =='Y'}"><b>6월</b></label>
                                        <label class="inp"><input type="checkbox" name="july"   value="Y" id="july"    th:checked = "${aplyInfo.july =='Y'}"><b>7월</b></label>
                                        <label class="inp"><input type="checkbox" name="aug"    value="Y" id="aug"     th:checked = "${aplyInfo.aug  =='Y'}"><b>8월</b></label>
                                        <label class="inp"><input type="checkbox" name="sept"   value="Y" id="sept"    th:checked = "${aplyInfo.sept =='Y'}"><b>9월</b></label>
                                        <label class="inp"><input type="checkbox" name="oct"    value="Y" id="oct"     th:checked = "${aplyInfo.oct  =='Y'}"><b>10월</b></label>
                                    </div>
                                    <div class="form-input mt10">
                                        <label class="inp"><input type="checkbox" name="nov"  value="Y" id="nov"  th:checked = "${aplyInfo.nov  =='Y'}"><b>11월</b></label>
                                        <label class="inp"><input type="checkbox" name="dcm"  value="Y" id="dcm"  th:checked = "${aplyInfo.dcm  =='Y'}"><b>12월</b></label>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">교육주제<i class="ast" title="필수입력">*</i></th>
                                    <td id="eduSbjctTd">
                                        <div class="form-input mo-flex-wrap">
                                            <strong class="label">생활환경</strong>
                                            <span kattr:check_code="eduSbjct1" grpCd="155" upprCd="155101" addClass="eduSbjctCds" />
                                        </div>
                                        <div class="form-input mo-flex-wrap">
                                            <strong class="label">자연환경</strong>
                                            <span kattr:check_code="eduSbjct2" grpCd="155" upprCd="155102" addClass="eduSbjctCds" />
                                        </div>
                                        <div class="form-input mo-flex-wrap">
                                            <strong class="label">지구환경</strong>
                                            <span kattr:check_code="eduSbjct3" grpCd="155" upprCd="155103" addClass="eduSbjctCds" />
                                        </div>
                                        <div class="form-input mo-flex-wrap">
                                            <strong class="label">환경문화</strong>
                                            <span kattr:check_code="eduSbjct4" grpCd="155" upprCd="155104" addClass="eduSbjctCds" />
                                        </div>
                                    </td>
                                </tr>
                            <tr>
                                <th scope="row">교육대상<i class="ast" title="필수입력">*</i></th>
                                <td id="eduTrgtTd">
                                    <div class="form-input">
                                        <label class="inp"><input type="checkbox" name="infnt"   value="Y" id="infnt"   th:checked = "${aplyInfo.infnt =='Y'}"><b>유아</b></label>
                                        <label class="inp"><input type="checkbox" name="schboy"  value="Y" id="schboy"  th:checked = "${aplyInfo.schboy =='Y'}"><b>초등</b></label>
                                        <label class="inp"><input type="checkbox" name="msklsd"  value="Y" id="msklsd"  th:checked = "${aplyInfo.msklsd =='Y'}"><b>중등</b></label>
                                        <label class="inp"><input type="checkbox" name="hgschst" value="Y" id="hgschst" th:checked = "${aplyInfo.hgschst =='Y'}"><b>고등</b></label>
                                        <label class="inp"><input type="checkbox" name="adult"   value="Y" id="adult"   th:checked = "${aplyInfo.adult =='Y'}"><b>성인</b></label>
                                        <label class="inp"><input type="checkbox" name="wholAge" value="Y" id="wholAge" th:checked = "${aplyInfo.wholAge =='Y'}"><b>전연령</b></label>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">교육장소<i class="ast" title="필수입력">*</i></th>
                                <td>
                                    <div class="form-input">
                                        <input type="text" title="교육장소" id="eduPlc" name="eduPlc" th:value="${aplyInfo.eduPlc}" />
                                    </div>
                                    <p class="feedback"></p>
                                </td>
                            </tr>

                            <tr>
                                <th scope="row">교육인원<i class="ast" title="필수입력">*</i></th>
                                <td>
                                    <div class="form-input">
                                        <input type="number" class="ar" title="교육인원" id="eduNope" name="eduNope" th:value="${aplyInfo.eduNope}" />
                                        <div class="bul">명</div>
                                        <p class="feedback"></p>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">교육시간<i class="ast" title="필수입력">*</i></th>
                                <td>
                                    <div class="form-input mo-flex-wrap">
                                        <div class="form-input">
                                            <input type="number" class="ar" title="회" style="flex: 0 0 50px; width: 50px;" min="0" max="24" id="eduCnt" name="eduCnt" th:value="${aplyInfo.eduCnt}" />
                                            <div class="bul">회</div>
                                            <input type="number" class="ar" title="시간" style="flex: 0 0 50px; width: 50px;" min="0" max="24" id="eduHr" name="eduHr" th:value="${aplyInfo.eduHr}" />
                                            <div class="bul">시간</div>
                                            <input type="number" class="ar" title="분" style="flex: 0 0 50px; width: 50px;" min="0" max="60" id="eduMnt" name="eduMnt" th:value="${aplyInfo.eduMnt}" />
                                            <div class="bul">분</div>
                                            <p class="feedback"></p>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">프로그램 <br class="pc-only"> 참가비용<i class="ast" title="필수입력">*</i></th>
                                <td>
                                    <div class="form-check-list p0" id="pchrgYnDiv">
                                        <input type="hidden"  id="pchrgYn" name="pchrgYn" th:value="${aplyInfo.pchrgYn}" />
                                        <label class="inp"><input type="radio" id="pchrgYn1" name="pchrgYn1" th:checked="${aplyInfo.pchrgYn=='N'}" value="N"><b>무료</b></label>
                                        <label class="inp"><input type="radio" id="pchrgYn2" name="pchrgYn2" th:checked="${aplyInfo.pchrgYn=='Y'}" value="Y"><b class="mr10">유료</b>
                                            <span class="form-input mo-flex-wrap">
                                                <input type="number" class="ar" title="원 (1인당 비용)" style="flex: 0 0 100px; width: 100px;" id="etrfee" name="etrfee" th:value="${#numbers.formatDecimal(aplyInfo.etrfee, 0,'COMMA',0,'POINT')}"  th:attr="disabled=${aplyInfo.pchrgYn != Y ? 'disabled': ''}" />
                                                <div class="bul">원 (1인당 비용)</div>
                                                <p class="feedback"></p>
                                            </span>
                                        </label>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">교육사진<i class="ast" title="필수입력">*</i></th>
                                <td id="fileTd">
                                    <div class="form-input-file">
                                    <span class="form-input">
                                        <input type="file" id="multiFileInput" name="files" class="blind" multiple="multiple" accept=".jpeg,.jpg,.png,.gif,.tif,.tiff,.hwp,.hwpx,.pdf,.ppt,.pptx,.doc,.docx,.xls,.xlsx,.zip" title="파일첨부" maxcount="10">
                                    </span>
                                    <label for="multiFileInput" class="btn-medium btn-gray">파일선택</label>
                                        <ul id="multipleFileUploadSuccess">
                                            <th:block th:if="${eduPhotoFileList ne null}" th:each="file : ${eduPhotoFileList}">
                                                <li class="file-block" th:data_ext="${#strings.substring(file.fileExtsn,1)}" th:id="${file.fileid}">
                                                <span class="name">
                                                    <a th:href="|javascript:downloadFileByFileid('${file.fileid}','${file.fileIdntfcKey}')|">
                                                        [[${file.orginlFileNm}]]
                                                    </a>
                                                </span>
                                                    <button type="button" class="file-delete" title="삭제" th:fileid="${file.fileid}" th:fileIdntfcKey="${file.fileIdntfcKey}"
                                                            th:onclick="|javascript:deleteFile(this.getAttribute('fileid'), this.getAttribute('fileIdntfcKey'))|">
                                                        <span class="icon icon-circle-close"></span>
                                                    </button>
                                                </li>
                                            </th:block>
                                        </ul>

                                        <input type="hidden"  id = "eduPhotoFilegrpid" name = "eduPhotoFilegrpid" th:value="${(aplyInfo.eduPhotoFilegrpid == '' or aplyInfo.eduPhotoFilegrpid == null) ? 0 : aplyInfo.eduPhotoFilegrpid}"/>
                                        <input type="text" id="chkFile" name="chkFile" value="" style="display: none;">

                                        <p class="feedback"></p>
                                        <p class="desc">* 교육사진 파일은 10MB 미만의 JPG, PNG, GIF파일만 업로드 가능(최대 3장 업로드 가능)</p>
                                        <p class="desc">* 권장사이즈 : 가로 398px, 세로 223px</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-caption">
                    <div class="left">
                        <h3 class="sub-title">프로그램 소개</h3>
                    </div>
                    <div class="right">
                        <p class="desc">
                            <span class="ast">*</span>표시는 필수 입력 정보입니다.
                        </p>
                    </div>
                </div>
                <div class="table-row table-row-mo">
                    <table>
                        <caption>프로그램 소개 - 교육목적, 환경교육적 적절성, 프로그램 우수성, 교육내용 (체험활동 등)</caption>
                        <colgroup>
                            <col style="width: 140px;">
                            <col>
                        </colgroup>
                        <tbody>
                            <tr>
                                <th scope="row">교육목적<i class="ast" title="필수입력">*</i></th>
                                <td><textarea maxlength="50" title="교육목적" placeholder="내용을 입력해주세요." id="eduPrps" name="eduPrps" ><th:block th:text="${aplyInfo.eduPrps}" /></textarea>
                                    <div class="desc ar size">
                                        <span>0</span> / 50
                                    </div>
                                    <p class="feedback"></p>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">환경교육적 <br class="pc-only"> 적절성<i class="ast" title="필수입력">*</i></th>
                                <td><textarea maxlength="50" title="환경교육적 적절성" placeholder="내용을 입력해주세요." id="appro" name="appro" ><th:block th:text="${aplyInfo.appro}" /></textarea>
                                    <div class="desc ar size">
                                        <span>0</span> / 50
                                    </div>
                                    <p class="feedback"></p>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">프로그램 우수성<i class="ast" title="필수입력">*</i></th>
                                <td><textarea maxlength="50" title="프로그램 우수성" placeholder="내용을 입력해주세요." id="dstnctn" name="dstnctn" ><th:block th:text="${aplyInfo.dstnctn}" /></textarea>
                                    <div class="desc ar size">
                                        <span>0</span> / 50
                                    </div>
                                    <p class="feedback"></p>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">교육내용 <br class="pc-only"> (체험활동 등)<i class="ast" title="필수입력">*</i></th>
                                <td><textarea maxlength="300" title="교육내용 (체험활동 등)" placeholder="내용을 입력해주세요." id="eduCn" name="eduCn" ><th:block th:text="${aplyInfo.eduCn}" /></textarea>
                                    <div class="desc ar size">
                                        <span>0</span> / 300
                                    </div>
                                    <p class="feedback"></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-caption">
                    <div class="left">
                        <h3 class="sub-title">프로그램 일정표</h3>
                    </div>
                </div>


                <div class="table-col table-layout-auto  table-col-scroll" id="schdlDiv">
                    <table>
                        <caption>프로그램 일정표 - 차시, 일정, 세부 단위 프로그램 명, 관련교육과정, 행 삭제</caption>
                        <colgroup>
                            <col style="width: 6%;">
                            <col>
                            <col style="width: 27%;">
                            <col style="width: 27%;">
                            <col style="width: 6%;">
                        </colgroup>
                        <thead>
                            <tr>
                                <th scope="col">차시</th>
                                <th scope="col">일정</th>
                                <th scope="col">세부 단위 프로그램 명</th>
                                <th scope="col">관련교육과정</th>
                                <th scope="col"><span class="blind">행 삭제</span></th>
                            </tr>
                        </thead>
                        <tbody id="schdlBody">

                            <tr th:id=" 'schdlTr' + ${i.count} " th:each="schd ,i : ${schdlList}">
                                <td id="rnd" name="rnd" >[[${{i.count}}]]차시</td>
                                <td>
                                    <div class="form-input d-flex">
                                        <select title="시" style="flex: 1 1 100%; width:0;" th:id="'bgngHr' + ${i.count}" th:name="'bgngHr' + ${i.count}" th:value="${schd.bgngHr}">
                                            <option th:each="num : ${#numbers.sequence(0,23)}" th:value="${num}" th:selected="${num} == ${schd.bgngHr}">[[${num}]]시</option>
                                        </select>
                                        <input type="number" title="분" style="flex: 1 1 100%; width: 0;" th:id="'bgngMnt'+${i.count}" th:name="'bgngMnt'+${i.count}" th:value="${schd.bgngMnt}">
                                        <div class="bul">~</div>
                                        <select title="시" style="flex: 1 1 100%; width:0;" th:id="'endHr' + ${i.count}" th:name="'endHr' + ${i.count}" th:value="${schd.endHr}">
                                            <option th:each="num : ${#numbers.sequence(0,23)}" th:value="${num}" th:selected="${num} == ${schd.endHr}">[[${num}]]시</option>
                                        </select>
                                        <input type="number" title="분" style="flex: 1 1 100%; width: 0;" th:id="'endMnt'+${i.count}" th:name="'endMnt'+${i.count}" th:value="${schd.endMnt}">
                                    </div>
                                </td>
                                <td><input type="text" title="세부 단위 프로그램 명" th:id="prgrmNm+${i.count}" name="prgrmNm+${i.count}" th:value="${schd.prgrmNm}"></td>
                                <td><input type="text" title="관련교육과정" th:id="crs+${i.count}" th:name="crs+${i.count}" th:value="${schd.crs}"></td>
                                <td class="ac">
                                    <button th:if="${i.count} > 1" type="button" class="btn-remove-table" title="행 삭제" th:id="'delSchdlBtn'+${i.count}" th:onclick="'delSchdl(' + ${i.count} + ')' ">
                                        <span class="icon icon-remove"></span>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <button type="button" class="btn-row-add" title="행 추가" id="addSchdlBtn" onclick="addSchdl()" >
                    <span class="icon icon-row-add"></span>
                </button>

                <div class="table-caption">
                    <div class="left">
                        <h3 class="sub-title">유사시 대처 계획</h3>
                    </div>
                    <div class="right">
                        <p class="desc">
                            <span class="ast">*</span>표시는 필수 입력 정보입니다.
                        </p>
                    </div>
                </div>

                <div class="table-row table-row-mo">
                    <table>
                        <caption>유사시 대처 계획 - 기상상황, 대처방법</caption>
                        <colgroup>
                            <col style="width: 140px;">
                            <col>
                        </colgroup>
                        <tbody>
                            <tr>
                                <th scope="row">기상상황<i class="ast" title="필수입력">*</i></th>
                                <td><textarea maxlength="50" title="기상상황" placeholder="내용을 입력해주세요." id="wetherSttn" name="wetherSttn" ><th:block th:text="${aplyInfo.wetherSttn}" /></textarea>
                                    <div class="desc ar size">
                                        <span>0</span> / 50
                                    </div>
                                    <p class="feedback"></p>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">대처방법<i class="ast" title="필수입력">*</i></th>
                                <td><textarea maxlength="50" title="대처방법" placeholder="내용을 입력해주세요." id="actnMthd" name="actnMthd" ><th:block th:text="${aplyInfo.actnMthd}" /></textarea>
                                    <div class="desc ar size">
                                        <span>0</span> / 50
                                    </div>
                                    <p class="feedback"></p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>


                <div class="table-caption">
                    <div class="left">
                        <h3 class="sub-title">대처 계획</h3>
                        <h4 class="dot-title">관련된 교육과정 내용</h4>
                    </div>
                    <div class="right">
                        <p class="desc">
                            <span class="ast">*</span>표시는 필수 입력 정보입니다.
                        </p>
                    </div>
                </div>

                <div class="table-col table-layout-auto table-col-scroll" id="planDiv">
                    <table>
                        <caption>대처 계획 - 관련된 교육과정 내용(본 프로그램명, 대체 프로그램명), 행 삭제</caption>
                        <colgroup>
                            <col>
                            <col>
                            <col>
                        </colgroup>
                        <thead>
                            <tr>
                                <th scope="col">본 프로그램명<i class="ast" title="필수입력">*</i></th>
                                <th scope="col">대체 프로그램명<i class="ast" title="필수입력">*</i></th>
                                <th scope="col"><span class="blind">행 삭제</span></th>
                            </tr>
                        </thead>
                        <tbody id="planBody">
                            <tr th:id="'planTr' + ${i.count}" th:each="plan ,i : ${planList}">
                                <td><input type="text" title="본 프로그램명"
                                    th:id="prgrmNm + ${i.count}"
                                    th:name="prgrmNm + ${i.count}"
                                    th:value="${plan.prgrmNm}">
                                </td>
                                <td><input type="text" title="대체 프로그램명"
                                    th:id="sbstnNm + ${i.count}"
                                    th:name="sbstnNm + ${i.count}"
                                    th:value="${plan.sbstnPrgrmNm}"></td>
                                <td class="ac">
                                    <button th:if="${i.count} > 1" type="button" class="btn-remove-table" title="행 삭제"
                                    th:id="delPlanBtn + ${i.count}"
                                    th:onclick="delPlan( + ${i.count} + )">
                                        <span class="icon icon-remove"></span>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <button type="button" class="btn-row-add" title="행 추가" id="addPlanBtn" onclick="addPlan()" >
                    <span class="icon icon-row-add"></span>
                </button>

                <div class="mo-only">
                    <div class="btn-wrap">
                        <div class="center">
                            <button type="button" class="btn-medium btn-gray" onclick="doSave()">중간저장</button>
                        </div>
                    </div>
                    <div class="btn-wrap">
                        <div class="center">
                            <button type="button" class="btn-medium btn-gray"  onclick="goPrev()">이전</button>
                            <button type="button" class="btn-medium btn-green" onclick="doSave('next')" id="nextBtn">다음</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- mobile -->
            </div>
        </form>


        <script th:inline="javascript">

            var sbjctList = /*[[${sbjctList}]]*/ null;

            var insertUrl = "/front/dsgnPrgrm/insertPrgrmDstnctnForm.do";
            var updateUrl = "/front/dsgnPrgrm/updatePrgrmDstnctnForm.do";
            var nextUrl   = "/front/dsgnPrgrm/prgrmOperMngForm.html";    //프로그램 운영관리
            var prevUrl   = "/front/dsgnPrgrm/evdncDataForm.html";
            var reUrl     = "/front/dsgnPrgrm/prgrmDstnctnForm.html";    //우수성
            var uploadFileCnt=0;

            function navClick(link){
                var sttsCd = $('#sttsCd').val();
                var prgrmid = $('#prgrmid').val();
                if(sttsCd != null && sttsCd != '' && sttsCd != '111101'){
                    location.href = link+"?prgrmid="+prgrmid;
                };
            }

            function setDay(num){
            	$("#styDaytm").val(Number(num)+1);
            }

            function validCbxGrp(cbxGrp, msg) {
                if (cbxGrp.find("input:checked").length == 0) {
                	if (!cbxGrp.find(".feedback.invalid").length) {
                	    cbxGrp.append(`<p class="feedback invalid">${msg}</p>`);
        	        }
        	        var offset = cbxGrp.offset();
        	        $('html, body').animate({scrollTop : offset.top - 300}, 300);
        	        cbxGrp.focus();
        	        return false;
        	    } else {
        	      cbxGrp.find(".feedback.invalid").remove();
        	      return true;
        	    }
        	}

            function validLst(lstNm, lstNmKo) {

            	if(lstNm=="plan"){
                    if ($("[id^="+lstNm+"Tr] input").length === 0) {
                        var msg= lstNmKo + "을 입력해 주십시오";
                        if (!$("#"+lstNm+"Div").find(".feedback.invalid").length) {
                            $("#"+lstNm+"Div").prepend(`<p class="feedback invalid">${msg}</p>`);
                        }
                        var offset = $("#"+lstNm+"Div").offset();
                        $('html, body').animate({scrollTop : offset.top - 300}, 300);
                        $("#"+lstNm+"Div").focus();
                        return false;
                    }
            	}

                var flag = true;
                $("[id^="+lstNm+"Tr] input").each(function(index, item) {
                    if (item.value === "") {
                        var msg= "입력되지 않은 항목이 있습니다";
                        $("#"+lstNm+"Div").prepend(`<p class="feedback invalid">${msg}</p>`);
                        flag = false;
                        return false; // stop the loop
                    } else {
                        $("#"+lstNm+"Div").find(".feedback.invalid").remove();
                    }
                });

                return flag;
            }

            function schdlChk(){
            	var flag=true;
            	$("[id^=schdlTr]").each(function(index, item) {

            		var row=index+1;
            		var bgngHr  = isNaN(parseInt($("#bgngHr" +row).val())) ? 0 : parseInt($("#bgngHr"+row).val());
            		var bgngMnt = isNaN(parseInt($("#bgngMnt"+row).val())) ? 0 : parseInt($("#bgngMnt"+row).val());
            		var endHr   = isNaN(parseInt($("#endHr" +row).val())) ? 0 : parseInt($("#endHr"+row).val());
            		var endMnt  = isNaN(parseInt($("#endMnt" +row).val())) ? 0 : parseInt($("#endMnt"+row).val());
            		var msg="";

            		if(bgngMnt==0) {
            			msg="시작 분을 입력 해주세요"
            			$("#schdlDiv").find(".feedback.invalid").remove();
            			$("#schdlDiv").prepend(`<p class="feedback invalid">${msg}</p>`);
            			flag= false;
            			return;
            		}

            		if(endMnt==0) {
            			msg="종료 분을 입력 해주세요"
            			$("#schdlDiv").find(".feedback.invalid").remove();
            			$("#schdlDiv").prepend(`<p class="feedback invalid">${msg}</p>`);
            			flag=false;
            			return;
            		}

            		var bgngTotalMnt = bgngHr * 60 + bgngMnt;
            		var endTotalMnt = endHr * 60 + endMnt;

            		if (endTotalMnt <= bgngTotalMnt) {
            			msg="종료 시간은 시작 시간보다 빠를 수 없습니다."
            			$("#schdlDiv").find(".feedback.invalid").remove();
            			$("#schdlDiv").prepend(`<p class="feedback invalid">${msg}</p>`);
            			flag = false;
            			return;
            		}

            	});
            	return flag;
            };

            function validate(){

                $("#dstnctnForm").validate({
                    ignore: [],
                    rules: {
                        prgrmNm : { required: true , maxlength:100  }
                      , cnsltngPrgrsYn : { required: true }
                      , styYn       : { required: true }
                      , operFrmCd   : { required: true }
                      , eduPlc      : { required: true , maxlength:100  }
                      , eduNope     : { required: true , maxlength:100  }
                      , eduHr       : { required: true , maxlength:100  }
                      , pchrgYn     : { required: true , maxlength:100  }

                      , eduPrps     : { required: true , maxlength:100  }
                      , appro       : { required: true , maxlength:100  }
                      , dstnctn     : { required: true , maxlength:50   }
                      , eduCn       : { required: true , maxlength:300  }

                      , wetherSttn  : { required: true , maxlength:50  }
                      , actnMthd    : { required: true , maxlength:50  }
                     },
                     messages: {
                         prgrmNm     : { required: "프로그램명을 입력해 주십시오." , maxlength:"프로그램명은 100자를 넘을 수 없습니다."  }
                       , cnsltngPrgrsYn : { required: "컨설팅 여부 를 입력해 주십시오." }
                       , styYn       : { required: "숙박여부 를 입력해 주십시오." }
                       , operFrmCd   : { required: "운영형태 를 입력해 주십시오." }
                       , eduPlc      : { required: "교육장소 를 입력해 주십시오." , maxlength:"교육장소는 100자를 넘을 수 없습니다."  }
                       , eduNope     : { required: "교육인원 을 입력해 주십시오." , maxlength:"프로그램명은 100자를 넘을 수 없습니다."  }
                       , eduHr       : { required: "교육시간 을 입력해 주십시오." , maxlength:"프로그램명은 100자를 넘을 수 없습니다."  }
                       , pchrgYn     : { required: "참가비용 유료여부 를 입력해 주십시오." }


                       , eduPrps     : { required: "교육목적 을 입력해 주십시오." , maxlength:"교육목적 은 100자를 넘을 수 없습니다."  }
                       , appro       : { required: "환경교육적 적절성 을 입력해 주십시오." , maxlength:"환경교육적 적절성 은 100자를 넘을 수 없습니다."  }
                       , dstnctn     : { required: "프로그램 우수성 입력해 주십시오." , maxlength:"프로그램 우수성은 100자를 넘을 수 없습니다."  }
                       , eduCn       : { required: "교육내용 (체험활동 등) 을 입력해 주십시오." , maxlength:"교육내용(체험활동 등)은 300자를 넘을 수 없습니다."  }

                       , wetherSttn  : { required: "기상상황 을 입력해 주십시오." , maxlength:"기상상황은 50자를 넘을 수 없습니다."  }
                       , actnMthd    : { required: "대처방법 을 입력해 주십시오." , maxlength:"대처방법은 50자를 넘을 수 없습니다."  }
                     }
                });

            }

            function doSave(call){

//             	var sttsCd = $("#sttsCd").val();
//             	if(sttsCd == '111103') {
//             		location.href = nextUrl+"?prgrmid=" + $("#prgrmid").val()+"&opner="+$("#opner").val();
//             		return;
//             	}

                var url = ($("#dstnctnid").val() == null || $("#dstnctnid").val() == "" || $("#dstnctnid").val() == 0) ? insertUrl : updateUrl;
                var param = {};

                //프로그램 일정
                $("[id^=schdlTr]").each(function(index, item)      { param["prgrmSchdlLst[" + index + "].prgrmid"] = $("#prgrmid").val()});    //프로그램 id (key)
                $("[id^=rnd]").each(function(index, item)          { param["prgrmSchdlLst[" + index + "].rnd"    ] = item.textContent; });    //차수
                $("[id^=bgngHr]").each(function(index, item)       {

                    param["prgrmSchdlLst[" + index + "].bgngHr" ] = item.value;
                });

                //교육주제
                $("#eduSbjctTd input:checked").each(function(index,item){
                	if(index==0) param["eduSbjctCdLst"] = ""+item.value;
                    if(index!=0) param["eduSbjctCdLst"] += ","+item.value;
                });

                $("#schdlBody [id^=bgngMnt]").each(function(index, item) { param["prgrmSchdlLst[" + index + "].bgngMnt"] = item.value; });    //시작 분
                $("#schdlBody [id^=endHr]").each(function(index, item)   { param["prgrmSchdlLst[" + index + "].endHr"  ] = item.value; });    //종료 시간
                $("#schdlBody [id^=endMnt]").each(function(index, item)  { param["prgrmSchdlLst[" + index + "].endMnt" ] = item.value; });    //종료 분
                $("#schdlBody [id^=prgrmNm]").each(function(index, item) { param["prgrmSchdlLst[" + index + "].prgrmNm"] = item.value; });    //프로그램명
                $("#schdlBody [id^=crs]").each(function(index, item)     { param["prgrmSchdlLst[" + index + "].crs"    ] = item.value; });    //과정

                $("#dstnctnForm input").each(function(index, item) {

                    if("checkbox" == item.type){
                        if(item.checked ) {
                            param[item.id] = "Y";
                        }
                        else{
                            param[item.id] = "N";
                        }
                    }else{
                        param[item.id] = item.value;
                    }
                });
                $("#dstnctnForm textarea,select").each(function(index, item) { param[item.id] = item.value;});

                //프로그램 대처계획
                $("#planBody [id^=planTr]").each(function(index, item)  { param["emrgcyActnPlanLst[" + index + "].prgrmid"     ] = $("#prgrmid").val()});       //프로그램 id (key)
                $("#planBody [id^=sbstnNm]").each(function(index, item) { param["emrgcyActnPlanLst[" + index + "].sbstnPrgrmNm"] = item.value; });    //대처 프로그램명
                $("#planBody [id^=prgrmNm]").each(function(index, item) { param["emrgcyActnPlanLst[" + index + "].prgrmNm"     ] = item.value; });    //본 프로그램명

                //숙박여부와 프로그램우수성의 운영형태로 체크리스트의 운영형태를 판단하여 체크리스트 결정
                if($("#operFrmCd").val() == "120104") {
                	param["chkOperFrmCd"] = "145103";
                }
                else if ($("#operFrmCd").val() != "120104"){
                	if($("#styYn").val()=="Y"){
                		param["chkOperFrmCd"] = "145101";
                	}else{
                		param["chkOperFrmCd"] = "145102";
                	}
                }

        		param["cnsltngid"] = $("#cnsltngid").val();

                if(call == "next") {

                	var bChk = true;
                 	if(!$("#dstnctnForm").valid()) return false;
                	bChk = $("#dstnctnForm").valid();

                	//컨설팅여부
                	if($("#cnsltngPrgrsYn").val() =='Y'){
                		if($("#cnsltngid").val() == null || $("#cnsltngid").val() == ''){
                			if (!$("#cnsltngid").find(".feedback.invalid").length) {
                                $("#cnsltngDiv").after(`<p class="feedback invalid">컨설팅 프로그램을 선택해 주십시오.</p>`);
                            }
                		}
                	}

                	//숙박여부
                	if($("#styYn1").prop("checked")){
                		if($("#styNight").val() == null || $("#styNight").val() == ''){
                			if (!$("#styYnDiv").find(".feedback.invalid").length) {
                                $("#styYnDiv").after(`<p class="feedback invalid">숙박(박)을 입력해 주십시오.</p>`);
                            }
                		}
                		if($("#styDaytm").val() == null || $("#styDaytm").val() == ''){
                			if (!$("#styYnDiv").find(".feedback.invalid").length) {
                                $("#styYnDiv").after(`<p class="feedback invalid">숙박(일)을 입력해 주십시오.</p>`);
                            }
                		}
                	}

                	//참가비용
                	if($("#pchrgYn2").prop("checked")){
                		if($("#etrfee").val() == null || $("#etrfee").val() == ''){
                			if (!$("#pchrgYnDiv").find(".feedback.invalid").length) {
                                $("#pchrgYnDiv").after(`<p class="feedback invalid">참가비용을 입력해 주십시오.</p>`);
                            }
                		}else{
                    		if($("#etrfee").val() < 1){
                    			if (!$("#pchrgYnDiv").find(".feedback.invalid").length) {
                                    $("#pchrgYnDiv").after(`<p class="feedback invalid">참가비용은 0 보다 커야 합니다.</p>`);
                                }
                    		}
                		}
                	}

                    bChk = validCbxGrp($("#operSchdlTd"), "운영일정을 입력해 주십시오.") ?  bChk:false;
                    bChk = validCbxGrp($("#eduSbjctTd") , "교육주제를 입력해 주십시오.") ?  bChk:false;
                    bChk = validCbxGrp($("#eduTrgtTd")  , "교육대상을 입력해 주십시오.") ?  bChk:false;

                    //첨부파일
                    var fileCnt = $("[fileid],[id^=fileid]").length;
                    if(fileCnt==0){
                    	//$("[fileid]").length
                    	var msg="첨부파일을 입력해 주십시오";
                    	if (!$("#fileTd").find(".feedback.invalid").length) {
                            $("#fileTd").append(`<p class="feedback invalid">${msg}</p>`);
                        }
                        var offset = $("#fileTd").offset();
                        $('html, body').animate({scrollTop : offset.top - 300}, 300);
                        $("#fileTd").focus();
                        bChk = false;
                    } else {
                        $("#fileTd").find(".feedback.invalid").remove();
                    }

                    bChk =  validLst("plan",  "대처계획") ? bChk:false;
                    if(!bChk) return;


                }else{

                	if(!confirm("저장하시겠습니까?")) return;
                }

                $.ajax({
                    url : url,
                    type: 'POST',
                    cache : false,
                    dataType: 'json',
                    data: param,
                    success : function (data){
                        if(data.result=="success"){
                            if(call == "next") {
                                location.href = nextUrl+"?prgrmid=" + $("#prgrmid").val()+"&opner="+$("#opner").val();
                            }else{
                        	    alert(data.msg);
                                location.href = reUrl+"?prgrmid=" + $("#prgrmid").val()+"&opner="+$("#opner").val();
                            }

                        }else{
                            alert(data.msg);
                        }
                    },
                    error : function (error){
                    }
                });
            }

            function goPrev(){
            	location.href = prevUrl+"?prgrmid="+$("#prgrmid").val();
            }

            function goNext(){
                doSave("next");
            }

            function addSchdl(){
                var html="";
                var idx = $("[id^='schdlTr']").length;

                if(idx >= 30){
                	alert("최대 30행까지만 추가 가능합니다.");
                	return;
                }

                html +=`
                        <tr id="schdlTr${idx+1}">
                            <td>${idx+1}차시</td>
                            <td>
                                <div class="form-input d-flex">
                                    <select title="시" style="flex: 1 1 100%; width: 0;" id="bgngHr`+`${idx+1}`+`" name="bgngHr`+`${idx+1}`+`">`

                for(var i=0; i<24; i++){
                    html +=`<option value=${i}>${i}시</option>`/**/
                }

                html +=`
                                    </select> <input type="number" title="분" style="flex: 1 1 100%; width: 0;" id="bgngMnt`+`${idx+1}`+`" name="bgngMnt`+`${idx+1}`+`">
                                    <div class="bul">~</div>
                                    <select title="시" style="flex: 1 1 100%; width: 0;" id="endHr`+`${idx+1}`+`" name="endHr`+`${idx+1}`+`">`
                for(var i=0; i<24; i++){
                    html +=`<option value=${i}>${i}시</option>`/**/
                }
                html +=`
                                    </select> <input type="number" title="분" style="flex: 1 1 100%; width: 0;" id="endMnt`+`${idx+1}`+`" name="endMnt`+`${idx+1}`+`">
                                </div>
                            </td>
                            <td><input type="text" title="세부 단위 프로그램 명" id="prgrmNm`+`${idx+1}`+`" name="prgrmNm`+`${idx+1}`+`"></td>
                            <td><input type="text" title="관련교육과정" id="crs`+`${idx+1}`+`" name="crs`+`${idx+1}`+`"></td>
                            <td class="ac"><button type="button" class="btn-remove-table" title="행 삭제" id="delSchdlBtn`+`${idx+1}`+`" onclick="delSchdl(`+`${idx+1}`+`)">
                                    <span class="icon icon-remove"></span>
                                </button></td>
                        </tr>`/**/

                $("#schdlBody").append(html);
            }

            function delSchdl(id){
            	var idx = $("[id^=schdlTr]").length;
                $("#schdlTr"+idx).remove();
            }

            function addPlan(){
                var html="";
                var idx = $("[id^='planTr']").length;

                if(idx >= 30){
                    alert("최대 30행까지만 추가 가능합니다.");
                    return;
                }

                html +=`
                    <tr id="planTr`+`${idx+1}`+`" >
                        <td><input type="text" title="본 프로그램명" id="prgrmNm`+`${idx+1}`+`" name="prgrmNm`+`${idx+1}`+`" ></td>
                        <td><input type="text" title="대체 프로그램명" id="sbstnNm`+`${idx+1}`+`" name="sbstnNm`+`${idx+1}`+`" ></td>
                        <td class="ac">
                        ${idx>0 ? `
                            <button type="button" class="btn-remove-table" title="행 삭제" id="delPlanBtn`+`${idx+1}`+`" onclick="delPlan(`+`${idx+1}`+`) ">
                                <span class="icon icon-remove"></span>
                            </button>`
                        :``}
                        </td>
                    </tr>
                `/**/

                $("#planBody").append(html);
            }

            function delPlan(id){
                $("#planTr"+id).remove();
            }

            function initForm(){

            	var sttsCd = $("#sttsCd").val();

                if(sttsCd !=null && sttsCd !='' && sttsCd !='111101'&& sttsCd !='111102'){
            		$('#dstnctnForm input,textarea').prop('readonly', true);
            		$('#dstnctnForm button, select, input[type=checkbox],input[type=radio],input[type=file]').prop('disabled', true);

            		$('#dstnctnForm #nextBtn').prop('disabled', false);
            	}

                if(sttsCd !=null && sttsCd !='' && sttsCd !='111101'){
                    $("#prgrmNav .active").removeClass('active');
                }
            }

            //
            $(function() {

            	initForm();
            	validate();

            	$("#eduSbjctTd input").each(function() {
            	    var chkVal = $(this).val();

            	    if(sbjctList!=null){
                	    for(row of sbjctList){
                	    	if(row.eduSbjctCd ==chkVal) $(this).prop('checked', true);
                	    }
            	    }
            	});

                $("textArea").keyup(function (e) {
                    var inTxt = $(this).val();
                    if($("#"+this.id).next().prop("class")=="desc ar size"){
                        $("#"+this.id).next().children().prop("innerHTML",inTxt.length);
                    }
                });
                $("textArea").trigger("keyup");

                $("input[type='radio']").on("change", function(e) {
                    var id = e.originalEvent.target.id;

                    //컨설팅 여부
                    if(id.startsWith("cnsltngPrgrsYn")){
                        $("#cnsltngPrgrsYn").val( $("#"+id).val() );
                        $("#cnsltngPrgrsYn1").prop("checked", $("#cnsltngPrgrsYn").val() == "N");
                        $("#cnsltngPrgrsYn2").prop("checked", $("#cnsltngPrgrsYn").val() == "Y");

                        if($("#cnsltngPrgrsYn").val() == "Y") {
                            $("#cnsltngid").prop("disabled", "")
                        }else if($("#cnsltngPrgrsYn").val() == "N") {
                        	$("#cnsltngid").val("");
                        	$("#cnsltngid").prop("disabled", "disabled")
                        }
                    }

                    //숙박여부
                    if(id.startsWith("styYn")){
                        $("#styYn").val( $("#"+id).val() );
                        $("#styYn1").prop("checked", $("#styYn").val() == "Y");
                        $("#styYn2").prop("checked", $("#styYn").val() == "N");

                        if($("#styYn").val() == "Y"){
                            $("#styNight").prop("disabled", "")
                            $("#styDaytm").prop("disabled", "")
                        }
                        else{
                            $("#styNight").prop("disabled", "disabled")
                            $("#styDaytm").prop("disabled", "disabled")
                            $("#styNight").val("");
                            $("#styDaytm").val("");
                        }
                    }

                    //유료 여부
                    if(id.startsWith("pchrgYn")){
                        $("#pchrgYn").val( $("#"+id).val() );
                        $("#pchrgYn1").prop("checked", $("#pchrgYn").val() == "N");
                        $("#pchrgYn2").prop("checked", $("#pchrgYn").val() == "Y");

                        if($("#pchrgYn").val() == "Y"){
                            $("#etrfee").prop("disabled","");
                        }
                        else{
                            $("#etrfee").prop("disabled","disabled");
                            $("#etrfee").val("0");
                        }
                    }
                });

                //첨부파일
                $('#multiFileInput').on("change", function(event) {
                    var objFile = document.querySelector('#multiFileInput');
                    var formData = new FormData();
                    var content = "";

                    for( i = 0 ; i < objFile.files.length ; i++) {
                        formData.append("files", objFile.files[i]);
                        uploadFileCnt++;
                    }

                    formData.append("filegrpid", $("#eduPhotoFilegrpid").val());
                    formData.append("filegrpNm", "dstnctnEduPhoto_file");

                    if(uploadFileCnt >0 ){
                        $.ajax({
                            url : '/uploadMultipleFiles.do',
                            processData : false,
                            contentType : false,
                            data : formData,
                            type : 'POST',
                            success : function(response) {

                                if(response.result == 'fail'){
                                    alert(response.msg);
                                }else{
                                    if($("#eduPhotoFilegrpid").val()=='0' || $("#eduPhotoFilegrpid").val()==''  || $("#eduPhotoFilegrpid").val()==null){
                                        $("#eduPhotoFilegrpid").val( response[0].filegrpid );
                                    }

                                    for(i = 0 ;i < response.length; i++ ){
                                        content = '<ul>';
                                        content +=  '<li class="file-block" data_ext="'+response[i].fileExtsn.replace(".", '')+'" id="fileid'+response[i].fileid+'"><span class="name">'+response[i].orginlFileNm
                                        content += '&nbsp;&nbsp;<a href="javascript:void(0)" onclick=uploadFileCnt--;fn_deleteFileList("'+response[i].fileid+'","'+response[i].fileIdntfcKey+'")>X</a></span></li>'
                                        content += '</ul>';
                                        $('#multipleFileUploadSuccess').append(content);
                                    }
                                }
                            }
                        })
                       if (detectBrowser() == "other") {
                           $("#multiFileInput").val("");
                       } else {
                          $("#multiFileInput").replaceWith( $("#multiFileInput").clone(true))
                       }
                    }
                });
            });

            function fn_deleteFileList(fileid, fileIdntfcKey){

                if(!confirm("파일을 삭제하시겠습니까?")){return;}
                fn_deleteFile(fileid, fileIdntfcKey);

                $("#fileid"+fileid).remove();

            }

            function fn_deleteFile(fileid, fileIdntfcKey){

              var deleteFileUrl="/deleteFile.do?fileid="+fileid+"&file_idntfc_key=" + fileIdntfcKey;

                  $.ajax({
                     url : deleteFileUrl,
                     type: 'GET',
                     cache : false,
                     dataType: 'json',
                     success : function (data){
                         if(data.result=="success"){
                             $("#"+fileid).remove();
                             if(uploadFileCnt > 0){
                                 uploadFileCnt = uploadFileCnt-1;
                             }
                             alert("파일삭제가 완료 되었습니다.");
                         }else{
                             alert("파일삭제중 에러가 발생하였습니다. 관리자에게 문의 부탁드립니다.");
                         }
                     },
                     error : function (error){
                     }
                   })
            };
        </script>
    </div>
</body>
</html>
